var H=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Z(j){return j&&j.__esModule&&Object.prototype.hasOwnProperty.call(j,"default")?j.default:j}var Y={exports:{}};(function(j){(function(){}).call(H),(function(){window.Set==null&&(window.Set=function(){function M(){this.clear()}return M.prototype.clear=function(){return this.values=[]},M.prototype.has=function(v){return this.values.indexOf(v)!==-1},M.prototype.add=function(v){return this.has(v)||this.values.push(v),this},M.prototype.delete=function(v){var x;return(x=this.values.indexOf(v))===-1?!1:(this.values.splice(x,1),!0)},M.prototype.forEach=function(){var v;return(v=this.values).forEach.apply(v,arguments)},M}())}).call(H),function(M){function v(){}function x(n,h){return function(){n.apply(h,arguments)}}function b(n){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");if(typeof n!="function")throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],f(n,this)}function y(n,h){for(;n._state===3;)n=n._value;return n._state===0?void n._deferreds.push(h):(n._handled=!0,void r(function(){var u=n._state===1?h.onFulfilled:h.onRejected;if(u===null)return void(n._state===1?c:s)(h.promise,n._value);var m;try{m=u(n._value)}catch(t){return void s(h.promise,t)}c(h.promise,m)}))}function c(n,h){try{if(h===n)throw new TypeError("A promise cannot be resolved with itself.");if(h&&(typeof h=="object"||typeof h=="function")){var u=h.then;if(h instanceof b)return n._state=3,n._value=h,void e(n);if(typeof u=="function")return void f(x(u,h),n)}n._state=1,n._value=h,e(n)}catch(m){s(n,m)}}function s(n,h){n._state=2,n._value=h,e(n)}function e(n){n._state===2&&n._deferreds.length===0&&setTimeout(function(){n._handled||l(n._value)},1);for(var h=0,u=n._deferreds.length;u>h;h++)y(n,n._deferreds[h]);n._deferreds=null}function a(n,h,u){this.onFulfilled=typeof n=="function"?n:null,this.onRejected=typeof h=="function"?h:null,this.promise=u}function f(n,h){var u=!1;try{n(function(m){u||(u=!0,c(h,m))},function(m){u||(u=!0,s(h,m))})}catch(m){if(u)return;u=!0,s(h,m)}}var o=setTimeout,r=typeof setImmediate=="function"&&setImmediate||function(n){o(n,1)},l=function(n){typeof console<"u"&&console&&console.warn("Possible Unhandled Promise Rejection:",n)};b.prototype.catch=function(n){return this.then(null,n)},b.prototype.then=function(n,h){var u=new b(v);return y(this,new a(n,h,u)),u},b.all=function(n){var h=Array.prototype.slice.call(n);return new b(function(u,m){function t(g,d){try{if(d&&(typeof d=="object"||typeof d=="function")){var A=d.then;if(typeof A=="function")return void A.call(d,function(w){t(g,w)},m)}h[g]=d,--i===0&&u(h)}catch(w){m(w)}}if(h.length===0)return u([]);for(var i=h.length,p=0;p<h.length;p++)t(p,h[p])})},b.resolve=function(n){return n&&typeof n=="object"&&n.constructor===b?n:new b(function(h){h(n)})},b.reject=function(n){return new b(function(h,u){u(n)})},b.race=function(n){return new b(function(h,u){for(var m=0,t=n.length;t>m;m++)n[m].then(h,u)})},b._setImmediateFn=function(n){r=n},b._setUnhandledRejectionFn=function(n){l=n},j.exports?j.exports=b:M.Promise||(M.Promise=b)}(H),(function(){var M=typeof window.customElements=="object",v=typeof document.registerElement=="function",x=M||v;x||(typeof WeakMap>"u"&&function(){var b=Object.defineProperty,y=Date.now()%1e9,c=function(){this.name="__st"+(1e9*Math.random()>>>0)+(y+++"__")};c.prototype={set:function(s,e){var a=s[this.name];return a&&a[0]===s?a[1]=e:b(s,this.name,{value:[s,e],writable:!0}),this},get:function(s){var e;return(e=s[this.name])&&e[0]===s?e[1]:void 0},delete:function(s){var e=s[this.name];return e&&e[0]===s?(e[0]=e[1]=void 0,!0):!1},has:function(s){var e=s[this.name];return e?e[0]===s:!1}},window.WeakMap=c}(),function(b){function y(R){w.push(R),A||(A=!0,i(s))}function c(R){return window.ShadowDOMPolyfill&&window.ShadowDOMPolyfill.wrapIfNeeded(R)||R}function s(){A=!1;var R=w;w=[],R.sort(function(E,C){return E.uid_-C.uid_});var L=!1;R.forEach(function(E){var C=E.takeRecords();e(E),C.length&&(E.callback_(C,E),L=!0)}),L&&s()}function e(R){R.nodes_.forEach(function(L){var E=p.get(L);E&&E.forEach(function(C){C.observer===R&&C.removeTransientObservers()})})}function a(R,L){for(var E=R;E;E=E.parentNode){var C=p.get(E);if(C)for(var S=0;S<C.length;S++){var T=C[S],N=T.options;if(E===R||N.subtree){var P=L(N);P&&T.enqueue(P)}}}}function f(R){this.callback_=R,this.nodes_=[],this.records_=[],this.uid_=++k}function o(R,L){this.type=R,this.target=L,this.addedNodes=[],this.removedNodes=[],this.previousSibling=null,this.nextSibling=null,this.attributeName=null,this.attributeNamespace=null,this.oldValue=null}function r(R){var L=new o(R.type,R.target);return L.addedNodes=R.addedNodes.slice(),L.removedNodes=R.removedNodes.slice(),L.previousSibling=R.previousSibling,L.nextSibling=R.nextSibling,L.attributeName=R.attributeName,L.attributeNamespace=R.attributeNamespace,L.oldValue=R.oldValue,L}function l(R,L){return D=new o(R,L)}function n(R){return O||(O=r(D),O.oldValue=R,O)}function h(){D=O=void 0}function u(R){return R===O||R===D}function m(R,L){return R===L?R:O&&u(R)?O:null}function t(R,L,E){this.observer=R,this.target=L,this.options=E,this.transientObservedNodes=[]}if(!b.JsMutationObserver){var i,p=new WeakMap;if(/Trident|Edge/.test(navigator.userAgent))i=setTimeout;else if(window.setImmediate)i=window.setImmediate;else{var g=[],d=String(Math.random());window.addEventListener("message",function(R){if(R.data===d){var L=g;g=[],L.forEach(function(E){E()})}}),i=function(R){g.push(R),window.postMessage(d,"*")}}var A=!1,w=[],k=0;f.prototype={observe:function(R,L){if(R=c(R),!L.childList&&!L.attributes&&!L.characterData||L.attributeOldValue&&!L.attributes||L.attributeFilter&&L.attributeFilter.length&&!L.attributes||L.characterDataOldValue&&!L.characterData)throw new SyntaxError;var E=p.get(R);E||p.set(R,E=[]);for(var C,S=0;S<E.length;S++)if(E[S].observer===this){C=E[S],C.removeListeners(),C.options=L;break}C||(C=new t(this,R,L),E.push(C),this.nodes_.push(R)),C.addListeners()},disconnect:function(){this.nodes_.forEach(function(R){for(var L=p.get(R),E=0;E<L.length;E++){var C=L[E];if(C.observer===this){C.removeListeners(),L.splice(E,1);break}}},this),this.records_=[]},takeRecords:function(){var R=this.records_;return this.records_=[],R}};var D,O;t.prototype={enqueue:function(R){var L=this.observer.records_,E=L.length;if(L.length>0){var C=L[E-1],S=m(C,R);if(S)return void(L[E-1]=S)}else y(this.observer);L[E]=R},addListeners:function(){this.addListeners_(this.target)},addListeners_:function(R){var L=this.options;L.attributes&&R.addEventListener("DOMAttrModified",this,!0),L.characterData&&R.addEventListener("DOMCharacterDataModified",this,!0),L.childList&&R.addEventListener("DOMNodeInserted",this,!0),(L.childList||L.subtree)&&R.addEventListener("DOMNodeRemoved",this,!0)},removeListeners:function(){this.removeListeners_(this.target)},removeListeners_:function(R){var L=this.options;L.attributes&&R.removeEventListener("DOMAttrModified",this,!0),L.characterData&&R.removeEventListener("DOMCharacterDataModified",this,!0),L.childList&&R.removeEventListener("DOMNodeInserted",this,!0),(L.childList||L.subtree)&&R.removeEventListener("DOMNodeRemoved",this,!0)},addTransientObserver:function(R){if(R!==this.target){this.addListeners_(R),this.transientObservedNodes.push(R);var L=p.get(R);L||p.set(R,L=[]),L.push(this)}},removeTransientObservers:function(){var R=this.transientObservedNodes;this.transientObservedNodes=[],R.forEach(function(L){this.removeListeners_(L);for(var E=p.get(L),C=0;C<E.length;C++)if(E[C]===this){E.splice(C,1);break}},this)},handleEvent:function(R){switch(R.stopImmediatePropagation(),R.type){case"DOMAttrModified":var L=R.attrName,E=R.relatedNode.namespaceURI,C=R.target,B=new l("attributes",C);B.attributeName=L,B.attributeNamespace=E;var S=R.attrChange===MutationEvent.ADDITION?null:R.prevValue;a(C,function(F){return!F.attributes||F.attributeFilter&&F.attributeFilter.length&&F.attributeFilter.indexOf(L)===-1&&F.attributeFilter.indexOf(E)===-1?void 0:F.attributeOldValue?n(S):B});break;case"DOMCharacterDataModified":var C=R.target,B=l("characterData",C),S=R.prevValue;a(C,function(F){return F.characterData?F.characterDataOldValue?n(S):B:void 0});break;case"DOMNodeRemoved":this.addTransientObserver(R.target);case"DOMNodeInserted":var T,N,P=R.target;R.type==="DOMNodeInserted"?(T=[P],N=[]):(T=[],N=[P]);var I=P.previousSibling,_=P.nextSibling,B=l("childList",R.target.parentNode);B.addedNodes=T,B.removedNodes=N,B.previousSibling=I,B.nextSibling=_,a(R.relatedNode,function(F){return F.childList?B:void 0})}h()}},b.JsMutationObserver=f,b.MutationObserver||(b.MutationObserver=f,f._isPolyfilled=!0)}}(self),function(){if(!window.performance||!window.performance.now){var b=Date.now();window.performance={now:function(){return Date.now()-b}}}window.requestAnimationFrame||(window.requestAnimationFrame=function(){var a=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame;return a?function(f){return a(function(){f(performance.now())})}:function(f){return window.setTimeout(f,1e3/60)}}()),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(){return window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||function(a){clearTimeout(a)}}());var y=function(){var a=document.createEvent("Event");return a.initEvent("foo",!0,!0),a.preventDefault(),a.defaultPrevented}();if(!y){var c=Event.prototype.preventDefault;Event.prototype.preventDefault=function(){this.cancelable&&(c.call(this),Object.defineProperty(this,"defaultPrevented",{get:function(){return!0},configurable:!0}))}}var s=/Trident/.test(navigator.userAgent);if((!window.CustomEvent||s&&typeof window.CustomEvent!="function")&&(window.CustomEvent=function(a,f){f=f||{};var o=document.createEvent("CustomEvent");return o.initCustomEvent(a,!!f.bubbles,!!f.cancelable,f.detail),o},window.CustomEvent.prototype=window.Event.prototype),!window.Event||s&&typeof window.Event!="function"){var e=window.Event;window.Event=function(a,f){f=f||{};var o=document.createEvent("Event");return o.initEvent(a,!!f.bubbles,!!f.cancelable),o},window.Event.prototype=e.prototype}}(),window.CustomElements=window.CustomElements||{flags:{}},function(b){var y=b.flags,c=[],s=function(a){c.push(a)},e=function(){c.forEach(function(a){a(b)})};b.addModule=s,b.initializeModules=e,b.hasNative=!!document.registerElement,b.isIE=/Trident/.test(navigator.userAgent),b.useNative=!y.register&&b.hasNative&&!window.ShadowDOMPolyfill&&(!window.HTMLImports||window.HTMLImports.useNative)}(window.CustomElements),window.CustomElements.addModule(function(b){function y(o,r){c(o,function(l){return r(l)?!0:void s(l,r)}),s(o,r)}function c(o,r,l){var n=o.firstElementChild;if(!n)for(n=o.firstChild;n&&n.nodeType!==Node.ELEMENT_NODE;)n=n.nextSibling;for(;n;)r(n,l)!==!0&&c(n,r,l),n=n.nextElementSibling;return null}function s(o,r){for(var l=o.shadowRoot;l;)y(l,r),l=l.olderShadowRoot}function e(o,r){a(o,r,[])}function a(o,r,l){if(o=window.wrap(o),!(l.indexOf(o)>=0)){l.push(o);for(var n,h=o.querySelectorAll("link[rel="+f+"]"),u=0,m=h.length;m>u&&(n=h[u]);u++)n.import&&a(n.import,r,l);r(o)}}var f=window.HTMLImports?window.HTMLImports.IMPORT_LINK_TYPE:"none";b.forDocumentTree=e,b.forSubtree=y}),window.CustomElements.addModule(function(b){function y(E,C){return c(E,C)||s(E,C)}function c(E,C){return b.upgrade(E,C)?!0:void(C&&f(E))}function s(E,C){A(E,function(S){return c(S,C)?!0:void 0})}function e(E){O.push(E),D||(D=!0,setTimeout(a))}function a(){D=!1;for(var E,C=O,S=0,T=C.length;T>S&&(E=C[S]);S++)E();O=[]}function f(E){k?e(function(){o(E)}):o(E)}function o(E){E.__upgraded__&&!E.__attached&&(E.__attached=!0,E.attachedCallback&&E.attachedCallback())}function r(E){l(E),A(E,function(C){l(C)})}function l(E){k?e(function(){n(E)}):n(E)}function n(E){E.__upgraded__&&E.__attached&&(E.__attached=!1,E.detachedCallback&&E.detachedCallback())}function h(E){for(var C=E,S=window.wrap(document);C;){if(C==S)return!0;C=C.parentNode||C.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&C.host}}function u(E){if(E.shadowRoot&&!E.shadowRoot.__watched){d.dom&&console.log("watching shadow-root for: ",E.localName);for(var C=E.shadowRoot;C;)i(C),C=C.olderShadowRoot}}function m(E,C){if(d.dom){var S=C[0];if(S&&S.type==="childList"&&S.addedNodes&&S.addedNodes){for(var T=S.addedNodes[0];T&&T!==document&&!T.host;)T=T.parentNode;var N=T&&(T.URL||T._URL||T.host&&T.host.localName)||"";N=N.split("/?").shift().split("/").pop()}console.group("mutations (%d) [%s]",C.length,N||"")}var P=h(E);C.forEach(function(I){I.type==="childList"&&(R(I.addedNodes,function(_){_.localName&&y(_,P)}),R(I.removedNodes,function(_){_.localName&&r(_)}))}),d.dom&&console.groupEnd()}function t(E){for(E=window.wrap(E),E||(E=window.wrap(document));E.parentNode;)E=E.parentNode;var C=E.__observer;C&&(m(E,C.takeRecords()),a())}function i(E){if(!E.__observer){var C=new MutationObserver(m.bind(this,E));C.observe(E,{childList:!0,subtree:!0}),E.__observer=C}}function p(E){E=window.wrap(E),d.dom&&console.group("upgradeDocument: ",E.baseURI.split("/").pop());var C=E===window.wrap(document);y(E,C),i(E),d.dom&&console.groupEnd()}function g(E){w(E,p)}var d=b.flags,A=b.forSubtree,w=b.forDocumentTree,k=window.MutationObserver._isPolyfilled&&d["throttle-attached"];b.hasPolyfillMutations=k,b.hasThrottledAttached=k;var D=!1,O=[],R=Array.prototype.forEach.call.bind(Array.prototype.forEach),L=Element.prototype.createShadowRoot;L&&(Element.prototype.createShadowRoot=function(){var E=L.call(this);return window.CustomElements.watchShadow(this),E}),b.watchShadow=u,b.upgradeDocumentTree=g,b.upgradeDocument=p,b.upgradeSubtree=s,b.upgradeAll=y,b.attached=f,b.takeRecords=t}),window.CustomElements.addModule(function(b){function y(o,r){if(o.localName==="template"&&window.HTMLTemplateElement&&HTMLTemplateElement.decorate&&HTMLTemplateElement.decorate(o),!o.__upgraded__&&o.nodeType===Node.ELEMENT_NODE){var l=o.getAttribute("is"),n=b.getRegisteredDefinition(o.localName)||b.getRegisteredDefinition(l);if(n&&(l&&n.tag==o.localName||!l&&!n.extends))return c(o,n,r)}}function c(o,r,l){return f.upgrade&&console.group("upgrade:",o.localName),r.is&&o.setAttribute("is",r.is),s(o,r),o.__upgraded__=!0,a(o),l&&b.attached(o),b.upgradeSubtree(o,l),f.upgrade&&console.groupEnd(),o}function s(o,r){Object.__proto__||e(o,r.prototype,r.native),o.__proto__=r.prototype}function e(o,r,l){for(var n={},h=r;h!==l&&h!==HTMLElement.prototype;){for(var u,m=Object.getOwnPropertyNames(h),t=0;u=m[t];t++)n[u]||(Object.defineProperty(o,u,Object.getOwnPropertyDescriptor(h,u)),n[u]=1);h=Object.getPrototypeOf(h)}}function a(o){o.createdCallback&&o.createdCallback()}var f=b.flags;b.upgrade=y,b.upgradeWithDefinition=c,b.implementPrototype=s}),window.CustomElements.addModule(function(b){function y(E,C){var S=C||{};if(!E)throw new Error("document.registerElement: first argument `name` must not be empty");if(E.indexOf("-")<0)throw new Error("document.registerElement: first argument ('name') must contain a dash ('-'). Argument provided was '"+String(E)+"'.");if(e(E))throw new Error("Failed to execute 'registerElement' on 'Document': Registration failed for type '"+String(E)+"'. The type name is invalid.");if(l(E))throw new Error("DuplicateDefinitionError: a type with name '"+String(E)+"' is already registered");return S.prototype||(S.prototype=Object.create(HTMLElement.prototype)),S.__name=E.toLowerCase(),S.extends&&(S.extends=S.extends.toLowerCase()),S.lifecycle=S.lifecycle||{},S.ancestry=a(S.extends),f(S),o(S),c(S.prototype),n(S.__name,S),S.ctor=h(S),S.ctor.prototype=S.prototype,S.prototype.constructor=S.ctor,b.ready&&p(document),S.ctor}function c(E){if(!E.setAttribute._polyfilled){var C=E.setAttribute;E.setAttribute=function(T,N){s.call(this,T,N,C)};var S=E.removeAttribute;E.removeAttribute=function(T){s.call(this,T,null,S)},E.setAttribute._polyfilled=!0}}function s(E,C,S){E=E.toLowerCase();var T=this.getAttribute(E);S.apply(this,arguments);var N=this.getAttribute(E);this.attributeChangedCallback&&N!==T&&this.attributeChangedCallback(E,T,N)}function e(E){for(var C=0;C<k.length;C++)if(E===k[C])return!0}function a(E){var C=l(E);return C?a(C.extends).concat([C]):[]}function f(E){for(var C,S=E.extends,T=0;C=E.ancestry[T];T++)S=C.is&&C.tag;E.tag=S||E.__name,S&&(E.is=E.__name)}function o(E){if(!Object.__proto__){var C=HTMLElement.prototype;if(E.is){var S=document.createElement(E.tag);C=Object.getPrototypeOf(S)}for(var T,N=E.prototype,P=!1;N;)N==C&&(P=!0),T=Object.getPrototypeOf(N),T&&(N.__proto__=T),N=T;P||console.warn(E.tag+" prototype not found in prototype chain for "+E.is),E.native=C}}function r(E){return d(R(E.tag),E)}function l(E){return E?D[E.toLowerCase()]:void 0}function n(E,C){D[E]=C}function h(E){return function(){return r(E)}}function u(E,C,S){return E===O?m(C,S):L(E,C)}function m(E,C){E&&(E=E.toLowerCase()),C&&(C=C.toLowerCase());var S=l(C||E);if(S){if(E==S.tag&&C==S.is)return new S.ctor;if(!C&&!S.is)return new S.ctor}var T;return C?(T=m(E),T.setAttribute("is",C),T):(T=R(E),E.indexOf("-")>=0&&A(T,HTMLElement),T)}function t(E,C){var S=E[C];E[C]=function(){var T=S.apply(this,arguments);return g(T),T}}var i,p=(b.isIE,b.upgradeDocumentTree),g=b.upgradeAll,d=b.upgradeWithDefinition,A=b.implementPrototype,w=b.useNative,k=["annotation-xml","color-profile","font-face","font-face-src","font-face-uri","font-face-format","font-face-name","missing-glyph"],D={},O="http://www.w3.org/1999/xhtml",R=document.createElement.bind(document),L=document.createElementNS.bind(document);i=Object.__proto__||w?function(E,C){return E instanceof C}:function(E,C){if(E instanceof C)return!0;for(var S=E;S;){if(S===C.prototype)return!0;S=S.__proto__}return!1},t(Node.prototype,"cloneNode"),t(document,"importNode"),document.registerElement=y,document.createElement=m,document.createElementNS=u,b.registry=D,b.instanceof=i,b.reservedTagList=k,b.getRegisteredDefinition=l,document.register=document.registerElement}),function(b){function y(){a(window.wrap(document)),window.CustomElements.ready=!0;var r=window.requestAnimationFrame||function(l){setTimeout(l,16)};r(function(){setTimeout(function(){window.CustomElements.readyTime=Date.now(),window.HTMLImports&&(window.CustomElements.elapsed=window.CustomElements.readyTime-window.HTMLImports.readyTime),document.dispatchEvent(new CustomEvent("WebComponentsReady",{bubbles:!0}))})})}var c=b.useNative,s=b.initializeModules;if(b.isIE,c){var e=function(){};b.watchShadow=e,b.upgrade=e,b.upgradeAll=e,b.upgradeDocumentTree=e,b.upgradeSubtree=e,b.takeRecords=e,b.instanceof=function(r,l){return r instanceof l}}else s();var a=b.upgradeDocumentTree,f=b.upgradeDocument;if(window.wrap||(window.ShadowDOMPolyfill?(window.wrap=window.ShadowDOMPolyfill.wrapIfNeeded,window.unwrap=window.ShadowDOMPolyfill.unwrapIfNeeded):window.wrap=window.unwrap=function(r){return r}),window.HTMLImports&&(window.HTMLImports.__importsParsingHook=function(r){r.import&&f(wrap(r.import))}),document.readyState==="complete"||b.flags.eager)y();else if(document.readyState!=="interactive"||window.attachEvent||window.HTMLImports&&!window.HTMLImports.ready){var o=window.HTMLImports&&!window.HTMLImports.ready?"HTMLImportsLoaded":"DOMContentLoaded";window.addEventListener(o,y)}else y()}(window.CustomElements))}).call(H),(function(){}).call(H),(function(){var M=this;(function(){(function(){this.Trix={VERSION:"1.3.1",ZERO_WIDTH_SPACE:"\uFEFF",NON_BREAKING_SPACE:" ",OBJECT_REPLACEMENT_CHARACTER:"￼",browser:{composesExistingText:/Android.*Chrome/.test(navigator.userAgent),forcesObjectResizing:/Trident.*rv:11/.test(navigator.userAgent),supportsInputEvents:function(){var x,b,y,c;if(typeof InputEvent>"u")return!1;for(c=["data","getTargetRanges","inputType"],x=0,b=c.length;b>x;x++)if(y=c[x],!(y in InputEvent.prototype))return!1;return!0}()},config:{}}}).call(this)}).call(M);var v=M.Trix;(function(){(function(){v.BasicObject=function(){function x(){}var b,y,c;return x.proxyMethod=function(s){var e,a,f,o,r;return f=y(s),e=f.name,o=f.toMethod,r=f.toProperty,a=f.optional,this.prototype[e]=function(){var l,n;return l=o!=null?a?typeof this[o]=="function"?this[o]():void 0:this[o]():r!=null?this[r]:void 0,a?(n=l!=null?l[e]:void 0,n!=null?b.call(n,l,arguments):void 0):(n=l[e],b.call(n,l,arguments))}},y=function(s){var e,a;if(!(a=s.match(c)))throw new Error("can't parse @proxyMethod expression: "+s);return e={name:a[4]},a[2]!=null?e.toMethod=a[1]:e.toProperty=a[1],a[3]!=null&&(e.optional=!0),e},b=Function.prototype.apply,c=/^(.+?)(\(\))?(\?)?\.(.+?)$/,x}()}).call(this),(function(){var x=function(y,c){function s(){this.constructor=y}for(var e in c)b.call(c,e)&&(y[e]=c[e]);return s.prototype=c.prototype,y.prototype=new s,y.__super__=c.prototype,y},b={}.hasOwnProperty;v.Object=function(y){function c(){this.id=++s}var s;return x(c,y),s=0,c.fromJSONString=function(e){return this.fromJSON(JSON.parse(e))},c.prototype.hasSameConstructorAs=function(e){return this.constructor===(e!=null?e.constructor:void 0)},c.prototype.isEqualTo=function(e){return this===e},c.prototype.inspect=function(){var e,a,f;return e=(function(){var o,r,l;r=(o=this.contentsForInspection())!=null?o:{},l=[];for(a in r)f=r[a],l.push(a+"="+f);return l}).call(this),"#<"+this.constructor.name+":"+this.id+(e.length?" "+e.join(", "):"")+">"},c.prototype.contentsForInspection=function(){},c.prototype.toJSONString=function(){return JSON.stringify(this)},c.prototype.toUTF16String=function(){return v.UTF16String.box(this)},c.prototype.getCacheKey=function(){return this.id.toString()},c}(v.BasicObject)}).call(this),(function(){v.extend=function(x){var b,y;for(b in x)y=x[b],this[b]=y;return this}}).call(this),(function(){v.extend({defer:function(x){return setTimeout(x,1)}})}).call(this),(function(){var x,b;v.extend({normalizeSpaces:function(y){return y.replace(RegExp(""+v.ZERO_WIDTH_SPACE,"g"),"").replace(RegExp(""+v.NON_BREAKING_SPACE,"g")," ")},normalizeNewlines:function(y){return y.replace(/\r\n/g,`
`)},breakableWhitespacePattern:RegExp("[^\\S"+v.NON_BREAKING_SPACE+"]"),squishBreakableWhitespace:function(y){return y.replace(RegExp(""+v.breakableWhitespacePattern.source,"g")," ").replace(/\ {2,}/g," ")},summarizeStringChange:function(y,c){var s,e,a,f;return y=v.UTF16String.box(y),c=v.UTF16String.box(c),c.length<y.length?(e=b(y,c),f=e[0],s=e[1]):(a=b(c,y),s=a[0],f=a[1]),{added:s,removed:f}}}),b=function(y,c){var s,e,a,f,o;return y.isEqualTo(c)?["",""]:(e=x(y,c),f=e.utf16String.length,a=f?(o=e.offset,s=y.codepoints.slice(0,o).concat(y.codepoints.slice(o+f)),x(c,v.UTF16String.fromCodepoints(s))):x(c,y),[e.utf16String.toString(),a.utf16String.toString()])},x=function(y,c){var s,e,a;for(s=0,e=y.length,a=c.length;e>s&&y.charAt(s).isEqualTo(c.charAt(s));)s++;for(;e>s+1&&y.charAt(e-1).isEqualTo(c.charAt(a-1));)e--,a--;return{utf16String:y.slice(s,e),offset:s}}}).call(this),(function(){v.extend({copyObject:function(x){var b,y,c;x==null&&(x={}),y={};for(b in x)c=x[b],y[b]=c;return y},objectsAreEqual:function(x,b){var y,c;if(x==null&&(x={}),b==null&&(b={}),Object.keys(x).length!==Object.keys(b).length)return!1;for(y in x)if(c=x[y],c!==b[y])return!1;return!0}})}).call(this),(function(){var x=[].slice;v.extend({arraysAreEqual:function(b,y){var c,s,e,a;if(b==null&&(b=[]),y==null&&(y=[]),b.length!==y.length)return!1;for(s=c=0,e=b.length;e>c;s=++c)if(a=b[s],a!==y[s])return!1;return!0},arrayStartsWith:function(b,y){return b==null&&(b=[]),y==null&&(y=[]),v.arraysAreEqual(b.slice(0,y.length),y)},spliceArray:function(){var b,y,c;return y=arguments[0],b=2<=arguments.length?x.call(arguments,1):[],c=y.slice(0),c.splice.apply(c,b),c},summarizeArrayChange:function(b,y){var c,s,e,a,f,o,r,l,n,h,u;for(b==null&&(b=[]),y==null&&(y=[]),c=[],h=[],e=new Set,a=0,r=b.length;r>a;a++)u=b[a],e.add(u);for(s=new Set,f=0,l=y.length;l>f;f++)u=y[f],s.add(u),e.has(u)||c.push(u);for(o=0,n=b.length;n>o;o++)u=b[o],s.has(u)||h.push(u);return{added:c,removed:h}}})}).call(this),(function(){var x,b,y,c;x=null,b=null,c=null,y=null,v.extend({getAllAttributeNames:function(){return x??(x=v.getTextAttributeNames().concat(v.getBlockAttributeNames()))},getBlockConfig:function(s){return v.config.blockAttributes[s]},getBlockAttributeNames:function(){return b??(b=Object.keys(v.config.blockAttributes))},getTextConfig:function(s){return v.config.textAttributes[s]},getTextAttributeNames:function(){return c??(c=Object.keys(v.config.textAttributes))},getListAttributeNames:function(){var s,e;return y??(y=function(){var a,f;a=v.config.blockAttributes,f=[];for(s in a)e=a[s].listAttribute,e!=null&&f.push(e);return f}())}})}).call(this),(function(){var x,b,y,c,s,e=[].indexOf||function(a){for(var f=0,o=this.length;o>f;f++)if(f in this&&this[f]===a)return f;return-1};x=document.documentElement,b=(y=(c=(s=x.matchesSelector)!=null?s:x.webkitMatchesSelector)!=null?c:x.msMatchesSelector)!=null?y:x.mozMatchesSelector,v.extend({handleEvent:function(a,f){var o,r,l,n,h,u,m,t,i,p,g;return m=f??{},h=m.onElement,n=m.matchingSelector,g=m.withCallback,l=m.inPhase,u=m.preventDefault,i=m.times,o=h??x,t=n,p=l==="capturing",r=function(d){var A;return i!=null&&--i===0&&r.destroy(),A=v.findClosestElementFromNode(d.target,{matchingSelector:t}),A!=null&&(g!=null&&g.call(A,d,A),u)?d.preventDefault():void 0},r.destroy=function(){return o.removeEventListener(a,r,p)},o.addEventListener(a,r,p),r},handleEventOnce:function(a,f){return f==null&&(f={}),f.times=1,v.handleEvent(a,f)},triggerEvent:function(a,f){var o,r,l,n,h,u,m;return m=f??{},u=m.onElement,r=m.bubbles,l=m.cancelable,o=m.attributes,n=u??x,r=r!==!1,l=l!==!1,h=document.createEvent("Events"),h.initEvent(a,r,l),o!=null&&v.extend.call(h,o),n.dispatchEvent(h)},elementMatchesSelector:function(a,f){return(a!=null?a.nodeType:void 0)===1?b.call(a,f):void 0},findClosestElementFromNode:function(a,f){var o,r,l;for(r=f??{},o=r.matchingSelector,l=r.untilNode;a!=null&&a.nodeType!==Node.ELEMENT_NODE;)a=a.parentNode;if(a!=null){if(o==null)return a;if(a.closest&&l==null)return a.closest(o);for(;a&&a!==l;){if(v.elementMatchesSelector(a,o))return a;a=a.parentNode}}},findInnerElement:function(a){for(;a!=null&&a.firstElementChild;)a=a.firstElementChild;return a},innerElementIsActive:function(a){return document.activeElement!==a&&v.elementContainsNode(a,document.activeElement)},elementContainsNode:function(a,f){if(a&&f)for(;f;){if(f===a)return!0;f=f.parentNode}},findNodeFromContainerAndOffset:function(a,f){var o;if(a)return a.nodeType===Node.TEXT_NODE?a:f===0?(o=a.firstChild)!=null?o:a:a.childNodes.item(f-1)},findElementFromContainerAndOffset:function(a,f){var o;return o=v.findNodeFromContainerAndOffset(a,f),v.findClosestElementFromNode(o)},findChildIndexOfNode:function(a){var f;if(a!=null&&a.parentNode){for(f=0;a=a.previousSibling;)f++;return f}},removeNode:function(a){var f;return a!=null&&(f=a.parentNode)!=null?f.removeChild(a):void 0},walkTree:function(a,f){var o,r,l,n,h;return l=f??{},r=l.onlyNodesOfType,n=l.usingFilter,o=l.expandEntityReferences,h=function(){switch(r){case"element":return NodeFilter.SHOW_ELEMENT;case"text":return NodeFilter.SHOW_TEXT;case"comment":return NodeFilter.SHOW_COMMENT;default:return NodeFilter.SHOW_ALL}}(),document.createTreeWalker(a,h,n??null,o===!0)},tagName:function(a){var f;return a!=null&&(f=a.tagName)!=null?f.toLowerCase():void 0},makeElement:function(a,f){var o,r,l,n,h,u,m,t,i,p,g,d,A,w;if(f==null&&(f={}),typeof a=="object"?(f=a,a=f.tagName):f={attributes:f},l=document.createElement(a),f.editable!=null&&(f.attributes==null&&(f.attributes={}),f.attributes.contenteditable=f.editable),f.attributes){i=f.attributes;for(u in i)w=i[u],l.setAttribute(u,w)}if(f.style){p=f.style;for(u in p)w=p[u],l.style[u]=w}if(f.data){g=f.data;for(u in g)w=g[u],l.dataset[u]=w}if(f.className)for(d=f.className.split(" "),n=0,m=d.length;m>n;n++)r=d[n],l.classList.add(r);if(f.textContent&&(l.textContent=f.textContent),f.childNodes)for(A=[].concat(f.childNodes),h=0,t=A.length;t>h;h++)o=A[h],l.appendChild(o);return l},getBlockTagNames:function(){var a,f;return v.blockTagNames!=null?v.blockTagNames:v.blockTagNames=function(){var o,r;o=v.config.blockAttributes,r=[];for(a in o)f=o[a].tagName,f&&r.push(f);return r}()},nodeIsBlockContainer:function(a){return v.nodeIsBlockStartComment(a!=null?a.firstChild:void 0)},nodeProbablyIsBlockContainer:function(a){var f,o;return f=v.tagName(a),e.call(v.getBlockTagNames(),f)>=0&&(o=v.tagName(a.firstChild),e.call(v.getBlockTagNames(),o)<0)},nodeIsBlockStart:function(a,f){var o;return o=(f??{strict:!0}).strict,o?v.nodeIsBlockStartComment(a):v.nodeIsBlockStartComment(a)||!v.nodeIsBlockStartComment(a.firstChild)&&v.nodeProbablyIsBlockContainer(a)},nodeIsBlockStartComment:function(a){return v.nodeIsCommentNode(a)&&(a!=null?a.data:void 0)==="block"},nodeIsCommentNode:function(a){return(a!=null?a.nodeType:void 0)===Node.COMMENT_NODE},nodeIsCursorTarget:function(a,f){var o;return o=(f??{}).name,a?v.nodeIsTextNode(a)?a.data===v.ZERO_WIDTH_SPACE?o?a.parentNode.dataset.trixCursorTarget===o:!0:void 0:v.nodeIsCursorTarget(a.firstChild):void 0},nodeIsAttachmentElement:function(a){return v.elementMatchesSelector(a,v.AttachmentView.attachmentSelector)},nodeIsEmptyTextNode:function(a){return v.nodeIsTextNode(a)&&(a!=null?a.data:void 0)===""},nodeIsTextNode:function(a){return(a!=null?a.nodeType:void 0)===Node.TEXT_NODE}})}).call(this),(function(){var x,b,y,c,s;x=v.copyObject,c=v.objectsAreEqual,v.extend({normalizeRange:y=function(e){var a;if(e!=null)return Array.isArray(e)||(e=[e,e]),[b(e[0]),b((a=e[1])!=null?a:e[0])]},rangeIsCollapsed:function(e){var a,f,o;if(e!=null)return f=y(e),o=f[0],a=f[1],s(o,a)},rangesAreEqual:function(e,a){var f,o,r,l,n,h;if(e!=null&&a!=null)return r=y(e),o=r[0],f=r[1],l=y(a),h=l[0],n=l[1],s(o,h)&&s(f,n)}}),b=function(e){return typeof e=="number"?e:x(e)},s=function(e,a){return typeof e=="number"?e===a:c(e,a)}}).call(this),(function(){var x,b,y,c,s,e,a;v.registerElement=function(f,o){var r,l;return o==null&&(o={}),f=f.toLowerCase(),o=a(o),l=e(o),(r=l.defaultCSS)&&(delete l.defaultCSS,c(r,f)),s(f,l)},c=function(f,o){var r;return r=y(o),r.textContent=f.replace(/%t/g,o)},y=function(f){var o,r;return o=document.createElement("style"),o.setAttribute("type","text/css"),o.setAttribute("data-tag-name",f.toLowerCase()),(r=x())&&o.setAttribute("nonce",r),document.head.insertBefore(o,document.head.firstChild),o},x=function(){var f;return(f=b("trix-csp-nonce")||b("csp-nonce"))?f.getAttribute("content"):void 0},b=function(f){return document.head.querySelector("meta[name="+f+"]")},e=function(f){var o,r,l;r={};for(o in f)l=f[o],r[o]=typeof l=="function"?{value:l}:l;return r},a=function(){var f;return f=function(o){var r,l,n,h,u;for(r={},u=["initialize","connect","disconnect"],l=0,h=u.length;h>l;l++)n=u[l],r[n]=o[n],delete o[n];return r},window.customElements?function(o){var r,l,n,h,u;return u=f(o),n=u.initialize,r=u.connect,l=u.disconnect,n&&(h=r,r=function(){return this.initialized||(this.initialized=!0,n.call(this)),h!=null?h.call(this):void 0}),r&&(o.connectedCallback=r),l&&(o.disconnectedCallback=l),o}:function(o){var r,l,n,h;return h=f(o),n=h.initialize,r=h.connect,l=h.disconnect,n&&(o.createdCallback=n),r&&(o.attachedCallback=r),l&&(o.detachedCallback=l),o}}(),s=function(){return window.customElements?function(f,o){var r;return r=function(){return typeof Reflect=="object"?Reflect.construct(HTMLElement,[],r):HTMLElement.apply(this)},Object.setPrototypeOf(r.prototype,HTMLElement.prototype),Object.setPrototypeOf(r,HTMLElement),Object.defineProperties(r.prototype,o),window.customElements.define(f,r),r}:function(f,o){var r,l;return l=Object.create(HTMLElement.prototype,o),r=document.registerElement(f,{prototype:l}),Object.defineProperty(l,"constructor",{value:r}),r}}()}).call(this),(function(){var x,b;v.extend({getDOMSelection:function(){var y;return y=window.getSelection(),y.rangeCount>0?y:void 0},getDOMRange:function(){var y,c;return(y=(c=v.getDOMSelection())!=null?c.getRangeAt(0):void 0)&&!x(y)?y:void 0},setDOMRange:function(y){var c;return c=window.getSelection(),c.removeAllRanges(),c.addRange(y),v.selectionChangeObserver.update()}}),x=function(y){return b(y.startContainer)||b(y.endContainer)},b=function(y){return!Object.getPrototypeOf(y)}}).call(this),(function(){var x;x={"application/x-trix-feature-detection":"test"},v.extend({dataTransferIsPlainText:function(b){var y,c,s;return s=b.getData("text/plain"),c=b.getData("text/html"),s&&c?(y=new DOMParser().parseFromString(c,"text/html").body,y.textContent===s?!y.querySelector("*"):void 0):s!=null?s.length:void 0},dataTransferIsWritable:function(b){var y,c;if((b!=null?b.setData:void 0)!=null){for(y in x)if(c=x[y],!function(){try{return b.setData(y,c),b.getData(y)===c}catch{}}())return;return!0}},keyEventIsKeyboardCommand:function(){return/Mac|^iP/.test(navigator.platform)?function(b){return b.metaKey}:function(b){return b.ctrlKey}}()})}).call(this),(function(){v.extend({RTL_PATTERN:/[\u05BE\u05C0\u05C3\u05D0-\u05EA\u05F0-\u05F4\u061B\u061F\u0621-\u063A\u0640-\u064A\u066D\u0671-\u06B7\u06BA-\u06BE\u06C0-\u06CE\u06D0-\u06D5\u06E5\u06E6\u200F\u202B\u202E\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE72\uFE74\uFE76-\uFEFC]/,getDirection:function(){var x,b,y,c;return b=v.makeElement("input",{dir:"auto",name:"x",dirName:"x.dir"}),x=v.makeElement("form"),x.appendChild(b),y=function(){try{return new FormData(x).has(b.dirName)}catch{}}(),c=function(){try{return b.matches(":dir(ltr),:dir(rtl)")}catch{}}(),y?function(s){return b.value=s,new FormData(x).get(b.dirName)}:c?function(s){return b.value=s,b.matches(":dir(rtl)")?"rtl":"ltr"}:function(s){var e;return e=s.trim().charAt(0),v.RTL_PATTERN.test(e)?"rtl":"ltr"}}()})}).call(this),(function(){}).call(this),(function(){var x,b=function(c,s){function e(){this.constructor=c}for(var a in s)y.call(s,a)&&(c[a]=s[a]);return e.prototype=s.prototype,c.prototype=new e,c.__super__=s.prototype,c},y={}.hasOwnProperty;x=v.arraysAreEqual,v.Hash=function(c){function s(l){l==null&&(l={}),this.values=a(l),s.__super__.constructor.apply(this,arguments)}var e,a,f,o,r;return b(s,c),s.fromCommonAttributesOfObjects=function(l){var n,h,u,m,t,i;if(l==null&&(l=[]),!l.length)return new this;for(n=e(l[0]),u=n.getKeys(),i=l.slice(1),h=0,m=i.length;m>h;h++)t=i[h],u=n.getKeysCommonToHash(e(t)),n=n.slice(u);return n},s.box=function(l){return e(l)},s.prototype.add=function(l,n){return this.merge(o(l,n))},s.prototype.remove=function(l){return new v.Hash(a(this.values,l))},s.prototype.get=function(l){return this.values[l]},s.prototype.has=function(l){return l in this.values},s.prototype.merge=function(l){return new v.Hash(f(this.values,r(l)))},s.prototype.slice=function(l){var n,h,u,m;for(m={},n=0,u=l.length;u>n;n++)h=l[n],this.has(h)&&(m[h]=this.values[h]);return new v.Hash(m)},s.prototype.getKeys=function(){return Object.keys(this.values)},s.prototype.getKeysCommonToHash=function(l){var n,h,u,m,t;for(l=e(l),m=this.getKeys(),t=[],n=0,u=m.length;u>n;n++)h=m[n],this.values[h]===l.values[h]&&t.push(h);return t},s.prototype.isEqualTo=function(l){return x(this.toArray(),e(l).toArray())},s.prototype.isEmpty=function(){return this.getKeys().length===0},s.prototype.toArray=function(){var l,n,h;return(this.array!=null?this.array:this.array=(function(){var u;n=[],u=this.values;for(l in u)h=u[l],n.push(l,h);return n}).call(this)).slice(0)},s.prototype.toObject=function(){return a(this.values)},s.prototype.toJSON=function(){return this.toObject()},s.prototype.contentsForInspection=function(){return{values:JSON.stringify(this.values)}},o=function(l,n){var h;return h={},h[l]=n,h},f=function(l,n){var h,u,m;u=a(l);for(h in n)m=n[h],u[h]=m;return u},a=function(l,n){var h,u,m,t,i;for(t={},i=Object.keys(l).sort(),h=0,m=i.length;m>h;h++)u=i[h],u!==n&&(t[u]=l[u]);return t},e=function(l){return l instanceof v.Hash?l:new v.Hash(l)},r=function(l){return l instanceof v.Hash?l.values:l},s}(v.Object)}).call(this),(function(){v.ObjectGroup=function(){function x(b,y){var c,s;this.objects=b??[],s=y.depth,c=y.asTree,c&&(this.depth=s,this.objects=this.constructor.groupObjects(this.objects,{asTree:c,depth:this.depth+1}))}return x.groupObjects=function(b,y){var c,s,e,a,f,o,r,l,n;for(b==null&&(b=[]),n=y??{},e=n.depth,c=n.asTree,c&&e==null&&(e=0),l=[],f=0,o=b.length;o>f;f++){if(r=b[f],a){if(typeof r.canBeGrouped=="function"&&r.canBeGrouped(e)&&(typeof(s=a[a.length-1]).canBeGroupedWith=="function"&&s.canBeGroupedWith(r,e))){a.push(r);continue}l.push(new this(a,{depth:e,asTree:c})),a=null}typeof r.canBeGrouped=="function"&&r.canBeGrouped(e)?a=[r]:l.push(r)}return a&&l.push(new this(a,{depth:e,asTree:c})),l},x.prototype.getObjects=function(){return this.objects},x.prototype.getDepth=function(){return this.depth},x.prototype.getCacheKey=function(){var b,y,c,s,e;for(y=["objectGroup"],e=this.getObjects(),b=0,c=e.length;c>b;b++)s=e[b],y.push(s.getCacheKey());return y.join("/")},x}()}).call(this),(function(){var x=function(y,c){function s(){this.constructor=y}for(var e in c)b.call(c,e)&&(y[e]=c[e]);return s.prototype=c.prototype,y.prototype=new s,y.__super__=c.prototype,y},b={}.hasOwnProperty;v.ObjectMap=function(y){function c(s){var e,a,f,o,r;for(s==null&&(s=[]),this.objects={},f=0,o=s.length;o>f;f++)r=s[f],a=JSON.stringify(r),(e=this.objects)[a]==null&&(e[a]=r)}return x(c,y),c.prototype.find=function(s){var e;return e=JSON.stringify(s),this.objects[e]},c}(v.BasicObject)}).call(this),(function(){v.ElementStore=function(){function x(y){this.reset(y)}var b;return x.prototype.add=function(y){var c;return c=b(y),this.elements[c]=y},x.prototype.remove=function(y){var c,s;return c=b(y),(s=this.elements[c])?(delete this.elements[c],s):void 0},x.prototype.reset=function(y){var c,s,e;for(y==null&&(y=[]),this.elements={},s=0,e=y.length;e>s;s++)c=y[s],this.add(c);return y},b=function(y){return y.dataset.trixStoreKey},x}()}).call(this),(function(){}).call(this),(function(){var x=function(y,c){function s(){this.constructor=y}for(var e in c)b.call(c,e)&&(y[e]=c[e]);return s.prototype=c.prototype,y.prototype=new s,y.__super__=c.prototype,y},b={}.hasOwnProperty;v.Operation=function(y){function c(){return c.__super__.constructor.apply(this,arguments)}return x(c,y),c.prototype.isPerforming=function(){return this.performing===!0},c.prototype.hasPerformed=function(){return this.performed===!0},c.prototype.hasSucceeded=function(){return this.performed&&this.succeeded},c.prototype.hasFailed=function(){return this.performed&&!this.succeeded},c.prototype.getPromise=function(){return this.promise!=null?this.promise:this.promise=new Promise(function(s){return function(e,a){return s.performing=!0,s.perform(function(f,o){return s.succeeded=f,s.performing=!1,s.performed=!0,s.succeeded?e(o):a(o)})}}(this))},c.prototype.perform=function(s){return s(!1)},c.prototype.release=function(){var s;return(s=this.promise)!=null&&typeof s.cancel=="function"&&s.cancel(),this.promise=null,this.performing=null,this.performed=null,this.succeeded=null},c.proxyMethod("getPromise().then"),c.proxyMethod("getPromise().catch"),c}(v.BasicObject)}).call(this),(function(){var x,b,y,c,s,e=function(f,o){function r(){this.constructor=f}for(var l in o)a.call(o,l)&&(f[l]=o[l]);return r.prototype=o.prototype,f.prototype=new r,f.__super__=o.prototype,f},a={}.hasOwnProperty;v.UTF16String=function(f){function o(r,l){this.ucs2String=r,this.codepoints=l,this.length=this.codepoints.length,this.ucs2Length=this.ucs2String.length}return e(o,f),o.box=function(r){return r==null&&(r=""),r instanceof this?r:this.fromUCS2String(r!=null?r.toString():void 0)},o.fromUCS2String=function(r){return new this(r,c(r))},o.fromCodepoints=function(r){return new this(s(r),r)},o.prototype.offsetToUCS2Offset=function(r){return s(this.codepoints.slice(0,Math.max(0,r))).length},o.prototype.offsetFromUCS2Offset=function(r){return c(this.ucs2String.slice(0,Math.max(0,r))).length},o.prototype.slice=function(){var r;return this.constructor.fromCodepoints((r=this.codepoints).slice.apply(r,arguments))},o.prototype.charAt=function(r){return this.slice(r,r+1)},o.prototype.isEqualTo=function(r){return this.constructor.box(r).ucs2String===this.ucs2String},o.prototype.toJSON=function(){return this.ucs2String},o.prototype.getCacheKey=function(){return this.ucs2String},o.prototype.toString=function(){return this.ucs2String},o}(v.BasicObject),x=(typeof Array.from=="function"?Array.from("👼").length:void 0)===1,b=(typeof" ".codePointAt=="function"?" ".codePointAt(0):void 0)!=null,y=(typeof String.fromCodePoint=="function"?String.fromCodePoint(32,128124):void 0)===" 👼",c=x&&b?function(f){return Array.from(f).map(function(o){return o.codePointAt(0)})}:function(f){var o,r,l,n,h;for(n=[],o=0,l=f.length;l>o;)h=f.charCodeAt(o++),h>=55296&&56319>=h&&l>o&&(r=f.charCodeAt(o++),(64512&r)===56320?h=((1023&h)<<10)+(1023&r)+65536:o--),n.push(h);return n},s=y?function(f){return String.fromCodePoint.apply(String,f)}:function(f){var o,r,l;return o=function(){var n,h,u;for(u=[],n=0,h=f.length;h>n;n++)l=f[n],r="",l>65535&&(l-=65536,r+=String.fromCharCode(l>>>10&1023|55296),l=56320|1023&l),u.push(r+String.fromCharCode(l));return u}(),o.join("")}}).call(this),(function(){}).call(this),(function(){}).call(this),(function(){v.config.lang={attachFiles:"Attach Files",bold:"Bold",bullets:"Bullets",byte:"Byte",bytes:"Bytes",captionPlaceholder:"Add a caption…",code:"Code",heading1:"Heading",indent:"Increase Level",italic:"Italic",link:"Link",numbers:"Numbers",outdent:"Decrease Level",quote:"Quote",redo:"Redo",remove:"Remove",strike:"Strikethrough",undo:"Undo",unlink:"Unlink",url:"URL",urlPlaceholder:"Enter a URL…",GB:"GB",KB:"KB",MB:"MB",PB:"PB",TB:"TB"}}).call(this),(function(){v.config.css={attachment:"attachment",attachmentCaption:"attachment__caption",attachmentCaptionEditor:"attachment__caption-editor",attachmentMetadata:"attachment__metadata",attachmentMetadataContainer:"attachment__metadata-container",attachmentName:"attachment__name",attachmentProgress:"attachment__progress",attachmentSize:"attachment__size",attachmentToolbar:"attachment__toolbar",attachmentGallery:"attachment-gallery"}}).call(this),(function(){var x;v.config.blockAttributes=x={default:{tagName:"div",parse:!1},quote:{tagName:"blockquote",nestable:!0},heading1:{tagName:"h1",terminal:!0,breakOnReturn:!0,group:!1},code:{tagName:"pre",terminal:!0,text:{plaintext:!0}},bulletList:{tagName:"ul",parse:!1},bullet:{tagName:"li",listAttribute:"bulletList",group:!1,nestable:!0,test:function(b){return v.tagName(b.parentNode)===x[this.listAttribute].tagName}},numberList:{tagName:"ol",parse:!1},number:{tagName:"li",listAttribute:"numberList",group:!1,nestable:!0,test:function(b){return v.tagName(b.parentNode)===x[this.listAttribute].tagName}},attachmentGallery:{tagName:"div",exclusive:!0,terminal:!0,parse:!1,group:!1}}}).call(this),(function(){var x,b;x=v.config.lang,b=[x.bytes,x.KB,x.MB,x.GB,x.TB,x.PB],v.config.fileSize={prefix:"IEC",precision:2,formatter:function(y){var c,s,e,a,f;switch(y){case 0:return"0 "+x.bytes;case 1:return"1 "+x.byte;default:return c=(function(){switch(this.prefix){case"SI":return 1e3;case"IEC":return 1024}}).call(this),s=Math.floor(Math.log(y)/Math.log(c)),e=y/Math.pow(c,s),a=e.toFixed(this.precision),f=a.replace(/0*$/,"").replace(/\.$/,""),f+" "+b[s]}}}}).call(this),(function(){v.config.textAttributes={bold:{tagName:"strong",inheritable:!0,parser:function(x){var b;return b=window.getComputedStyle(x),b.fontWeight==="bold"||b.fontWeight>=600}},italic:{tagName:"em",inheritable:!0,parser:function(x){var b;return b=window.getComputedStyle(x),b.fontStyle==="italic"}},href:{groupTagName:"a",parser:function(x){var b,y,c;return b=v.AttachmentView.attachmentSelector,c="a:not("+b+")",(y=v.findClosestElementFromNode(x,{matchingSelector:c}))?y.getAttribute("href"):void 0}},strike:{tagName:"del",inheritable:!0},frozen:{style:{backgroundColor:"highlight"}}}}).call(this),(function(){var x,b,y,c,s;s="[data-trix-serialize=false]",c=["contenteditable","data-trix-id","data-trix-store-key","data-trix-mutable","data-trix-placeholder","tabindex"],b="data-trix-serialized-attributes",y="["+b+"]",x=new RegExp("<!--block-->","g"),v.extend({serializers:{"application/json":function(e){var a;if(e instanceof v.Document)a=e;else{if(!(e instanceof HTMLElement))throw new Error("unserializable object");a=v.Document.fromHTML(e.innerHTML)}return a.toSerializableDocument().toJSONString()},"text/html":function(e){var a,f,o,r,l,n,h,u,m,t,i,p,g,d,A,w,k;if(e instanceof v.Document)r=v.DocumentView.render(e);else{if(!(e instanceof HTMLElement))throw new Error("unserializable object");r=e.cloneNode(!0)}for(d=r.querySelectorAll(s),l=0,m=d.length;m>l;l++)o=d[l],v.removeNode(o);for(n=0,t=c.length;t>n;n++)for(a=c[n],A=r.querySelectorAll("["+a+"]"),h=0,i=A.length;i>h;h++)o=A[h],o.removeAttribute(a);for(w=r.querySelectorAll(y),u=0,p=w.length;p>u;u++){o=w[u];try{f=JSON.parse(o.getAttribute(b)),o.removeAttribute(b);for(g in f)k=f[g],o.setAttribute(g,k)}catch{}}return r.innerHTML.replace(x,"")}},deserializers:{"application/json":function(e){return v.Document.fromJSONString(e)},"text/html":function(e){return v.Document.fromHTML(e)}},serializeToContentType:function(e,a){var f;if(f=v.serializers[a])return f(e);throw new Error("unknown content type: "+a)},deserializeFromContentType:function(e,a){var f;if(f=v.deserializers[a])return f(e);throw new Error("unknown content type: "+a)}})}).call(this),(function(){var x;x=v.config.lang,v.config.toolbar={getDefaultHTML:function(){return`<div class="trix-button-row">
  <span class="trix-button-group trix-button-group--text-tools" data-trix-button-group="text-tools">
    <button type="button" class="trix-button trix-button--icon trix-button--icon-bold" data-trix-attribute="bold" data-trix-key="b" title="`+x.bold+'" tabindex="-1">'+x.bold+`</button>
    <button type="button" class="trix-button trix-button--icon trix-button--icon-italic" data-trix-attribute="italic" data-trix-key="i" title="`+x.italic+'" tabindex="-1">'+x.italic+`</button>
    <button type="button" class="trix-button trix-button--icon trix-button--icon-strike" data-trix-attribute="strike" title="`+x.strike+'" tabindex="-1">'+x.strike+`</button>
    <button type="button" class="trix-button trix-button--icon trix-button--icon-link" data-trix-attribute="href" data-trix-action="link" data-trix-key="k" title="`+x.link+'" tabindex="-1">'+x.link+`</button>
  </span>

  <span class="trix-button-group trix-button-group--block-tools" data-trix-button-group="block-tools">
    <button type="button" class="trix-button trix-button--icon trix-button--icon-heading-1" data-trix-attribute="heading1" title="`+x.heading1+'" tabindex="-1">'+x.heading1+`</button>
    <button type="button" class="trix-button trix-button--icon trix-button--icon-quote" data-trix-attribute="quote" title="`+x.quote+'" tabindex="-1">'+x.quote+`</button>
    <button type="button" class="trix-button trix-button--icon trix-button--icon-code" data-trix-attribute="code" title="`+x.code+'" tabindex="-1">'+x.code+`</button>
    <button type="button" class="trix-button trix-button--icon trix-button--icon-bullet-list" data-trix-attribute="bullet" title="`+x.bullets+'" tabindex="-1">'+x.bullets+`</button>
    <button type="button" class="trix-button trix-button--icon trix-button--icon-number-list" data-trix-attribute="number" title="`+x.numbers+'" tabindex="-1">'+x.numbers+`</button>
    <button type="button" class="trix-button trix-button--icon trix-button--icon-decrease-nesting-level" data-trix-action="decreaseNestingLevel" title="`+x.outdent+'" tabindex="-1">'+x.outdent+`</button>
    <button type="button" class="trix-button trix-button--icon trix-button--icon-increase-nesting-level" data-trix-action="increaseNestingLevel" title="`+x.indent+'" tabindex="-1">'+x.indent+`</button>
  </span>

  <span class="trix-button-group trix-button-group--file-tools" data-trix-button-group="file-tools">
    <button type="button" class="trix-button trix-button--icon trix-button--icon-attach" data-trix-action="attachFiles" title="`+x.attachFiles+'" tabindex="-1">'+x.attachFiles+`</button>
  </span>

  <span class="trix-button-group-spacer"></span>

  <span class="trix-button-group trix-button-group--history-tools" data-trix-button-group="history-tools">
    <button type="button" class="trix-button trix-button--icon trix-button--icon-undo" data-trix-action="undo" data-trix-key="z" title="`+x.undo+'" tabindex="-1">'+x.undo+`</button>
    <button type="button" class="trix-button trix-button--icon trix-button--icon-redo" data-trix-action="redo" data-trix-key="shift+z" title="`+x.redo+'" tabindex="-1">'+x.redo+`</button>
  </span>
</div>

<div class="trix-dialogs" data-trix-dialogs>
  <div class="trix-dialog trix-dialog--link" data-trix-dialog="href" data-trix-dialog-attribute="href">
    <div class="trix-dialog__link-fields">
      <input type="url" name="href" class="trix-input trix-input--dialog" placeholder="`+x.urlPlaceholder+'" aria-label="'+x.url+`" required data-trix-input>
      <div class="trix-button-group">
        <input type="button" class="trix-button trix-button--dialog" value="`+x.link+`" data-trix-method="setAttribute">
        <input type="button" class="trix-button trix-button--dialog" value="`+x.unlink+`" data-trix-method="removeAttribute">
      </div>
    </div>
  </div>
</div>`}}}).call(this),(function(){v.config.undoInterval=5e3}).call(this),(function(){v.config.attachments={preview:{presentation:"gallery",caption:{name:!0,size:!0}},file:{caption:{size:!0}}}}).call(this),(function(){v.config.keyNames={8:"backspace",9:"tab",13:"return",27:"escape",37:"left",39:"right",46:"delete",68:"d",72:"h",79:"o"}}).call(this),(function(){v.config.input={level2Enabled:!0,getLevel:function(){return this.level2Enabled&&v.browser.supportsInputEvents?2:0},pickFiles:function(x){var b;return b=v.makeElement("input",{type:"file",multiple:!0,hidden:!0,id:this.fileInputId}),b.addEventListener("change",function(){return x(b.files),v.removeNode(b)}),v.removeNode(document.getElementById(this.fileInputId)),document.body.appendChild(b),b.click()},fileInputId:"trix-file-input-"+Date.now().toString(16)}}).call(this),(function(){}).call(this),(function(){v.registerElement("trix-toolbar",{defaultCSS:`%t {
  display: block;
}

%t {
  white-space: nowrap;
}

%t [data-trix-dialog] {
  display: none;
}

%t [data-trix-dialog][data-trix-active] {
  display: block;
}

%t [data-trix-dialog] [data-trix-validate]:invalid {
  background-color: #ffdddd;
}`,initialize:function(){return this.innerHTML===""?this.innerHTML=v.config.toolbar.getDefaultHTML():void 0}})}).call(this),(function(){var x=function(c,s){function e(){this.constructor=c}for(var a in s)b.call(s,a)&&(c[a]=s[a]);return e.prototype=s.prototype,c.prototype=new e,c.__super__=s.prototype,c},b={}.hasOwnProperty,y=[].indexOf||function(c){for(var s=0,e=this.length;e>s;s++)if(s in this&&this[s]===c)return s;return-1};v.ObjectView=function(c){function s(e,a){this.object=e,this.options=a??{},this.childViews=[],this.rootView=this}return x(s,c),s.prototype.getNodes=function(){var e,a,f,o,r;for(this.nodes==null&&(this.nodes=this.createNodes()),o=this.nodes,r=[],e=0,a=o.length;a>e;e++)f=o[e],r.push(f.cloneNode(!0));return r},s.prototype.invalidate=function(){var e;return this.nodes=null,this.childViews=[],(e=this.parentView)!=null?e.invalidate():void 0},s.prototype.invalidateViewForObject=function(e){var a;return(a=this.findViewForObject(e))!=null?a.invalidate():void 0},s.prototype.findOrCreateCachedChildView=function(e,a){var f;return(f=this.getCachedViewForObject(a))?this.recordChildView(f):(f=this.createChildView.apply(this,arguments),this.cacheViewForObject(f,a)),f},s.prototype.createChildView=function(e,a,f){var o;return f==null&&(f={}),a instanceof v.ObjectGroup&&(f.viewClass=e,e=v.ObjectGroupView),o=new e(a,f),this.recordChildView(o)},s.prototype.recordChildView=function(e){return e.parentView=this,e.rootView=this.rootView,this.childViews.push(e),e},s.prototype.getAllChildViews=function(){var e,a,f,o,r;for(r=[],o=this.childViews,a=0,f=o.length;f>a;a++)e=o[a],r.push(e),r=r.concat(e.getAllChildViews());return r},s.prototype.findElement=function(){return this.findElementForObject(this.object)},s.prototype.findElementForObject=function(e){var a;return(a=e!=null?e.id:void 0)?this.rootView.element.querySelector("[data-trix-id='"+a+"']"):void 0},s.prototype.findViewForObject=function(e){var a,f,o,r;for(o=this.getAllChildViews(),a=0,f=o.length;f>a;a++)if(r=o[a],r.object===e)return r},s.prototype.getViewCache=function(){return this.rootView!==this?this.rootView.getViewCache():this.isViewCachingEnabled()?this.viewCache!=null?this.viewCache:this.viewCache={}:void 0},s.prototype.isViewCachingEnabled=function(){return this.shouldCacheViews!==!1},s.prototype.enableViewCaching=function(){return this.shouldCacheViews=!0},s.prototype.disableViewCaching=function(){return this.shouldCacheViews=!1},s.prototype.getCachedViewForObject=function(e){var a;return(a=this.getViewCache())!=null?a[e.getCacheKey()]:void 0},s.prototype.cacheViewForObject=function(e,a){var f;return(f=this.getViewCache())!=null?f[a.getCacheKey()]=e:void 0},s.prototype.garbageCollectCachedViews=function(){var e,a,f,o,r,l;if(e=this.getViewCache()){l=this.getAllChildViews().concat(this),f=function(){var n,h,u;for(u=[],n=0,h=l.length;h>n;n++)r=l[n],u.push(r.object.getCacheKey());return u}(),o=[];for(a in e)y.call(f,a)<0&&o.push(delete e[a]);return o}},s}(v.BasicObject)}).call(this),(function(){var x=function(y,c){function s(){this.constructor=y}for(var e in c)b.call(c,e)&&(y[e]=c[e]);return s.prototype=c.prototype,y.prototype=new s,y.__super__=c.prototype,y},b={}.hasOwnProperty;v.ObjectGroupView=function(y){function c(){c.__super__.constructor.apply(this,arguments),this.objectGroup=this.object,this.viewClass=this.options.viewClass,delete this.options.viewClass}return x(c,y),c.prototype.getChildViews=function(){var s,e,a,f;if(!this.childViews.length)for(f=this.objectGroup.getObjects(),s=0,e=f.length;e>s;s++)a=f[s],this.findOrCreateCachedChildView(this.viewClass,a,this.options);return this.childViews},c.prototype.createNodes=function(){var s,e,a,f,o,r,l,n,h;for(s=this.createContainerElement(),l=this.getChildViews(),e=0,f=l.length;f>e;e++)for(h=l[e],n=h.getNodes(),a=0,o=n.length;o>a;a++)r=n[a],s.appendChild(r);return[s]},c.prototype.createContainerElement=function(s){return s==null&&(s=this.objectGroup.getDepth()),this.getChildViews()[0].createContainerElement(s)},c}(v.ObjectView)}).call(this),(function(){var x=function(y,c){function s(){this.constructor=y}for(var e in c)b.call(c,e)&&(y[e]=c[e]);return s.prototype=c.prototype,y.prototype=new s,y.__super__=c.prototype,y},b={}.hasOwnProperty;v.Controller=function(y){function c(){return c.__super__.constructor.apply(this,arguments)}return x(c,y),c}(v.BasicObject)}).call(this),(function(){var x,b,y,c,s,e,a=function(l,n){return function(){return l.apply(n,arguments)}},f=function(l,n){function h(){this.constructor=l}for(var u in n)o.call(n,u)&&(l[u]=n[u]);return h.prototype=n.prototype,l.prototype=new h,l.__super__=n.prototype,l},o={}.hasOwnProperty,r=[].indexOf||function(l){for(var n=0,h=this.length;h>n;n++)if(n in this&&this[n]===l)return n;return-1};x=v.findClosestElementFromNode,y=v.nodeIsEmptyTextNode,b=v.nodeIsBlockStartComment,c=v.normalizeSpaces,s=v.summarizeStringChange,e=v.tagName,v.MutationObserver=function(l){function n(i){this.element=i,this.didMutate=a(this.didMutate,this),this.observer=new window.MutationObserver(this.didMutate),this.start()}var h,u,m,t;return f(n,l),u="data-trix-mutable",m="["+u+"]",t={attributes:!0,childList:!0,characterData:!0,characterDataOldValue:!0,subtree:!0},n.prototype.start=function(){return this.reset(),this.observer.observe(this.element,t)},n.prototype.stop=function(){return this.observer.disconnect()},n.prototype.didMutate=function(i){var p,g;return(p=this.mutations).push.apply(p,this.findSignificantMutations(i)),this.mutations.length?((g=this.delegate)!=null&&typeof g.elementDidMutate=="function"&&g.elementDidMutate(this.getMutationSummary()),this.reset()):void 0},n.prototype.reset=function(){return this.mutations=[]},n.prototype.findSignificantMutations=function(i){var p,g,d,A;for(A=[],p=0,g=i.length;g>p;p++)d=i[p],this.mutationIsSignificant(d)&&A.push(d);return A},n.prototype.mutationIsSignificant=function(i){var p,g,d,A;if(this.nodeIsMutable(i.target))return!1;for(A=this.nodesModifiedByMutation(i),p=0,g=A.length;g>p;p++)if(d=A[p],this.nodeIsSignificant(d))return!0;return!1},n.prototype.nodeIsSignificant=function(i){return i!==this.element&&!this.nodeIsMutable(i)&&!y(i)},n.prototype.nodeIsMutable=function(i){return x(i,{matchingSelector:m})},n.prototype.nodesModifiedByMutation=function(i){var p;switch(p=[],i.type){case"attributes":i.attributeName!==u&&p.push(i.target);break;case"characterData":p.push(i.target.parentNode),p.push(i.target);break;case"childList":p.push.apply(p,i.addedNodes),p.push.apply(p,i.removedNodes)}return p},n.prototype.getMutationSummary=function(){return this.getTextMutationSummary()},n.prototype.getTextMutationSummary=function(){var i,p,g,d,A,w,k,D,O,R,L;for(D=this.getTextChangesFromCharacterData(),g=D.additions,A=D.deletions,L=this.getTextChangesFromChildList(),O=L.additions,w=0,k=O.length;k>w;w++)p=O[w],r.call(g,p)<0&&g.push(p);return A.push.apply(A,L.deletions),R={},(i=g.join(""))&&(R.textAdded=i),(d=A.join(""))&&(R.textDeleted=d),R},n.prototype.getMutationsByType=function(i){var p,g,d,A,w;for(A=this.mutations,w=[],p=0,g=A.length;g>p;p++)d=A[p],d.type===i&&w.push(d);return w},n.prototype.getTextChangesFromChildList=function(){var i,p,g,d,A,w,k,D,O,R,L;for(i=[],k=[],w=this.getMutationsByType("childList"),p=0,d=w.length;d>p;p++)A=w[p],i.push.apply(i,A.addedNodes),k.push.apply(k,A.removedNodes);return D=i.length===0&&k.length===1&&b(k[0]),D?(R=[],L=[`
`]):(R=h(i),L=h(k)),{additions:function(){var E,C,S;for(S=[],g=E=0,C=R.length;C>E;g=++E)O=R[g],O!==L[g]&&S.push(c(O));return S}(),deletions:function(){var E,C,S;for(S=[],g=E=0,C=L.length;C>E;g=++E)O=L[g],O!==R[g]&&S.push(c(O));return S}()}},n.prototype.getTextChangesFromCharacterData=function(){var i,p,g,d,A,w,k,D;return p=this.getMutationsByType("characterData"),p.length&&(D=p[0],g=p[p.length-1],A=c(D.oldValue),d=c(g.target.data),w=s(A,d),i=w.added,k=w.removed),{additions:i?[i]:[],deletions:k?[k]:[]}},h=function(i){var p,g,d,A;for(i==null&&(i=[]),A=[],p=0,g=i.length;g>p;p++)switch(d=i[p],d.nodeType){case Node.TEXT_NODE:A.push(d.data);break;case Node.ELEMENT_NODE:e(d)==="br"?A.push(`
`):A.push.apply(A,h(d.childNodes))}return A},n}(v.BasicObject)}).call(this),(function(){var x=function(y,c){function s(){this.constructor=y}for(var e in c)b.call(c,e)&&(y[e]=c[e]);return s.prototype=c.prototype,y.prototype=new s,y.__super__=c.prototype,y},b={}.hasOwnProperty;v.FileVerificationOperation=function(y){function c(s){this.file=s}return x(c,y),c.prototype.perform=function(s){var e;return e=new FileReader,e.onerror=function(){return s(!1)},e.onload=function(a){return function(){e.onerror=null;try{e.abort()}catch{}return s(!0,a.file)}}(this),e.readAsArrayBuffer(this.file)},c}(v.Operation)}).call(this),(function(){var x,b,y=function(s,e){function a(){this.constructor=s}for(var f in e)c.call(e,f)&&(s[f]=e[f]);return a.prototype=e.prototype,s.prototype=new a,s.__super__=e.prototype,s},c={}.hasOwnProperty;x=v.handleEvent,b=v.innerElementIsActive,v.InputController=function(s){function e(a){var f;this.element=a,this.mutationObserver=new v.MutationObserver(this.element),this.mutationObserver.delegate=this;for(f in this.events)x(f,{onElement:this.element,withCallback:this.handlerFor(f)})}return y(e,s),e.prototype.events={},e.prototype.elementDidMutate=function(){},e.prototype.editorWillSyncDocumentView=function(){return this.mutationObserver.stop()},e.prototype.editorDidSyncDocumentView=function(){return this.mutationObserver.start()},e.prototype.requestRender=function(){var a;return(a=this.delegate)!=null&&typeof a.inputControllerDidRequestRender=="function"?a.inputControllerDidRequestRender():void 0},e.prototype.requestReparse=function(){var a;return(a=this.delegate)!=null&&typeof a.inputControllerDidRequestReparse=="function"&&a.inputControllerDidRequestReparse(),this.requestRender()},e.prototype.attachFiles=function(a){var f,o;return o=function(){var r,l,n;for(n=[],r=0,l=a.length;l>r;r++)f=a[r],n.push(new v.FileVerificationOperation(f));return n}(),Promise.all(o).then(function(r){return function(l){return r.handleInput(function(){var n,h;return(n=this.delegate)!=null&&n.inputControllerWillAttachFiles(),(h=this.responder)!=null&&h.insertFiles(l),this.requestRender()})}}(this))},e.prototype.handlerFor=function(a){return function(f){return function(o){return o.defaultPrevented?void 0:f.handleInput(function(){return b(this.element)?void 0:(this.eventName=a,this.events[a].call(this,o))})}}(this)},e.prototype.handleInput=function(a){var f,o;try{return(f=this.delegate)!=null&&f.inputControllerWillHandleInput(),a.call(this)}finally{(o=this.delegate)!=null&&o.inputControllerDidHandleInput()}},e.prototype.createLinkHTML=function(a,f){var o;return o=document.createElement("a"),o.href=a,o.textContent=f??a,o.outerHTML},e}(v.BasicObject)}).call(this),(function(){var x,b,y,c,s,e,a,f,o,r,l,n,h=function(t,i){function p(){this.constructor=t}for(var g in i)u.call(i,g)&&(t[g]=i[g]);return p.prototype=i.prototype,t.prototype=new p,t.__super__=i.prototype,t},u={}.hasOwnProperty,m=[].indexOf||function(t){for(var i=0,p=this.length;p>i;i++)if(i in this&&this[i]===t)return i;return-1};o=v.makeElement,r=v.objectsAreEqual,v.tagName,b=v.browser,a=v.keyEventIsKeyboardCommand,c=v.dataTransferIsWritable,y=v.dataTransferIsPlainText,f=v.config.keyNames,v.Level0InputController=function(t){function i(){i.__super__.constructor.apply(this,arguments),this.resetInputSummary()}var p;return h(i,t),p=0,i.prototype.setInputSummary=function(g){var d,A;g==null&&(g={}),this.inputSummary.eventName=this.eventName;for(d in g)A=g[d],this.inputSummary[d]=A;return this.inputSummary},i.prototype.resetInputSummary=function(){return this.inputSummary={}},i.prototype.reset=function(){return this.resetInputSummary(),v.selectionChangeObserver.reset()},i.prototype.elementDidMutate=function(g){var d;return this.isComposing()?(d=this.delegate)!=null&&typeof d.inputControllerDidAllowUnhandledInput=="function"?d.inputControllerDidAllowUnhandledInput():void 0:this.handleInput(function(){return this.mutationIsSignificant(g)&&(this.mutationIsExpected(g)?this.requestRender():this.requestReparse()),this.reset()})},i.prototype.mutationIsExpected=function(g){var d,A,w,k,D,O,R,L,E,C;return R=g.textAdded,L=g.textDeleted,this.inputSummary.preferDocument?!0:(d=R!=null?R===this.inputSummary.textAdded:!this.inputSummary.textAdded,A=L!=null?this.inputSummary.didDelete:!this.inputSummary.didDelete,E=(R===`
`||R===` 
`)&&!d,C=L===`
`&&!A,O=E&&!C||C&&!E,O&&(k=this.getSelectedRange())&&(w=E?R.replace(/\n$/,"").length||-1:(R!=null?R.length:void 0)||1,(D=this.responder)!=null?D.positionIsBlockBreak(k[1]+w):void 0)?!0:d&&A)},i.prototype.mutationIsSignificant=function(g){var d,A,w;return w=Object.keys(g).length>0,d=((A=this.compositionInput)!=null?A.getEndData():void 0)==="",w||!d},i.prototype.events={keydown:function(g){var d,A,w,k,D,O,R,L,E;if(this.isComposing()||this.resetInputSummary(),this.inputSummary.didInput=!0,k=f[g.keyCode]){for(A=this.keys,L=["ctrl","alt","shift","meta"],w=0,O=L.length;O>w;w++)R=L[w],g[R+"Key"]&&(R==="ctrl"&&(R="control"),A=A!=null?A[R]:void 0);(A!=null?A[k]:void 0)!=null&&(this.setInputSummary({keyName:k}),v.selectionChangeObserver.reset(),A[k].call(this,g))}return a(g)&&(d=String.fromCharCode(g.keyCode).toLowerCase())&&(D=function(){var C,S,T,N;for(T=["alt","shift"],N=[],C=0,S=T.length;S>C;C++)R=T[C],g[R+"Key"]&&N.push(R);return N}(),D.push(d),(E=this.delegate)!=null?E.inputControllerDidReceiveKeyboardCommand(D):void 0)?g.preventDefault():void 0},keypress:function(g){var d,A,w;if(this.inputSummary.eventName==null&&!g.metaKey&&(!g.ctrlKey||g.altKey))return(w=n(g))?((d=this.delegate)!=null&&d.inputControllerWillPerformTyping(),(A=this.responder)!=null&&A.insertString(w),this.setInputSummary({textAdded:w,didDelete:this.selectionIsExpanded()})):void 0},textInput:function(g){var d,A,w,k;return d=g.data,k=this.inputSummary.textAdded,k&&k!==d&&k.toUpperCase()===d?(A=this.getSelectedRange(),this.setSelectedRange([A[0],A[1]+k.length]),(w=this.responder)!=null&&w.insertString(d),this.setInputSummary({textAdded:d}),this.setSelectedRange(A)):void 0},dragenter:function(g){return g.preventDefault()},dragstart:function(g){var d;return g.target,this.serializeSelectionToDataTransfer(g.dataTransfer),this.draggedRange=this.getSelectedRange(),(d=this.delegate)!=null&&typeof d.inputControllerDidStartDrag=="function"?d.inputControllerDidStartDrag():void 0},dragover:function(g){var d,A;return!this.draggedRange&&!this.canAcceptDataTransfer(g.dataTransfer)||(g.preventDefault(),d={x:g.clientX,y:g.clientY},r(d,this.draggingPoint))?void 0:(this.draggingPoint=d,(A=this.delegate)!=null&&typeof A.inputControllerDidReceiveDragOverPoint=="function"?A.inputControllerDidReceiveDragOverPoint(this.draggingPoint):void 0)},dragend:function(){var g;return(g=this.delegate)!=null&&typeof g.inputControllerDidCancelDrag=="function"&&g.inputControllerDidCancelDrag(),this.draggedRange=null,this.draggingPoint=null},drop:function(g){var d,A,w,k,D,O,R,L,E;return g.preventDefault(),w=(D=g.dataTransfer)!=null?D.files:void 0,k={x:g.clientX,y:g.clientY},(O=this.responder)!=null&&O.setLocationRangeFromPointRange(k),w!=null&&w.length?this.attachFiles(w):this.draggedRange?((R=this.delegate)!=null&&R.inputControllerWillMoveText(),(L=this.responder)!=null&&L.moveTextFromRange(this.draggedRange),this.draggedRange=null,this.requestRender()):(A=g.dataTransfer.getData("application/x-trix-document"))&&(d=v.Document.fromJSONString(A),(E=this.responder)!=null&&E.insertDocument(d),this.requestRender()),this.draggedRange=null,this.draggingPoint=null},cut:function(g){var d,A;return(d=this.responder)!=null&&d.selectionIsExpanded()&&(this.serializeSelectionToDataTransfer(g.clipboardData)&&g.preventDefault(),(A=this.delegate)!=null&&A.inputControllerWillCutText(),this.deleteInDirection("backward"),g.defaultPrevented)?this.requestRender():void 0},copy:function(g){var d;return(d=this.responder)!=null&&d.selectionIsExpanded()&&this.serializeSelectionToDataTransfer(g.clipboardData)?g.preventDefault():void 0},paste:function(g){var d,A,w,k,D,O,R,L,E,C,S,T,N,P,I,_,B,F,q,V,U,W,J;return d=(L=g.clipboardData)!=null?L:g.testClipboardData,R={clipboard:d},d==null||l(g)?void this.getPastedHTMLUsingHiddenElement(function(z){return function(X){var K,G,$;return R.type="text/html",R.html=X,(K=z.delegate)!=null&&K.inputControllerWillPaste(R),(G=z.responder)!=null&&G.insertHTML(R.html),z.requestRender(),($=z.delegate)!=null?$.inputControllerDidPaste(R):void 0}}(this)):((k=d.getData("URL"))?(R.type="text/html",J=(O=d.getData("public.url-name"))?v.squishBreakableWhitespace(O).trim():k,R.html=this.createLinkHTML(k,J),(E=this.delegate)!=null&&E.inputControllerWillPaste(R),this.setInputSummary({textAdded:J,didDelete:this.selectionIsExpanded()}),(I=this.responder)!=null&&I.insertHTML(R.html),this.requestRender(),(_=this.delegate)!=null&&_.inputControllerDidPaste(R)):y(d)?(R.type="text/plain",R.string=d.getData("text/plain"),(B=this.delegate)!=null&&B.inputControllerWillPaste(R),this.setInputSummary({textAdded:R.string,didDelete:this.selectionIsExpanded()}),(F=this.responder)!=null&&F.insertString(R.string),this.requestRender(),(q=this.delegate)!=null&&q.inputControllerDidPaste(R)):(D=d.getData("text/html"))?(R.type="text/html",R.html=D,(V=this.delegate)!=null&&V.inputControllerWillPaste(R),(U=this.responder)!=null&&U.insertHTML(R.html),this.requestRender(),(W=this.delegate)!=null&&W.inputControllerDidPaste(R)):m.call(d.types,"Files")>=0&&(w=(C=d.items)!=null&&(S=C[0])!=null&&typeof S.getAsFile=="function"?S.getAsFile():void 0)&&(!w.name&&(A=s(w))&&(w.name="pasted-file-"+ ++p+"."+A),R.type="File",R.file=w,(T=this.delegate)!=null&&T.inputControllerWillAttachFiles(),(N=this.responder)!=null&&N.insertFile(R.file),this.requestRender(),(P=this.delegate)!=null&&P.inputControllerDidPaste(R)),g.preventDefault())},compositionstart:function(g){return this.getCompositionInput().start(g.data)},compositionupdate:function(g){return this.getCompositionInput().update(g.data)},compositionend:function(g){return this.getCompositionInput().end(g.data)},beforeinput:function(){return this.inputSummary.didInput=!0},input:function(g){return this.inputSummary.didInput=!0,g.stopPropagation()}},i.prototype.keys={backspace:function(g){var d;return(d=this.delegate)!=null&&d.inputControllerWillPerformTyping(),this.deleteInDirection("backward",g)},delete:function(g){var d;return(d=this.delegate)!=null&&d.inputControllerWillPerformTyping(),this.deleteInDirection("forward",g)},return:function(){var g,d;return this.setInputSummary({preferDocument:!0}),(g=this.delegate)!=null&&g.inputControllerWillPerformTyping(),(d=this.responder)!=null?d.insertLineBreak():void 0},tab:function(g){var d,A;return(d=this.responder)!=null&&d.canIncreaseNestingLevel()?((A=this.responder)!=null&&A.increaseNestingLevel(),this.requestRender(),g.preventDefault()):void 0},left:function(g){var d;return this.selectionIsInCursorTarget()?(g.preventDefault(),(d=this.responder)!=null?d.moveCursorInDirection("backward"):void 0):void 0},right:function(g){var d;return this.selectionIsInCursorTarget()?(g.preventDefault(),(d=this.responder)!=null?d.moveCursorInDirection("forward"):void 0):void 0},control:{d:function(g){var d;return(d=this.delegate)!=null&&d.inputControllerWillPerformTyping(),this.deleteInDirection("forward",g)},h:function(g){var d;return(d=this.delegate)!=null&&d.inputControllerWillPerformTyping(),this.deleteInDirection("backward",g)},o:function(g){var d,A;return g.preventDefault(),(d=this.delegate)!=null&&d.inputControllerWillPerformTyping(),(A=this.responder)!=null&&A.insertString(`
`,{updatePosition:!1}),this.requestRender()}},shift:{return:function(g){var d,A;return(d=this.delegate)!=null&&d.inputControllerWillPerformTyping(),(A=this.responder)!=null&&A.insertString(`
`),this.requestRender(),g.preventDefault()},tab:function(g){var d,A;return(d=this.responder)!=null&&d.canDecreaseNestingLevel()?((A=this.responder)!=null&&A.decreaseNestingLevel(),this.requestRender(),g.preventDefault()):void 0},left:function(g){return this.selectionIsInCursorTarget()?(g.preventDefault(),this.expandSelectionInDirection("backward")):void 0},right:function(g){return this.selectionIsInCursorTarget()?(g.preventDefault(),this.expandSelectionInDirection("forward")):void 0}},alt:{backspace:function(){var g;return this.setInputSummary({preferDocument:!1}),(g=this.delegate)!=null?g.inputControllerWillPerformTyping():void 0}},meta:{backspace:function(){var g;return this.setInputSummary({preferDocument:!1}),(g=this.delegate)!=null?g.inputControllerWillPerformTyping():void 0}}},i.prototype.getCompositionInput=function(){return this.isComposing()?this.compositionInput:this.compositionInput=new x(this)},i.prototype.isComposing=function(){return this.compositionInput!=null&&!this.compositionInput.isEnded()},i.prototype.deleteInDirection=function(g,d){var A;return((A=this.responder)!=null?A.deleteInDirection(g):void 0)!==!1?this.setInputSummary({didDelete:!0}):d?(d.preventDefault(),this.requestRender()):void 0},i.prototype.serializeSelectionToDataTransfer=function(g){var d,A;if(c(g))return d=(A=this.responder)!=null?A.getSelectedDocument().toSerializableDocument():void 0,g.setData("application/x-trix-document",JSON.stringify(d)),g.setData("text/html",v.DocumentView.render(d).innerHTML),g.setData("text/plain",d.toString().replace(/\n$/,"")),!0},i.prototype.canAcceptDataTransfer=function(g){var d,A,w,k,D,O;for(O={},k=(w=g!=null?g.types:void 0)!=null?w:[],d=0,A=k.length;A>d;d++)D=k[d],O[D]=!0;return O.Files||O["application/x-trix-document"]||O["text/html"]||O["text/plain"]},i.prototype.getPastedHTMLUsingHiddenElement=function(g){var d,A,w;return A=this.getSelectedRange(),w={position:"absolute",left:window.pageXOffset+"px",top:window.pageYOffset+"px",opacity:0},d=o({style:w,tagName:"div",editable:!0}),document.body.appendChild(d),d.focus(),requestAnimationFrame(function(k){return function(){var D;return D=d.innerHTML,v.removeNode(d),k.setSelectedRange(A),g(D)}}(this))},i.proxyMethod("responder?.getSelectedRange"),i.proxyMethod("responder?.setSelectedRange"),i.proxyMethod("responder?.expandSelectionInDirection"),i.proxyMethod("responder?.selectionIsInCursorTarget"),i.proxyMethod("responder?.selectionIsExpanded"),i}(v.InputController),s=function(t){var i,p;return(i=t.type)!=null&&(p=i.match(/\/(\w+)$/))!=null?p[1]:void 0},e=(typeof" ".codePointAt=="function"?" ".codePointAt(0):void 0)!=null,n=function(t){var i;return t.key&&e&&t.key.codePointAt(0)===t.keyCode?t.key:(t.which===null?i=t.keyCode:t.which!==0&&t.charCode!==0&&(i=t.charCode),i!=null&&f[i]!=="escape"?v.UTF16String.fromCodepoints([i]).toString():void 0)},l=function(t){var i,p,g,d,A,w,k,D,O;if(k=t.clipboardData){if(m.call(k.types,"text/html")>=0){for(D=k.types,g=0,w=D.length;w>g;g++)if(O=D[g],i=/^CorePasteboardFlavorType/.test(O),p=/^dyn\./.test(O)&&k.getData(O),i||p)return!0;return!1}return d=m.call(k.types,"com.apple.webarchive")>=0,A=m.call(k.types,"com.apple.flat-rtfd")>=0,d||A}},x=function(t){function i(p){var g;this.inputController=p,g=this.inputController,this.responder=g.responder,this.delegate=g.delegate,this.inputSummary=g.inputSummary,this.data={}}return h(i,t),i.prototype.start=function(p){var g,d;return this.data.start=p,this.isSignificant()?(this.inputSummary.eventName==="keypress"&&this.inputSummary.textAdded&&(g=this.responder)!=null&&g.deleteInDirection("left"),this.selectionIsExpanded()||(this.insertPlaceholder(),this.requestRender()),this.range=(d=this.responder)!=null?d.getSelectedRange():void 0):void 0},i.prototype.update=function(p){var g;return this.data.update=p,this.isSignificant()&&(g=this.selectPlaceholder())?(this.forgetPlaceholder(),this.range=g):void 0},i.prototype.end=function(p){var g,d,A,w;return this.data.end=p,this.isSignificant()?(this.forgetPlaceholder(),this.canApplyToDocument()?(this.setInputSummary({preferDocument:!0,didInput:!1}),(g=this.delegate)!=null&&g.inputControllerWillPerformTyping(),(d=this.responder)!=null&&d.setSelectedRange(this.range),(A=this.responder)!=null&&A.insertString(this.data.end),(w=this.responder)!=null?w.setSelectedRange(this.range[0]+this.data.end.length):void 0):this.data.start!=null||this.data.update!=null?(this.requestReparse(),this.inputController.reset()):void 0):this.inputController.reset()},i.prototype.getEndData=function(){return this.data.end},i.prototype.isEnded=function(){return this.getEndData()!=null},i.prototype.isSignificant=function(){return b.composesExistingText?this.inputSummary.didInput:!0},i.prototype.canApplyToDocument=function(){var p,g;return((p=this.data.start)!=null?p.length:void 0)===0&&((g=this.data.end)!=null?g.length:void 0)>0&&this.range!=null},i.proxyMethod("inputController.setInputSummary"),i.proxyMethod("inputController.requestRender"),i.proxyMethod("inputController.requestReparse"),i.proxyMethod("responder?.selectionIsExpanded"),i.proxyMethod("responder?.insertPlaceholder"),i.proxyMethod("responder?.selectPlaceholder"),i.proxyMethod("responder?.forgetPlaceholder"),i}(v.BasicObject)}).call(this),(function(){var x,b,y,c=function(f,o){return function(){return f.apply(o,arguments)}},s=function(f,o){function r(){this.constructor=f}for(var l in o)e.call(o,l)&&(f[l]=o[l]);return r.prototype=o.prototype,f.prototype=new r,f.__super__=o.prototype,f},e={}.hasOwnProperty,a=[].indexOf||function(f){for(var o=0,r=this.length;r>o;o++)if(o in this&&this[o]===f)return o;return-1};x=v.dataTransferIsPlainText,b=v.keyEventIsKeyboardCommand,y=v.objectsAreEqual,v.Level2InputController=function(f){function o(){return this.render=c(this.render,this),o.__super__.constructor.apply(this,arguments)}var r,l,n,h,u,m;return s(o,f),o.prototype.elementDidMutate=function(){var t;return this.scheduledRender?this.composing&&(t=this.delegate)!=null&&typeof t.inputControllerDidAllowUnhandledInput=="function"?t.inputControllerDidAllowUnhandledInput():void 0:this.reparse()},o.prototype.scheduleRender=function(){return this.scheduledRender!=null?this.scheduledRender:this.scheduledRender=requestAnimationFrame(this.render)},o.prototype.render=function(){var t;return cancelAnimationFrame(this.scheduledRender),this.scheduledRender=null,this.composing||(t=this.delegate)!=null&&t.render(),typeof this.afterRender=="function"&&this.afterRender(),this.afterRender=null},o.prototype.reparse=function(){var t;return(t=this.delegate)!=null?t.reparse():void 0},o.prototype.events={keydown:function(t){var i,p,g,d;if(b(t)){if(i=l(t),(d=this.delegate)!=null?d.inputControllerDidReceiveKeyboardCommand(i):void 0)return t.preventDefault()}else if(g=t.key,t.altKey&&(g+="+Alt"),t.shiftKey&&(g+="+Shift"),p=this.keys[g])return this.withEvent(t,p)},paste:function(t){var i,p,g,d,A,w,k,D,O;return n(t)?(t.preventDefault(),this.attachFiles(t.clipboardData.files)):h(t)?(t.preventDefault(),p={type:"text/plain",string:t.clipboardData.getData("text/plain")},(g=this.delegate)!=null&&g.inputControllerWillPaste(p),(d=this.responder)!=null&&d.insertString(p.string),this.render(),(A=this.delegate)!=null?A.inputControllerDidPaste(p):void 0):(i=(w=t.clipboardData)!=null?w.getData("URL"):void 0)?(t.preventDefault(),p={type:"text/html",html:this.createLinkHTML(i)},(k=this.delegate)!=null&&k.inputControllerWillPaste(p),(D=this.responder)!=null&&D.insertHTML(p.html),this.render(),(O=this.delegate)!=null?O.inputControllerDidPaste(p):void 0):void 0},beforeinput:function(t){var i;return(i=this.inputTypes[t.inputType])?(this.withEvent(t,i),this.scheduleRender()):void 0},input:function(){return v.selectionChangeObserver.reset()},dragstart:function(t){var i,p;return(i=this.responder)!=null&&i.selectionContainsAttachments()?(t.dataTransfer.setData("application/x-trix-dragging",!0),this.dragging={range:(p=this.responder)!=null?p.getSelectedRange():void 0,point:u(t)}):void 0},dragenter:function(t){return r(t)?t.preventDefault():void 0},dragover:function(t){var i,p;if(this.dragging){if(t.preventDefault(),i=u(t),!y(i,this.dragging.point))return this.dragging.point=i,(p=this.responder)!=null?p.setLocationRangeFromPointRange(i):void 0}else if(r(t))return t.preventDefault()},drop:function(t){var i,p,g,d;return this.dragging?(t.preventDefault(),(p=this.delegate)!=null&&p.inputControllerWillMoveText(),(g=this.responder)!=null&&g.moveTextFromRange(this.dragging.range),this.dragging=null,this.scheduleRender()):r(t)?(t.preventDefault(),i=u(t),(d=this.responder)!=null&&d.setLocationRangeFromPointRange(i),this.attachFiles(t.dataTransfer.files)):void 0},dragend:function(){var t;return this.dragging?((t=this.responder)!=null&&t.setSelectedRange(this.dragging.range),this.dragging=null):void 0},compositionend:function(){return this.composing?(this.composing=!1,this.scheduleRender()):void 0}},o.prototype.keys={ArrowLeft:function(){var t,i;return(t=this.responder)!=null&&t.shouldManageMovingCursorInDirection("backward")?(this.event.preventDefault(),(i=this.responder)!=null?i.moveCursorInDirection("backward"):void 0):void 0},ArrowRight:function(){var t,i;return(t=this.responder)!=null&&t.shouldManageMovingCursorInDirection("forward")?(this.event.preventDefault(),(i=this.responder)!=null?i.moveCursorInDirection("forward"):void 0):void 0},Backspace:function(){var t,i,p;return(t=this.responder)!=null&&t.shouldManageDeletingInDirection("backward")?(this.event.preventDefault(),(i=this.delegate)!=null&&i.inputControllerWillPerformTyping(),(p=this.responder)!=null&&p.deleteInDirection("backward"),this.render()):void 0},Tab:function(){var t,i;return(t=this.responder)!=null&&t.canIncreaseNestingLevel()?(this.event.preventDefault(),(i=this.responder)!=null&&i.increaseNestingLevel(),this.render()):void 0},"Tab+Shift":function(){var t,i;return(t=this.responder)!=null&&t.canDecreaseNestingLevel()?(this.event.preventDefault(),(i=this.responder)!=null&&i.decreaseNestingLevel(),this.render()):void 0}},o.prototype.inputTypes={deleteByComposition:function(){return this.deleteInDirection("backward",{recordUndoEntry:!1})},deleteByCut:function(){return this.deleteInDirection("backward")},deleteByDrag:function(){return this.event.preventDefault(),this.withTargetDOMRange(function(){var t;return this.deleteByDragRange=(t=this.responder)!=null?t.getSelectedRange():void 0})},deleteCompositionText:function(){return this.deleteInDirection("backward",{recordUndoEntry:!1})},deleteContent:function(){return this.deleteInDirection("backward")},deleteContentBackward:function(){return this.deleteInDirection("backward")},deleteContentForward:function(){return this.deleteInDirection("forward")},deleteEntireSoftLine:function(){return this.deleteInDirection("forward")},deleteHardLineBackward:function(){return this.deleteInDirection("backward")},deleteHardLineForward:function(){return this.deleteInDirection("forward")},deleteSoftLineBackward:function(){return this.deleteInDirection("backward")},deleteSoftLineForward:function(){return this.deleteInDirection("forward")},deleteWordBackward:function(){return this.deleteInDirection("backward")},deleteWordForward:function(){return this.deleteInDirection("forward")},formatBackColor:function(){return this.activateAttributeIfSupported("backgroundColor",this.event.data)},formatBold:function(){return this.toggleAttributeIfSupported("bold")},formatFontColor:function(){return this.activateAttributeIfSupported("color",this.event.data)},formatFontName:function(){return this.activateAttributeIfSupported("font",this.event.data)},formatIndent:function(){var t;return(t=this.responder)!=null&&t.canIncreaseNestingLevel()?this.withTargetDOMRange(function(){var i;return(i=this.responder)!=null?i.increaseNestingLevel():void 0}):void 0},formatItalic:function(){return this.toggleAttributeIfSupported("italic")},formatJustifyCenter:function(){return this.toggleAttributeIfSupported("justifyCenter")},formatJustifyFull:function(){return this.toggleAttributeIfSupported("justifyFull")},formatJustifyLeft:function(){return this.toggleAttributeIfSupported("justifyLeft")},formatJustifyRight:function(){return this.toggleAttributeIfSupported("justifyRight")},formatOutdent:function(){var t;return(t=this.responder)!=null&&t.canDecreaseNestingLevel()?this.withTargetDOMRange(function(){var i;return(i=this.responder)!=null?i.decreaseNestingLevel():void 0}):void 0},formatRemove:function(){return this.withTargetDOMRange(function(){var t,i,p,g;g=[];for(t in(i=this.responder)!=null?i.getCurrentAttributes():void 0)g.push((p=this.responder)!=null?p.removeCurrentAttribute(t):void 0);return g})},formatSetBlockTextDirection:function(){return this.activateAttributeIfSupported("blockDir",this.event.data)},formatSetInlineTextDirection:function(){return this.activateAttributeIfSupported("textDir",this.event.data)},formatStrikeThrough:function(){return this.toggleAttributeIfSupported("strike")},formatSubscript:function(){return this.toggleAttributeIfSupported("sub")},formatSuperscript:function(){return this.toggleAttributeIfSupported("sup")},formatUnderline:function(){return this.toggleAttributeIfSupported("underline")},historyRedo:function(){var t;return(t=this.delegate)!=null?t.inputControllerWillPerformRedo():void 0},historyUndo:function(){var t;return(t=this.delegate)!=null?t.inputControllerWillPerformUndo():void 0},insertCompositionText:function(){return this.composing=!0,this.insertString(this.event.data)},insertFromComposition:function(){return this.composing=!1,this.insertString(this.event.data)},insertFromDrop:function(){var t,i;return(t=this.deleteByDragRange)?(this.deleteByDragRange=null,(i=this.delegate)!=null&&i.inputControllerWillMoveText(),this.withTargetDOMRange(function(){var p;return(p=this.responder)!=null?p.moveTextFromRange(t):void 0})):void 0},insertFromPaste:function(){var t,i,p,g,d,A,w,k,D,O,R;return t=this.event.dataTransfer,d={dataTransfer:t},(i=t.getData("URL"))?(this.event.preventDefault(),d.type="text/html",R=(g=t.getData("public.url-name"))?v.squishBreakableWhitespace(g).trim():i,d.html=this.createLinkHTML(i,R),(A=this.delegate)!=null&&A.inputControllerWillPaste(d),this.withTargetDOMRange(function(){var L;return(L=this.responder)!=null?L.insertHTML(d.html):void 0}),this.afterRender=function(L){return function(){var E;return(E=L.delegate)!=null?E.inputControllerDidPaste(d):void 0}}(this)):x(t)?(d.type="text/plain",d.string=t.getData("text/plain"),(w=this.delegate)!=null&&w.inputControllerWillPaste(d),this.withTargetDOMRange(function(){var L;return(L=this.responder)!=null?L.insertString(d.string):void 0}),this.afterRender=function(L){return function(){var E;return(E=L.delegate)!=null?E.inputControllerDidPaste(d):void 0}}(this)):(p=t.getData("text/html"))?(this.event.preventDefault(),d.type="text/html",d.html=p,(k=this.delegate)!=null&&k.inputControllerWillPaste(d),this.withTargetDOMRange(function(){var L;return(L=this.responder)!=null?L.insertHTML(d.html):void 0}),this.afterRender=function(L){return function(){var E;return(E=L.delegate)!=null?E.inputControllerDidPaste(d):void 0}}(this)):(D=t.files)!=null&&D.length?(d.type="File",d.file=t.files[0],(O=this.delegate)!=null&&O.inputControllerWillPaste(d),this.withTargetDOMRange(function(){var L;return(L=this.responder)!=null?L.insertFile(d.file):void 0}),this.afterRender=function(L){return function(){var E;return(E=L.delegate)!=null?E.inputControllerDidPaste(d):void 0}}(this)):void 0},insertFromYank:function(){return this.insertString(this.event.data)},insertLineBreak:function(){return this.insertString(`
`)},insertLink:function(){return this.activateAttributeIfSupported("href",this.event.data)},insertOrderedList:function(){return this.toggleAttributeIfSupported("number")},insertParagraph:function(){var t;return(t=this.delegate)!=null&&t.inputControllerWillPerformTyping(),this.withTargetDOMRange(function(){var i;return(i=this.responder)!=null?i.insertLineBreak():void 0})},insertReplacementText:function(){return this.insertString(this.event.dataTransfer.getData("text/plain"),{updatePosition:!1})},insertText:function(){var t,i;return this.insertString((t=this.event.data)!=null?t:(i=this.event.dataTransfer)!=null?i.getData("text/plain"):void 0)},insertTranspose:function(){return this.insertString(this.event.data)},insertUnorderedList:function(){return this.toggleAttributeIfSupported("bullet")}},o.prototype.insertString=function(t,i){var p;return t==null&&(t=""),(p=this.delegate)!=null&&p.inputControllerWillPerformTyping(),this.withTargetDOMRange(function(){var g;return(g=this.responder)!=null?g.insertString(t,i):void 0})},o.prototype.toggleAttributeIfSupported=function(t){var i;return a.call(v.getAllAttributeNames(),t)>=0?((i=this.delegate)!=null&&i.inputControllerWillPerformFormatting(t),this.withTargetDOMRange(function(){var p;return(p=this.responder)!=null?p.toggleCurrentAttribute(t):void 0})):void 0},o.prototype.activateAttributeIfSupported=function(t,i){var p;return a.call(v.getAllAttributeNames(),t)>=0?((p=this.delegate)!=null&&p.inputControllerWillPerformFormatting(t),this.withTargetDOMRange(function(){var g;return(g=this.responder)!=null?g.setCurrentAttribute(t,i):void 0})):void 0},o.prototype.deleteInDirection=function(t,i){var p,g,d,A;return d=(i??{recordUndoEntry:!0}).recordUndoEntry,d&&(A=this.delegate)!=null&&A.inputControllerWillPerformTyping(),g=function(w){return function(){var k;return(k=w.responder)!=null?k.deleteInDirection(t):void 0}}(this),(p=this.getTargetDOMRange({minLength:2}))?this.withTargetDOMRange(p,g):g()},o.prototype.withTargetDOMRange=function(t,i){var p;return typeof t=="function"&&(i=t,t=this.getTargetDOMRange()),t?(p=this.responder)!=null?p.withTargetDOMRange(t,i.bind(this)):void 0:(v.selectionChangeObserver.reset(),i.call(this))},o.prototype.getTargetDOMRange=function(t){var i,p,g,d;return g=(t??{minLength:0}).minLength,(d=typeof(i=this.event).getTargetRanges=="function"?i.getTargetRanges():void 0)&&d.length&&(p=m(d[0]),g===0||p.toString().length>=g)?p:void 0},m=function(t){var i;return i=document.createRange(),i.setStart(t.startContainer,t.startOffset),i.setEnd(t.endContainer,t.endOffset),i},o.prototype.withEvent=function(t,i){var p;this.event=t;try{p=i.call(this)}finally{this.event=null}return p},r=function(t){var i,p;return a.call((i=(p=t.dataTransfer)!=null?p.types:void 0)!=null?i:[],"Files")>=0},n=function(t){var i;return(i=t.clipboardData)?a.call(i.types,"Files")>=0&&i.types.length===1&&i.files.length>=1:void 0},h=function(t){var i;return(i=t.clipboardData)?a.call(i.types,"text/plain")>=0&&i.types.length===1:void 0},l=function(t){var i;return i=[],t.altKey&&i.push("alt"),t.shiftKey&&i.push("shift"),i.push(t.key),i},u=function(t){return{x:t.clientX,y:t.clientY}},o}(v.InputController)}).call(this),(function(){var x,b,y,c,s,e,a,f,o=function(n,h){return function(){return n.apply(h,arguments)}},r=function(n,h){function u(){this.constructor=n}for(var m in h)l.call(h,m)&&(n[m]=h[m]);return u.prototype=h.prototype,n.prototype=new u,n.__super__=h.prototype,n},l={}.hasOwnProperty;b=v.defer,y=v.handleEvent,e=v.makeElement,f=v.tagName,a=v.config,s=a.lang,x=a.css,c=a.keyNames,v.AttachmentEditorController=function(n){function h(m,t,i,p){this.attachmentPiece=m,this.element=t,this.container=i,this.options=p??{},this.didBlurCaption=o(this.didBlurCaption,this),this.didChangeCaption=o(this.didChangeCaption,this),this.didInputCaption=o(this.didInputCaption,this),this.didKeyDownCaption=o(this.didKeyDownCaption,this),this.didClickActionButton=o(this.didClickActionButton,this),this.didClickToolbar=o(this.didClickToolbar,this),this.attachment=this.attachmentPiece.attachment,f(this.element)==="a"&&(this.element=this.element.firstChild),this.install()}var u;return r(h,n),u=function(m){return function(){var t;return t=m.apply(this,arguments),t.do(),this.undos==null&&(this.undos=[]),this.undos.push(t.undo)}},h.prototype.install=function(){return this.makeElementMutable(),this.addToolbar(),this.attachment.isPreviewable()?this.installCaptionEditor():void 0},h.prototype.uninstall=function(){var m,t;for(this.savePendingCaption();t=this.undos.pop();)t();return(m=this.delegate)!=null?m.didUninstallAttachmentEditor(this):void 0},h.prototype.savePendingCaption=function(){var m,t,i;return this.pendingCaption!=null?(m=this.pendingCaption,this.pendingCaption=null,m?(t=this.delegate)!=null&&typeof t.attachmentEditorDidRequestUpdatingAttributesForAttachment=="function"?t.attachmentEditorDidRequestUpdatingAttributesForAttachment({caption:m},this.attachment):void 0:(i=this.delegate)!=null&&typeof i.attachmentEditorDidRequestRemovingAttributeForAttachment=="function"?i.attachmentEditorDidRequestRemovingAttributeForAttachment("caption",this.attachment):void 0):void 0},h.prototype.makeElementMutable=u(function(){return{do:function(m){return function(){return m.element.dataset.trixMutable=!0}}(this),undo:function(m){return function(){return delete m.element.dataset.trixMutable}}(this)}}),h.prototype.addToolbar=u(function(){var m;return m=e({tagName:"div",className:x.attachmentToolbar,data:{trixMutable:!0},childNodes:e({tagName:"div",className:"trix-button-row",childNodes:e({tagName:"span",className:"trix-button-group trix-button-group--actions",childNodes:e({tagName:"button",className:"trix-button trix-button--remove",textContent:s.remove,attributes:{title:s.remove},data:{trixAction:"remove"}})})})}),this.attachment.isPreviewable()&&m.appendChild(e({tagName:"div",className:x.attachmentMetadataContainer,childNodes:e({tagName:"span",className:x.attachmentMetadata,childNodes:[e({tagName:"span",className:x.attachmentName,textContent:this.attachment.getFilename(),attributes:{title:this.attachment.getFilename()}}),e({tagName:"span",className:x.attachmentSize,textContent:this.attachment.getFormattedFilesize()})]})})),y("click",{onElement:m,withCallback:this.didClickToolbar}),y("click",{onElement:m,matchingSelector:"[data-trix-action]",withCallback:this.didClickActionButton}),{do:function(t){return function(){return t.element.appendChild(m)}}(this),undo:function(){return function(){return v.removeNode(m)}}()}}),h.prototype.installCaptionEditor=u(function(){var m,t,i,p,g;return p=e({tagName:"textarea",className:x.attachmentCaptionEditor,attributes:{placeholder:s.captionPlaceholder},data:{trixMutable:!0}}),p.value=this.attachmentPiece.getCaption(),g=p.cloneNode(),g.classList.add("trix-autoresize-clone"),g.tabIndex=-1,m=function(){return g.value=p.value,p.style.height=g.scrollHeight+"px"},y("input",{onElement:p,withCallback:m}),y("input",{onElement:p,withCallback:this.didInputCaption}),y("keydown",{onElement:p,withCallback:this.didKeyDownCaption}),y("change",{onElement:p,withCallback:this.didChangeCaption}),y("blur",{onElement:p,withCallback:this.didBlurCaption}),i=this.element.querySelector("figcaption"),t=i.cloneNode(),{do:function(d){return function(){return i.style.display="none",t.appendChild(p),t.appendChild(g),t.classList.add(x.attachmentCaption+"--editing"),i.parentElement.insertBefore(t,i),m(),d.options.editCaption?b(function(){return p.focus()}):void 0}}(this),undo:function(){return v.removeNode(t),i.style.display=null}}}),h.prototype.didClickToolbar=function(m){return m.preventDefault(),m.stopPropagation()},h.prototype.didClickActionButton=function(m){var t;switch(m.target.getAttribute("data-trix-action")){case"remove":return(t=this.delegate)!=null?t.attachmentEditorDidRequestRemovalOfAttachment(this.attachment):void 0}},h.prototype.didKeyDownCaption=function(m){var t;return c[m.keyCode]==="return"?(m.preventDefault(),this.savePendingCaption(),(t=this.delegate)!=null&&typeof t.attachmentEditorDidRequestDeselectingAttachment=="function"?t.attachmentEditorDidRequestDeselectingAttachment(this.attachment):void 0):void 0},h.prototype.didInputCaption=function(m){return this.pendingCaption=m.target.value.replace(/\s/g," ").trim()},h.prototype.didChangeCaption=function(){return this.savePendingCaption()},h.prototype.didBlurCaption=function(){return this.savePendingCaption()},h}(v.BasicObject)}).call(this),(function(){var x,b,y,c=function(e,a){function f(){this.constructor=e}for(var o in a)s.call(a,o)&&(e[o]=a[o]);return f.prototype=a.prototype,e.prototype=new f,e.__super__=a.prototype,e},s={}.hasOwnProperty;y=v.makeElement,x=v.config.css,v.AttachmentView=function(e){function a(){a.__super__.constructor.apply(this,arguments),this.attachment=this.object,this.attachment.uploadProgressDelegate=this,this.attachmentPiece=this.options.piece}var f;return c(a,e),a.attachmentSelector="[data-trix-attachment]",a.prototype.createContentNodes=function(){return[]},a.prototype.createNodes=function(){var o,r,l,n,h,u,m;if(o=n=y({tagName:"figure",className:this.getClassName(),data:this.getData(),editable:!1}),(r=this.getHref())&&(n=y({tagName:"a",editable:!1,attributes:{href:r,tabindex:-1}}),o.appendChild(n)),this.attachment.hasContent())n.innerHTML=this.attachment.getContent();else for(m=this.createContentNodes(),l=0,h=m.length;h>l;l++)u=m[l],n.appendChild(u);return n.appendChild(this.createCaptionElement()),this.attachment.isPending()&&(this.progressElement=y({tagName:"progress",attributes:{class:x.attachmentProgress,value:this.attachment.getUploadProgress(),max:100},data:{trixMutable:!0,trixStoreKey:["progressElement",this.attachment.id].join("/")}}),o.appendChild(this.progressElement)),[f("left"),o,f("right")]},a.prototype.createCaptionElement=function(){var o,r,l,n,h,u,m;return l=y({tagName:"figcaption",className:x.attachmentCaption}),(o=this.attachmentPiece.getCaption())?(l.classList.add(x.attachmentCaption+"--edited"),l.textContent=o):(r=this.getCaptionConfig(),r.name&&(n=this.attachment.getFilename()),r.size&&(u=this.attachment.getFormattedFilesize()),n&&(h=y({tagName:"span",className:x.attachmentName,textContent:n}),l.appendChild(h)),u&&(n&&l.appendChild(document.createTextNode(" ")),m=y({tagName:"span",className:x.attachmentSize,textContent:u}),l.appendChild(m))),l},a.prototype.getClassName=function(){var o,r;return r=[x.attachment,x.attachment+"--"+this.attachment.getType()],(o=this.attachment.getExtension())&&r.push(x.attachment+"--"+o),r.join(" ")},a.prototype.getData=function(){var o,r;return r={trixAttachment:JSON.stringify(this.attachment),trixContentType:this.attachment.getContentType(),trixId:this.attachment.id},o=this.attachmentPiece.attributes,o.isEmpty()||(r.trixAttributes=JSON.stringify(o)),this.attachment.isPending()&&(r.trixSerialize=!1),r},a.prototype.getHref=function(){return b(this.attachment.getContent(),"a")?void 0:this.attachment.getHref()},a.prototype.getCaptionConfig=function(){var o,r,l;return l=this.attachment.getType(),o=v.copyObject((r=v.config.attachments[l])!=null?r.caption:void 0),l==="file"&&(o.name=!0),o},a.prototype.findProgressElement=function(){var o;return(o=this.findElement())!=null?o.querySelector("progress"):void 0},f=function(o){return y({tagName:"span",textContent:v.ZERO_WIDTH_SPACE,data:{trixCursorTarget:o,trixSerialize:!1}})},a.prototype.attachmentDidChangeUploadProgress=function(){var o,r;return r=this.attachment.getUploadProgress(),(o=this.findProgressElement())!=null?o.value=r:void 0},a}(v.ObjectView),b=function(e,a){var f;return f=y("div"),f.innerHTML=e??"",f.querySelector(a)}}).call(this),(function(){var x,b=function(c,s){function e(){this.constructor=c}for(var a in s)y.call(s,a)&&(c[a]=s[a]);return e.prototype=s.prototype,c.prototype=new e,c.__super__=s.prototype,c},y={}.hasOwnProperty;x=v.makeElement,v.PreviewableAttachmentView=function(c){function s(){s.__super__.constructor.apply(this,arguments),this.attachment.previewDelegate=this}return b(s,c),s.prototype.createContentNodes=function(){return this.image=x({tagName:"img",attributes:{src:""},data:{trixMutable:!0}}),this.refresh(this.image),[this.image]},s.prototype.createCaptionElement=function(){var e;return e=s.__super__.createCaptionElement.apply(this,arguments),e.textContent||e.setAttribute("data-trix-placeholder",v.config.lang.captionPlaceholder),e},s.prototype.refresh=function(e){var a;return e==null&&(e=(a=this.findElement())!=null?a.querySelector("img"):void 0),e?this.updateAttributesForImage(e):void 0},s.prototype.updateAttributesForImage=function(e){var a,f,o,r,l,n;return l=this.attachment.getURL(),f=this.attachment.getPreviewURL(),e.src=f||l,f===l?e.removeAttribute("data-trix-serialized-attributes"):(o=JSON.stringify({src:l}),e.setAttribute("data-trix-serialized-attributes",o)),n=this.attachment.getWidth(),a=this.attachment.getHeight(),n!=null&&(e.width=n),a!=null&&(e.height=a),r=["imageElement",this.attachment.id,e.src,e.width,e.height].join("/"),e.dataset.trixStoreKey=r},s.prototype.attachmentDidChangeAttributes=function(){return this.refresh(this.image),this.refresh()},s}(v.AttachmentView)}).call(this),(function(){var x,b,y,c=function(e,a){function f(){this.constructor=e}for(var o in a)s.call(a,o)&&(e[o]=a[o]);return f.prototype=a.prototype,e.prototype=new f,e.__super__=a.prototype,e},s={}.hasOwnProperty;y=v.makeElement,x=v.findInnerElement,b=v.getTextConfig,v.PieceView=function(e){function a(){var o;a.__super__.constructor.apply(this,arguments),this.piece=this.object,this.attributes=this.piece.getAttributes(),o=this.options,this.textConfig=o.textConfig,this.context=o.context,this.piece.attachment?this.attachment=this.piece.attachment:this.string=this.piece.toString()}var f;return c(a,e),a.prototype.createNodes=function(){var o,r,l,n,h,u;if(u=this.attachment?this.createAttachmentNodes():this.createStringNodes(),o=this.createElement()){for(l=x(o),r=0,n=u.length;n>r;r++)h=u[r],l.appendChild(h);u=[o]}return u},a.prototype.createAttachmentNodes=function(){var o,r;return o=this.attachment.isPreviewable()?v.PreviewableAttachmentView:v.AttachmentView,r=this.createChildView(o,this.piece.attachment,{piece:this.piece}),r.getNodes()},a.prototype.createStringNodes=function(){var o,r,l,n,h,u,m,t,i;if((m=this.textConfig)!=null&&m.plaintext)return[document.createTextNode(this.string)];for(u=[],t=this.string.split(`
`),l=r=0,n=t.length;n>r;l=++r)i=t[l],l>0&&(o=y("br"),u.push(o)),i.length&&(h=document.createTextNode(this.preserveSpaces(i)),u.push(h));return u},a.prototype.createElement=function(){var o,r,l,n,h,u,m,t,i;t={},u=this.attributes;for(n in u)if(i=u[n],(o=b(n))&&(o.tagName&&(h=y(o.tagName),l?(l.appendChild(h),l=h):r=l=h),o.styleProperty&&(t[o.styleProperty]=i),o.style)){m=o.style;for(n in m)i=m[n],t[n]=i}if(Object.keys(t).length){r==null&&(r=y("span"));for(n in t)i=t[n],r.style[n]=i}return r},a.prototype.createContainerElement=function(){var o,r,l,n,h;n=this.attributes;for(l in n)if(h=n[l],(r=b(l))&&r.groupTagName)return o={},o[l]=h,y(r.groupTagName,o)},f=v.NON_BREAKING_SPACE,a.prototype.preserveSpaces=function(o){return this.context.isLast&&(o=o.replace(/\ $/,f)),o=o.replace(/(\S)\ {3}(\S)/g,"$1 "+f+" $2").replace(/\ {2}/g,f+" ").replace(/\ {2}/g," "+f),(this.context.isFirst||this.context.followsWhitespace)&&(o=o.replace(/^\ /,f)),o},a}(v.ObjectView)}).call(this),(function(){var x=function(y,c){function s(){this.constructor=y}for(var e in c)b.call(c,e)&&(y[e]=c[e]);return s.prototype=c.prototype,y.prototype=new s,y.__super__=c.prototype,y},b={}.hasOwnProperty;v.TextView=function(y){function c(){c.__super__.constructor.apply(this,arguments),this.text=this.object,this.textConfig=this.options.textConfig}var s;return x(c,y),c.prototype.createNodes=function(){var e,a,f,o,r,l,n,h,u,m;for(l=[],h=v.ObjectGroup.groupObjects(this.getPieces()),o=h.length-1,f=a=0,r=h.length;r>a;f=++a)n=h[f],e={},f===0&&(e.isFirst=!0),f===o&&(e.isLast=!0),s(u)&&(e.followsWhitespace=!0),m=this.findOrCreateCachedChildView(v.PieceView,n,{textConfig:this.textConfig,context:e}),l.push.apply(l,m.getNodes()),u=n;return l},c.prototype.getPieces=function(){var e,a,f,o,r;for(o=this.text.getPieces(),r=[],e=0,a=o.length;a>e;e++)f=o[e],f.hasAttribute("blockBreak")||r.push(f);return r},s=function(e){return/\s$/.test(e!=null?e.toString():void 0)},c}(v.ObjectView)}).call(this),(function(){var x,b,y,c=function(e,a){function f(){this.constructor=e}for(var o in a)s.call(a,o)&&(e[o]=a[o]);return f.prototype=a.prototype,e.prototype=new f,e.__super__=a.prototype,e},s={}.hasOwnProperty;y=v.makeElement,b=v.getBlockConfig,x=v.config.css,v.BlockView=function(e){function a(){a.__super__.constructor.apply(this,arguments),this.block=this.object,this.attributes=this.block.getAttributes()}return c(a,e),a.prototype.createNodes=function(){var f,o,r,l,n,h,u,m,t,i,p;if(o=document.createComment("block"),u=[o],this.block.isEmpty()?u.push(y("br")):(i=(m=b(this.block.getLastAttribute()))!=null?m.text:void 0,p=this.findOrCreateCachedChildView(v.TextView,this.block.text,{textConfig:i}),u.push.apply(u,p.getNodes()),this.shouldAddExtraNewlineElement()&&u.push(y("br"))),this.attributes.length)return u;for(t=v.config.blockAttributes.default.tagName,this.block.isRTL()&&(f={dir:"rtl"}),r=y({tagName:t,attributes:f}),l=0,n=u.length;n>l;l++)h=u[l],r.appendChild(h);return[r]},a.prototype.createContainerElement=function(f){var o,r,l,n,h;return o=this.attributes[f],h=b(o).tagName,f===0&&this.block.isRTL()&&(r={dir:"rtl"}),o==="attachmentGallery"&&(n=this.block.getBlockBreakPosition(),l=x.attachmentGallery+" "+x.attachmentGallery+"--"+n),y({tagName:h,className:l,attributes:r})},a.prototype.shouldAddExtraNewlineElement=function(){return/\n\n$/.test(this.block.toString())},a}(v.ObjectView)}).call(this),(function(){var x,b,y=function(s,e){function a(){this.constructor=s}for(var f in e)c.call(e,f)&&(s[f]=e[f]);return a.prototype=e.prototype,s.prototype=new a,s.__super__=e.prototype,s},c={}.hasOwnProperty;x=v.defer,b=v.makeElement,v.DocumentView=function(s){function e(){e.__super__.constructor.apply(this,arguments),this.element=this.options.element,this.elementStore=new v.ElementStore,this.setDocument(this.object)}var a,f,o;return y(e,s),e.render=function(r){var l,n;return l=b("div"),n=new this(r,{element:l}),n.render(),n.sync(),l},e.prototype.setDocument=function(r){return r.isEqualTo(this.document)?void 0:this.document=this.object=r},e.prototype.render=function(){var r,l,n,h,u,m,t;if(this.childViews=[],this.shadowElement=b("div"),!this.document.isEmpty()){for(u=v.ObjectGroup.groupObjects(this.document.getBlocks(),{asTree:!0}),m=[],r=0,l=u.length;l>r;r++)h=u[r],t=this.findOrCreateCachedChildView(v.BlockView,h),m.push((function(){var i,p,g,d;for(g=t.getNodes(),d=[],i=0,p=g.length;p>i;i++)n=g[i],d.push(this.shadowElement.appendChild(n));return d}).call(this));return m}},e.prototype.isSynced=function(){return a(this.shadowElement,this.element)},e.prototype.sync=function(){var r;for(r=this.createDocumentFragmentForSync();this.element.lastChild;)this.element.removeChild(this.element.lastChild);return this.element.appendChild(r),this.didSync()},e.prototype.didSync=function(){return this.elementStore.reset(f(this.element)),x(function(r){return function(){return r.garbageCollectCachedViews()}}(this))},e.prototype.createDocumentFragmentForSync=function(){var r,l,n,h,u,m,t,i,p,g;for(l=document.createDocumentFragment(),i=this.shadowElement.childNodes,n=0,u=i.length;u>n;n++)t=i[n],l.appendChild(t.cloneNode(!0));for(p=f(l),h=0,m=p.length;m>h;h++)r=p[h],(g=this.elementStore.remove(r))&&r.parentNode.replaceChild(g,r);return l},f=function(r){return r.querySelectorAll("[data-trix-store-key]")},a=function(r,l){return o(r.innerHTML)===o(l.innerHTML)},o=function(r){return r.replace(/&nbsp;/g," ")},e}(v.ObjectView)}).call(this),(function(){var x,b,y,c,s,e=function(o,r){return function(){return o.apply(r,arguments)}},a=function(o,r){function l(){this.constructor=o}for(var n in r)f.call(r,n)&&(o[n]=r[n]);return l.prototype=r.prototype,o.prototype=new l,o.__super__=r.prototype,o},f={}.hasOwnProperty;y=v.findClosestElementFromNode,c=v.handleEvent,s=v.innerElementIsActive,b=v.defer,x=v.AttachmentView.attachmentSelector,v.CompositionController=function(o){function r(l,n){this.element=l,this.composition=n,this.didClickAttachment=e(this.didClickAttachment,this),this.didBlur=e(this.didBlur,this),this.didFocus=e(this.didFocus,this),this.documentView=new v.DocumentView(this.composition.document,{element:this.element}),c("focus",{onElement:this.element,withCallback:this.didFocus}),c("blur",{onElement:this.element,withCallback:this.didBlur}),c("click",{onElement:this.element,matchingSelector:"a[contenteditable=false]",preventDefault:!0}),c("mousedown",{onElement:this.element,matchingSelector:x,withCallback:this.didClickAttachment}),c("click",{onElement:this.element,matchingSelector:"a"+x,preventDefault:!0})}return a(r,o),r.prototype.didFocus=function(){var l,n,h;return l=function(u){return function(){var m;return u.focused?void 0:(u.focused=!0,(m=u.delegate)!=null&&typeof m.compositionControllerDidFocus=="function"?m.compositionControllerDidFocus():void 0)}}(this),(n=(h=this.blurPromise)!=null?h.then(l):void 0)!=null?n:l()},r.prototype.didBlur=function(){return this.blurPromise=new Promise(function(l){return function(n){return b(function(){var h;return s(l.element)||(l.focused=null,(h=l.delegate)!=null&&typeof h.compositionControllerDidBlur=="function"&&h.compositionControllerDidBlur()),l.blurPromise=null,n()})}}(this))},r.prototype.didClickAttachment=function(l,n){var h,u,m;return h=this.findAttachmentForElement(n),u=y(l.target,{matchingSelector:"figcaption"})!=null,(m=this.delegate)!=null&&typeof m.compositionControllerDidSelectAttachment=="function"?m.compositionControllerDidSelectAttachment(h,{editCaption:u}):void 0},r.prototype.getSerializableElement=function(){return this.isEditingAttachment()?this.documentView.shadowElement:this.element},r.prototype.render=function(){var l,n,h;return this.revision!==this.composition.revision&&(this.documentView.setDocument(this.composition.document),this.documentView.render(),this.revision=this.composition.revision),this.canSyncDocumentView()&&!this.documentView.isSynced()&&((l=this.delegate)!=null&&typeof l.compositionControllerWillSyncDocumentView=="function"&&l.compositionControllerWillSyncDocumentView(),this.documentView.sync(),(n=this.delegate)!=null&&typeof n.compositionControllerDidSyncDocumentView=="function"&&n.compositionControllerDidSyncDocumentView()),(h=this.delegate)!=null&&typeof h.compositionControllerDidRender=="function"?h.compositionControllerDidRender():void 0},r.prototype.rerenderViewForObject=function(l){return this.invalidateViewForObject(l),this.render()},r.prototype.invalidateViewForObject=function(l){return this.documentView.invalidateViewForObject(l)},r.prototype.isViewCachingEnabled=function(){return this.documentView.isViewCachingEnabled()},r.prototype.enableViewCaching=function(){return this.documentView.enableViewCaching()},r.prototype.disableViewCaching=function(){return this.documentView.disableViewCaching()},r.prototype.refreshViewCache=function(){return this.documentView.garbageCollectCachedViews()},r.prototype.isEditingAttachment=function(){return this.attachmentEditor!=null},r.prototype.installAttachmentEditorForAttachment=function(l,n){var h,u,m;if(((m=this.attachmentEditor)!=null?m.attachment:void 0)!==l&&(u=this.documentView.findElementForObject(l)))return this.uninstallAttachmentEditor(),h=this.composition.document.getAttachmentPieceForAttachment(l),this.attachmentEditor=new v.AttachmentEditorController(h,u,this.element,n),this.attachmentEditor.delegate=this},r.prototype.uninstallAttachmentEditor=function(){var l;return(l=this.attachmentEditor)!=null?l.uninstall():void 0},r.prototype.didUninstallAttachmentEditor=function(){return this.attachmentEditor=null,this.render()},r.prototype.attachmentEditorDidRequestUpdatingAttributesForAttachment=function(l,n){var h;return(h=this.delegate)!=null&&typeof h.compositionControllerWillUpdateAttachment=="function"&&h.compositionControllerWillUpdateAttachment(n),this.composition.updateAttributesForAttachment(l,n)},r.prototype.attachmentEditorDidRequestRemovingAttributeForAttachment=function(l,n){var h;return(h=this.delegate)!=null&&typeof h.compositionControllerWillUpdateAttachment=="function"&&h.compositionControllerWillUpdateAttachment(n),this.composition.removeAttributeForAttachment(l,n)},r.prototype.attachmentEditorDidRequestRemovalOfAttachment=function(l){var n;return(n=this.delegate)!=null&&typeof n.compositionControllerDidRequestRemovalOfAttachment=="function"?n.compositionControllerDidRequestRemovalOfAttachment(l):void 0},r.prototype.attachmentEditorDidRequestDeselectingAttachment=function(l){var n;return(n=this.delegate)!=null&&typeof n.compositionControllerDidRequestDeselectingAttachment=="function"?n.compositionControllerDidRequestDeselectingAttachment(l):void 0},r.prototype.canSyncDocumentView=function(){return!this.isEditingAttachment()},r.prototype.findAttachmentForElement=function(l){return this.composition.document.getAttachmentById(parseInt(l.dataset.trixId,10))},r}(v.BasicObject)}).call(this),(function(){var x,b,y,c=function(a,f){return function(){return a.apply(f,arguments)}},s=function(a,f){function o(){this.constructor=a}for(var r in f)e.call(f,r)&&(a[r]=f[r]);return o.prototype=f.prototype,a.prototype=new o,a.__super__=f.prototype,a},e={}.hasOwnProperty;b=v.handleEvent,y=v.triggerEvent,x=v.findClosestElementFromNode,v.ToolbarController=function(a){function f(d){this.element=d,this.didKeyDownDialogInput=c(this.didKeyDownDialogInput,this),this.didClickDialogButton=c(this.didClickDialogButton,this),this.didClickAttributeButton=c(this.didClickAttributeButton,this),this.didClickActionButton=c(this.didClickActionButton,this),this.attributes={},this.actions={},this.resetDialogInputs(),b("mousedown",{onElement:this.element,matchingSelector:o,withCallback:this.didClickActionButton}),b("mousedown",{onElement:this.element,matchingSelector:l,withCallback:this.didClickAttributeButton}),b("click",{onElement:this.element,matchingSelector:g,preventDefault:!0}),b("click",{onElement:this.element,matchingSelector:n,withCallback:this.didClickDialogButton}),b("keydown",{onElement:this.element,matchingSelector:h,withCallback:this.didKeyDownDialogInput})}var o,r,l,n,h,u,m,t,i,p,g;return s(f,a),l="[data-trix-attribute]",o="[data-trix-action]",g=l+", "+o,u="[data-trix-dialog]",r=u+"[data-trix-active]",n=u+" [data-trix-method]",h=u+" [data-trix-input]",f.prototype.didClickActionButton=function(d,A){var w,k,D;return(k=this.delegate)!=null&&k.toolbarDidClickButton(),d.preventDefault(),w=m(A),this.getDialog(w)?this.toggleDialog(w):(D=this.delegate)!=null?D.toolbarDidInvokeAction(w):void 0},f.prototype.didClickAttributeButton=function(d,A){var w,k,D;return(k=this.delegate)!=null&&k.toolbarDidClickButton(),d.preventDefault(),w=t(A),this.getDialog(w)?this.toggleDialog(w):(D=this.delegate)!=null&&D.toolbarDidToggleAttribute(w),this.refreshAttributeButtons()},f.prototype.didClickDialogButton=function(d,A){var w,k;return w=x(A,{matchingSelector:u}),k=A.getAttribute("data-trix-method"),this[k].call(this,w)},f.prototype.didKeyDownDialogInput=function(d,A){var w,k;return d.keyCode===13&&(d.preventDefault(),w=A.getAttribute("name"),k=this.getDialog(w),this.setAttribute(k)),d.keyCode===27?(d.preventDefault(),this.hideDialog()):void 0},f.prototype.updateActions=function(d){return this.actions=d,this.refreshActionButtons()},f.prototype.refreshActionButtons=function(){return this.eachActionButton(function(d){return function(A,w){return A.disabled=d.actions[w]===!1}}(this))},f.prototype.eachActionButton=function(d){var A,w,k,D,O;for(D=this.element.querySelectorAll(o),O=[],w=0,k=D.length;k>w;w++)A=D[w],O.push(d(A,m(A)));return O},f.prototype.updateAttributes=function(d){return this.attributes=d,this.refreshAttributeButtons()},f.prototype.refreshAttributeButtons=function(){return this.eachAttributeButton(function(d){return function(A,w){return A.disabled=d.attributes[w]===!1,d.attributes[w]||d.dialogIsVisible(w)?(A.setAttribute("data-trix-active",""),A.classList.add("trix-active")):(A.removeAttribute("data-trix-active"),A.classList.remove("trix-active"))}}(this))},f.prototype.eachAttributeButton=function(d){var A,w,k,D,O;for(D=this.element.querySelectorAll(l),O=[],w=0,k=D.length;k>w;w++)A=D[w],O.push(d(A,t(A)));return O},f.prototype.applyKeyboardCommand=function(d){var A,w,k,D,O,R,L;for(O=JSON.stringify(d.sort()),L=this.element.querySelectorAll("[data-trix-key]"),D=0,R=L.length;R>D;D++)if(A=L[D],k=A.getAttribute("data-trix-key").split("+"),w=JSON.stringify(k.sort()),w===O)return y("mousedown",{onElement:A}),!0;return!1},f.prototype.dialogIsVisible=function(d){var A;return(A=this.getDialog(d))?A.hasAttribute("data-trix-active"):void 0},f.prototype.toggleDialog=function(d){return this.dialogIsVisible(d)?this.hideDialog():this.showDialog(d)},f.prototype.showDialog=function(d){var A,w,k,D,O,R,L,E,C,S;for(this.hideDialog(),(L=this.delegate)!=null&&L.toolbarWillShowDialog(),k=this.getDialog(d),k.setAttribute("data-trix-active",""),k.classList.add("trix-active"),E=k.querySelectorAll("input[disabled]"),D=0,R=E.length;R>D;D++)w=E[D],w.removeAttribute("disabled");return(A=t(k))&&(O=p(k,d))&&(O.value=(C=this.attributes[A])!=null?C:"",O.select()),(S=this.delegate)!=null?S.toolbarDidShowDialog(d):void 0},f.prototype.setAttribute=function(d){var A,w,k;return A=t(d),w=p(d,A),w.willValidate&&!w.checkValidity()?(w.setAttribute("data-trix-validate",""),w.classList.add("trix-validate"),w.focus()):((k=this.delegate)!=null&&k.toolbarDidUpdateAttribute(A,w.value),this.hideDialog())},f.prototype.removeAttribute=function(d){var A,w;return A=t(d),(w=this.delegate)!=null&&w.toolbarDidRemoveAttribute(A),this.hideDialog()},f.prototype.hideDialog=function(){var d,A;return(d=this.element.querySelector(r))?(d.removeAttribute("data-trix-active"),d.classList.remove("trix-active"),this.resetDialogInputs(),(A=this.delegate)!=null?A.toolbarDidHideDialog(i(d)):void 0):void 0},f.prototype.resetDialogInputs=function(){var d,A,w,k,D;for(k=this.element.querySelectorAll(h),D=[],d=0,w=k.length;w>d;d++)A=k[d],A.setAttribute("disabled","disabled"),A.removeAttribute("data-trix-validate"),D.push(A.classList.remove("trix-validate"));return D},f.prototype.getDialog=function(d){return this.element.querySelector("[data-trix-dialog="+d+"]")},p=function(d,A){return A==null&&(A=t(d)),d.querySelector("[data-trix-input][name='"+A+"']")},m=function(d){return d.getAttribute("data-trix-action")},t=function(d){var A;return(A=d.getAttribute("data-trix-attribute"))!=null?A:d.getAttribute("data-trix-dialog-attribute")},i=function(d){return d.getAttribute("data-trix-dialog")},f}(v.BasicObject)}).call(this),(function(){var x=function(y,c){function s(){this.constructor=y}for(var e in c)b.call(c,e)&&(y[e]=c[e]);return s.prototype=c.prototype,y.prototype=new s,y.__super__=c.prototype,y},b={}.hasOwnProperty;v.ImagePreloadOperation=function(y){function c(s){this.url=s}return x(c,y),c.prototype.perform=function(s){var e;return e=new Image,e.onload=function(a){return function(){return e.width=a.width=e.naturalWidth,e.height=a.height=e.naturalHeight,s(!0,e)}}(this),e.onerror=function(){return s(!1)},e.src=this.url},c}(v.Operation)}).call(this),(function(){var x=function(c,s){return function(){return c.apply(s,arguments)}},b=function(c,s){function e(){this.constructor=c}for(var a in s)y.call(s,a)&&(c[a]=s[a]);return e.prototype=s.prototype,c.prototype=new e,c.__super__=s.prototype,c},y={}.hasOwnProperty;v.Attachment=function(c){function s(e){e==null&&(e={}),this.releaseFile=x(this.releaseFile,this),s.__super__.constructor.apply(this,arguments),this.attributes=v.Hash.box(e),this.didChangeAttributes()}return b(s,c),s.previewablePattern=/^image(\/(gif|png|jpe?g)|$)/,s.attachmentForFile=function(e){var a,f;return f=this.attributesForFile(e),a=new this(f),a.setFile(e),a},s.attributesForFile=function(e){return new v.Hash({filename:e.name,filesize:e.size,contentType:e.type})},s.fromJSON=function(e){return new this(e)},s.prototype.getAttribute=function(e){return this.attributes.get(e)},s.prototype.hasAttribute=function(e){return this.attributes.has(e)},s.prototype.getAttributes=function(){return this.attributes.toObject()},s.prototype.setAttributes=function(e){var a,f,o;return e==null&&(e={}),a=this.attributes.merge(e),this.attributes.isEqualTo(a)?void 0:(this.attributes=a,this.didChangeAttributes(),(f=this.previewDelegate)!=null&&typeof f.attachmentDidChangeAttributes=="function"&&f.attachmentDidChangeAttributes(this),(o=this.delegate)!=null&&typeof o.attachmentDidChangeAttributes=="function"?o.attachmentDidChangeAttributes(this):void 0)},s.prototype.didChangeAttributes=function(){return this.isPreviewable()?this.preloadURL():void 0},s.prototype.isPending=function(){return this.file!=null&&!(this.getURL()||this.getHref())},s.prototype.isPreviewable=function(){return this.attributes.has("previewable")?this.attributes.get("previewable"):this.constructor.previewablePattern.test(this.getContentType())},s.prototype.getType=function(){return this.hasContent()?"content":this.isPreviewable()?"preview":"file"},s.prototype.getURL=function(){return this.attributes.get("url")},s.prototype.getHref=function(){return this.attributes.get("href")},s.prototype.getFilename=function(){var e;return(e=this.attributes.get("filename"))!=null?e:""},s.prototype.getFilesize=function(){return this.attributes.get("filesize")},s.prototype.getFormattedFilesize=function(){var e;return e=this.attributes.get("filesize"),typeof e=="number"?v.config.fileSize.formatter(e):""},s.prototype.getExtension=function(){var e;return(e=this.getFilename().match(/\.(\w+)$/))!=null?e[1].toLowerCase():void 0},s.prototype.getContentType=function(){return this.attributes.get("contentType")},s.prototype.hasContent=function(){return this.attributes.has("content")},s.prototype.getContent=function(){return this.attributes.get("content")},s.prototype.getWidth=function(){return this.attributes.get("width")},s.prototype.getHeight=function(){return this.attributes.get("height")},s.prototype.getFile=function(){return this.file},s.prototype.setFile=function(e){return this.file=e,this.isPreviewable()?this.preloadFile():void 0},s.prototype.releaseFile=function(){return this.releasePreloadedFile(),this.file=null},s.prototype.getUploadProgress=function(){var e;return(e=this.uploadProgress)!=null?e:0},s.prototype.setUploadProgress=function(e){var a;return this.uploadProgress!==e?(this.uploadProgress=e,(a=this.uploadProgressDelegate)!=null&&typeof a.attachmentDidChangeUploadProgress=="function"?a.attachmentDidChangeUploadProgress(this):void 0):void 0},s.prototype.toJSON=function(){return this.getAttributes()},s.prototype.getCacheKey=function(){return[s.__super__.getCacheKey.apply(this,arguments),this.attributes.getCacheKey(),this.getPreviewURL()].join("/")},s.prototype.getPreviewURL=function(){return this.previewURL||this.preloadingURL},s.prototype.setPreviewURL=function(e){var a,f;return e!==this.getPreviewURL()?(this.previewURL=e,(a=this.previewDelegate)!=null&&typeof a.attachmentDidChangeAttributes=="function"&&a.attachmentDidChangeAttributes(this),(f=this.delegate)!=null&&typeof f.attachmentDidChangePreviewURL=="function"?f.attachmentDidChangePreviewURL(this):void 0):void 0},s.prototype.preloadURL=function(){return this.preload(this.getURL(),this.releaseFile)},s.prototype.preloadFile=function(){return this.file?(this.fileObjectURL=URL.createObjectURL(this.file),this.preload(this.fileObjectURL)):void 0},s.prototype.releasePreloadedFile=function(){return this.fileObjectURL?(URL.revokeObjectURL(this.fileObjectURL),this.fileObjectURL=null):void 0},s.prototype.preload=function(e,a){var f;return e&&e!==this.getPreviewURL()?(this.preloadingURL=e,f=new v.ImagePreloadOperation(e),f.then(function(o){return function(r){var l,n;return n=r.width,l=r.height,o.getWidth()&&o.getHeight()||o.setAttributes({width:n,height:l}),o.preloadingURL=null,o.setPreviewURL(e),typeof a=="function"?a():void 0}}(this)).catch(function(o){return function(){return o.preloadingURL=null,typeof a=="function"?a():void 0}}(this))):void 0},s}(v.Object)}).call(this),(function(){var x=function(y,c){function s(){this.constructor=y}for(var e in c)b.call(c,e)&&(y[e]=c[e]);return s.prototype=c.prototype,y.prototype=new s,y.__super__=c.prototype,y},b={}.hasOwnProperty;v.Piece=function(y){function c(s,e){e==null&&(e={}),c.__super__.constructor.apply(this,arguments),this.attributes=v.Hash.box(e)}return x(c,y),c.types={},c.registerType=function(s,e){return e.type=s,this.types[s]=e},c.fromJSON=function(s){var e;return(e=this.types[s.type])?e.fromJSON(s):void 0},c.prototype.copyWithAttributes=function(s){return new this.constructor(this.getValue(),s)},c.prototype.copyWithAdditionalAttributes=function(s){return this.copyWithAttributes(this.attributes.merge(s))},c.prototype.copyWithoutAttribute=function(s){return this.copyWithAttributes(this.attributes.remove(s))},c.prototype.copy=function(){return this.copyWithAttributes(this.attributes)},c.prototype.getAttribute=function(s){return this.attributes.get(s)},c.prototype.getAttributesHash=function(){return this.attributes},c.prototype.getAttributes=function(){return this.attributes.toObject()},c.prototype.getCommonAttributes=function(){var s,e,a;return(a=pieceList.getPieceAtIndex(0))?(s=a.attributes,e=s.getKeys(),pieceList.eachPiece(function(f){return e=s.getKeysCommonToHash(f.attributes),s=s.slice(e)}),s.toObject()):{}},c.prototype.hasAttribute=function(s){return this.attributes.has(s)},c.prototype.hasSameStringValueAsPiece=function(s){return s!=null&&this.toString()===s.toString()},c.prototype.hasSameAttributesAsPiece=function(s){return s!=null&&(this.attributes===s.attributes||this.attributes.isEqualTo(s.attributes))},c.prototype.isBlockBreak=function(){return!1},c.prototype.isEqualTo=function(s){return c.__super__.isEqualTo.apply(this,arguments)||this.hasSameConstructorAs(s)&&this.hasSameStringValueAsPiece(s)&&this.hasSameAttributesAsPiece(s)},c.prototype.isEmpty=function(){return this.length===0},c.prototype.isSerializable=function(){return!0},c.prototype.toJSON=function(){return{type:this.constructor.type,attributes:this.getAttributes()}},c.prototype.contentsForInspection=function(){return{type:this.constructor.type,attributes:this.attributes.inspect()}},c.prototype.canBeGrouped=function(){return this.hasAttribute("href")},c.prototype.canBeGroupedWith=function(s){return this.getAttribute("href")===s.getAttribute("href")},c.prototype.getLength=function(){return this.length},c.prototype.canBeConsolidatedWith=function(){return!1},c}(v.Object)}).call(this),(function(){var x=function(y,c){function s(){this.constructor=y}for(var e in c)b.call(c,e)&&(y[e]=c[e]);return s.prototype=c.prototype,y.prototype=new s,y.__super__=c.prototype,y},b={}.hasOwnProperty;v.Piece.registerType("attachment",v.AttachmentPiece=function(y){function c(s){this.attachment=s,c.__super__.constructor.apply(this,arguments),this.length=1,this.ensureAttachmentExclusivelyHasAttribute("href"),this.attachment.hasContent()||this.removeProhibitedAttributes()}return x(c,y),c.fromJSON=function(s){return new this(v.Attachment.fromJSON(s.attachment),s.attributes)},c.permittedAttributes=["caption","presentation"],c.prototype.ensureAttachmentExclusivelyHasAttribute=function(s){return this.hasAttribute(s)?(this.attachment.hasAttribute(s)||this.attachment.setAttributes(this.attributes.slice(s)),this.attributes=this.attributes.remove(s)):void 0},c.prototype.removeProhibitedAttributes=function(){var s;return s=this.attributes.slice(this.constructor.permittedAttributes),s.isEqualTo(this.attributes)?void 0:this.attributes=s},c.prototype.getValue=function(){return this.attachment},c.prototype.isSerializable=function(){return!this.attachment.isPending()},c.prototype.getCaption=function(){var s;return(s=this.attributes.get("caption"))!=null?s:""},c.prototype.isEqualTo=function(s){var e;return c.__super__.isEqualTo.apply(this,arguments)&&this.attachment.id===(s!=null&&(e=s.attachment)!=null?e.id:void 0)},c.prototype.toString=function(){return v.OBJECT_REPLACEMENT_CHARACTER},c.prototype.toJSON=function(){var s;return s=c.__super__.toJSON.apply(this,arguments),s.attachment=this.attachment,s},c.prototype.getCacheKey=function(){return[c.__super__.getCacheKey.apply(this,arguments),this.attachment.getCacheKey()].join("/")},c.prototype.toConsole=function(){return JSON.stringify(this.toString())},c}(v.Piece))}).call(this),(function(){var x,b=function(c,s){function e(){this.constructor=c}for(var a in s)y.call(s,a)&&(c[a]=s[a]);return e.prototype=s.prototype,c.prototype=new e,c.__super__=s.prototype,c},y={}.hasOwnProperty;x=v.normalizeNewlines,v.Piece.registerType("string",v.StringPiece=function(c){function s(e){s.__super__.constructor.apply(this,arguments),this.string=x(e),this.length=this.string.length}return b(s,c),s.fromJSON=function(e){return new this(e.string,e.attributes)},s.prototype.getValue=function(){return this.string},s.prototype.toString=function(){return this.string.toString()},s.prototype.isBlockBreak=function(){return this.toString()===`
`&&this.getAttribute("blockBreak")===!0},s.prototype.toJSON=function(){var e;return e=s.__super__.toJSON.apply(this,arguments),e.string=this.string,e},s.prototype.canBeConsolidatedWith=function(e){return e!=null&&this.hasSameConstructorAs(e)&&this.hasSameAttributesAsPiece(e)},s.prototype.consolidateWith=function(e){return new this.constructor(this.toString()+e.toString(),this.attributes)},s.prototype.splitAtOffset=function(e){var a,f;return e===0?(a=null,f=this):e===this.length?(a=this,f=null):(a=new this.constructor(this.string.slice(0,e),this.attributes),f=new this.constructor(this.string.slice(e),this.attributes)),[a,f]},s.prototype.toConsole=function(){var e;return e=this.string,e.length>15&&(e=e.slice(0,14)+"…"),JSON.stringify(e.toString())},s}(v.Piece))}).call(this),(function(){var x,b=function(s,e){function a(){this.constructor=s}for(var f in e)y.call(e,f)&&(s[f]=e[f]);return a.prototype=e.prototype,s.prototype=new a,s.__super__=e.prototype,s},y={}.hasOwnProperty,c=[].slice;x=v.spliceArray,v.SplittableList=function(s){function e(r){r==null&&(r=[]),e.__super__.constructor.apply(this,arguments),this.objects=r.slice(0),this.length=this.objects.length}var a,f,o;return b(e,s),e.box=function(r){return r instanceof this?r:new this(r)},e.prototype.indexOf=function(r){return this.objects.indexOf(r)},e.prototype.splice=function(){var r;return r=1<=arguments.length?c.call(arguments,0):[],new this.constructor(x.apply(null,[this.objects].concat(c.call(r))))},e.prototype.eachObject=function(r){var l,n,h,u,m,t;for(m=this.objects,t=[],n=l=0,h=m.length;h>l;n=++l)u=m[n],t.push(r(u,n));return t},e.prototype.insertObjectAtIndex=function(r,l){return this.splice(l,0,r)},e.prototype.insertSplittableListAtIndex=function(r,l){return this.splice.apply(this,[l,0].concat(c.call(r.objects)))},e.prototype.insertSplittableListAtPosition=function(r,l){var n,h,u;return u=this.splitObjectAtPosition(l),h=u[0],n=u[1],new this.constructor(h).insertSplittableListAtIndex(r,n)},e.prototype.editObjectAtIndex=function(r,l){return this.replaceObjectAtIndex(l(this.objects[r]),r)},e.prototype.replaceObjectAtIndex=function(r,l){return this.splice(l,1,r)},e.prototype.removeObjectAtIndex=function(r){return this.splice(r,1)},e.prototype.getObjectAtIndex=function(r){return this.objects[r]},e.prototype.getSplittableListInRange=function(r){var l,n,h,u;return h=this.splitObjectsAtRange(r),n=h[0],l=h[1],u=h[2],new this.constructor(n.slice(l,u+1))},e.prototype.selectSplittableList=function(r){var l,n;return n=(function(){var h,u,m,t;for(m=this.objects,t=[],h=0,u=m.length;u>h;h++)l=m[h],r(l)&&t.push(l);return t}).call(this),new this.constructor(n)},e.prototype.removeObjectsInRange=function(r){var l,n,h,u;return h=this.splitObjectsAtRange(r),n=h[0],l=h[1],u=h[2],new this.constructor(n).splice(l,u-l+1)},e.prototype.transformObjectsInRange=function(r,l){var n,h,u,m,t,i,p;return t=this.splitObjectsAtRange(r),m=t[0],h=t[1],i=t[2],p=function(){var g,d,A;for(A=[],n=g=0,d=m.length;d>g;n=++g)u=m[n],A.push(n>=h&&i>=n?l(u):u);return A}(),new this.constructor(p)},e.prototype.splitObjectsAtRange=function(r){var l,n,h,u,m,t;return u=this.splitObjectAtPosition(o(r)),n=u[0],l=u[1],h=u[2],m=new this.constructor(n).splitObjectAtPosition(a(r)+h),n=m[0],t=m[1],[n,l,t-1]},e.prototype.getObjectAtPosition=function(r){var l,n;return n=this.findIndexAndOffsetAtPosition(r),l=n.index,n.offset,this.objects[l]},e.prototype.splitObjectAtPosition=function(r){var l,n,h,u,m,t,i,p,g,d;return t=this.findIndexAndOffsetAtPosition(r),l=t.index,m=t.offset,u=this.objects.slice(0),l!=null?m===0?(g=l,d=0):(h=this.getObjectAtIndex(l),i=h.splitAtOffset(m),n=i[0],p=i[1],u.splice(l,1,n,p),g=l+1,d=n.getLength()-m):(g=u.length,d=0),[u,g,d]},e.prototype.consolidate=function(){var r,l,n,h,u,m;for(h=[],u=this.objects[0],m=this.objects.slice(1),r=0,l=m.length;l>r;r++)n=m[r],typeof u.canBeConsolidatedWith=="function"&&u.canBeConsolidatedWith(n)?u=u.consolidateWith(n):(h.push(u),u=n);return u!=null&&h.push(u),new this.constructor(h)},e.prototype.consolidateFromIndexToIndex=function(r,l){var n,h,u;return h=this.objects.slice(0),u=h.slice(r,l+1),n=new this.constructor(u).consolidate().toArray(),this.splice.apply(this,[r,u.length].concat(c.call(n)))},e.prototype.findIndexAndOffsetAtPosition=function(r){var l,n,h,u,m,t,i;for(l=0,i=this.objects,h=n=0,u=i.length;u>n;h=++n){if(t=i[h],m=l+t.getLength(),r>=l&&m>r)return{index:h,offset:r-l};l=m}return{index:null,offset:null}},e.prototype.findPositionAtIndexAndOffset=function(r,l){var n,h,u,m,t,i;for(t=0,i=this.objects,n=h=0,u=i.length;u>h;n=++h)if(m=i[n],r>n)t+=m.getLength();else if(n===r){t+=l;break}return t},e.prototype.getEndPosition=function(){var r,l;return this.endPosition!=null?this.endPosition:this.endPosition=(function(){var n,h,u;for(l=0,u=this.objects,n=0,h=u.length;h>n;n++)r=u[n],l+=r.getLength();return l}).call(this)},e.prototype.toString=function(){return this.objects.join("")},e.prototype.toArray=function(){return this.objects.slice(0)},e.prototype.toJSON=function(){return this.toArray()},e.prototype.isEqualTo=function(r){return e.__super__.isEqualTo.apply(this,arguments)||f(this.objects,r!=null?r.objects:void 0)},f=function(r,l){var n,h,u,m,t;if(l==null&&(l=[]),r.length!==l.length)return!1;for(t=!0,h=n=0,u=r.length;u>n;h=++n)m=r[h],t&&!m.isEqualTo(l[h])&&(t=!1);return t},e.prototype.contentsForInspection=function(){var r;return{objects:"["+(function(){var l,n,h,u;for(h=this.objects,u=[],l=0,n=h.length;n>l;l++)r=h[l],u.push(r.inspect());return u}).call(this).join(", ")+"]"}},o=function(r){return r[0]},a=function(r){return r[1]},e}(v.Object)}).call(this),(function(){var x=function(y,c){function s(){this.constructor=y}for(var e in c)b.call(c,e)&&(y[e]=c[e]);return s.prototype=c.prototype,y.prototype=new s,y.__super__=c.prototype,y},b={}.hasOwnProperty;v.Text=function(y){function c(s){var e;s==null&&(s=[]),c.__super__.constructor.apply(this,arguments),this.pieceList=new v.SplittableList(function(){var a,f,o;for(o=[],a=0,f=s.length;f>a;a++)e=s[a],e.isEmpty()||o.push(e);return o}())}return x(c,y),c.textForAttachmentWithAttributes=function(s,e){var a;return a=new v.AttachmentPiece(s,e),new this([a])},c.textForStringWithAttributes=function(s,e){var a;return a=new v.StringPiece(s,e),new this([a])},c.fromJSON=function(s){var e,a;return a=function(){var f,o,r;for(r=[],f=0,o=s.length;o>f;f++)e=s[f],r.push(v.Piece.fromJSON(e));return r}(),new this(a)},c.prototype.copy=function(){return this.copyWithPieceList(this.pieceList)},c.prototype.copyWithPieceList=function(s){return new this.constructor(s.consolidate().toArray())},c.prototype.copyUsingObjectMap=function(s){var e,a;return a=(function(){var f,o,r,l,n;for(r=this.getPieces(),n=[],f=0,o=r.length;o>f;f++)e=r[f],n.push((l=s.find(e))!=null?l:e);return n}).call(this),new this.constructor(a)},c.prototype.appendText=function(s){return this.insertTextAtPosition(s,this.getLength())},c.prototype.insertTextAtPosition=function(s,e){return this.copyWithPieceList(this.pieceList.insertSplittableListAtPosition(s.pieceList,e))},c.prototype.removeTextAtRange=function(s){return this.copyWithPieceList(this.pieceList.removeObjectsInRange(s))},c.prototype.replaceTextAtRange=function(s,e){return this.removeTextAtRange(e).insertTextAtPosition(s,e[0])},c.prototype.moveTextFromRangeToPosition=function(s,e){var a,f;if(!(s[0]<=e&&e<=s[1]))return f=this.getTextAtRange(s),a=f.getLength(),s[0]<e&&(e-=a),this.removeTextAtRange(s).insertTextAtPosition(f,e)},c.prototype.addAttributeAtRange=function(s,e,a){var f;return f={},f[s]=e,this.addAttributesAtRange(f,a)},c.prototype.addAttributesAtRange=function(s,e){return this.copyWithPieceList(this.pieceList.transformObjectsInRange(e,function(a){return a.copyWithAdditionalAttributes(s)}))},c.prototype.removeAttributeAtRange=function(s,e){return this.copyWithPieceList(this.pieceList.transformObjectsInRange(e,function(a){return a.copyWithoutAttribute(s)}))},c.prototype.setAttributesAtRange=function(s,e){return this.copyWithPieceList(this.pieceList.transformObjectsInRange(e,function(a){return a.copyWithAttributes(s)}))},c.prototype.getAttributesAtPosition=function(s){var e,a;return(e=(a=this.pieceList.getObjectAtPosition(s))!=null?a.getAttributes():void 0)!=null?e:{}},c.prototype.getCommonAttributes=function(){var s,e;return s=(function(){var a,f,o,r;for(o=this.pieceList.toArray(),r=[],a=0,f=o.length;f>a;a++)e=o[a],r.push(e.getAttributes());return r}).call(this),v.Hash.fromCommonAttributesOfObjects(s).toObject()},c.prototype.getCommonAttributesAtRange=function(s){var e;return(e=this.getTextAtRange(s).getCommonAttributes())!=null?e:{}},c.prototype.getExpandedRangeForAttributeAtOffset=function(s,e){var a,f,o;for(a=o=e,f=this.getLength();a>0&&this.getCommonAttributesAtRange([a-1,o])[s];)a--;for(;f>o&&this.getCommonAttributesAtRange([e,o+1])[s];)o++;return[a,o]},c.prototype.getTextAtRange=function(s){return this.copyWithPieceList(this.pieceList.getSplittableListInRange(s))},c.prototype.getStringAtRange=function(s){return this.pieceList.getSplittableListInRange(s).toString()},c.prototype.getStringAtPosition=function(s){return this.getStringAtRange([s,s+1])},c.prototype.startsWithString=function(s){return this.getStringAtRange([0,s.length])===s},c.prototype.endsWithString=function(s){var e;return e=this.getLength(),this.getStringAtRange([e-s.length,e])===s},c.prototype.getAttachmentPieces=function(){var s,e,a,f,o;for(f=this.pieceList.toArray(),o=[],s=0,e=f.length;e>s;s++)a=f[s],a.attachment!=null&&o.push(a);return o},c.prototype.getAttachments=function(){var s,e,a,f,o;for(f=this.getAttachmentPieces(),o=[],s=0,e=f.length;e>s;s++)a=f[s],o.push(a.attachment);return o},c.prototype.getAttachmentAndPositionById=function(s){var e,a,f,o,r,l;for(o=0,r=this.pieceList.toArray(),e=0,a=r.length;a>e;e++){if(f=r[e],((l=f.attachment)!=null?l.id:void 0)===s)return{attachment:f.attachment,position:o};o+=f.length}return{attachment:null,position:null}},c.prototype.getAttachmentById=function(s){var e,a;return a=this.getAttachmentAndPositionById(s),e=a.attachment,a.position,e},c.prototype.getRangeOfAttachment=function(s){var e,a;return a=this.getAttachmentAndPositionById(s.id),s=a.attachment,e=a.position,s!=null?[e,e+1]:void 0},c.prototype.updateAttributesForAttachment=function(s,e){var a;return(a=this.getRangeOfAttachment(e))?this.addAttributesAtRange(s,a):this},c.prototype.getLength=function(){return this.pieceList.getEndPosition()},c.prototype.isEmpty=function(){return this.getLength()===0},c.prototype.isEqualTo=function(s){var e;return c.__super__.isEqualTo.apply(this,arguments)||(s!=null&&(e=s.pieceList)!=null?e.isEqualTo(this.pieceList):void 0)},c.prototype.isBlockBreak=function(){return this.getLength()===1&&this.pieceList.getObjectAtIndex(0).isBlockBreak()},c.prototype.eachPiece=function(s){return this.pieceList.eachObject(s)},c.prototype.getPieces=function(){return this.pieceList.toArray()},c.prototype.getPieceAtPosition=function(s){return this.pieceList.getObjectAtPosition(s)},c.prototype.contentsForInspection=function(){return{pieceList:this.pieceList.inspect()}},c.prototype.toSerializableText=function(){var s;return s=this.pieceList.selectSplittableList(function(e){return e.isSerializable()}),this.copyWithPieceList(s)},c.prototype.toString=function(){return this.pieceList.toString()},c.prototype.toJSON=function(){return this.pieceList.toJSON()},c.prototype.toConsole=function(){var s;return JSON.stringify((function(){var e,a,f,o;for(f=this.pieceList.toArray(),o=[],e=0,a=f.length;a>e;e++)s=f[e],o.push(JSON.parse(s.toConsole()));return o}).call(this))},c.prototype.getDirection=function(){return v.getDirection(this.toString())},c.prototype.isRTL=function(){return this.getDirection()==="rtl"},c}(v.Object)}).call(this),(function(){var x,b,y,c,s=function(o,r){function l(){this.constructor=o}for(var n in r)e.call(r,n)&&(o[n]=r[n]);return l.prototype=r.prototype,o.prototype=new l,o.__super__=r.prototype,o},e={}.hasOwnProperty,a=[].indexOf||function(o){for(var r=0,l=this.length;l>r;r++)if(r in this&&this[r]===o)return r;return-1},f=[].slice;x=v.arraysAreEqual,c=v.spliceArray,b=v.getBlockConfig,v.getBlockAttributeNames,y=v.getListAttributeNames,v.Block=function(o){function r(d,A){d==null&&(d=new v.Text),A==null&&(A=[]),r.__super__.constructor.apply(this,arguments),this.text=n(d),this.attributes=A}var l,n,h,u,m,t,i,p,g;return s(r,o),r.fromJSON=function(d){var A;return A=v.Text.fromJSON(d.text),new this(A,d.attributes)},r.prototype.isEmpty=function(){return this.text.isBlockBreak()},r.prototype.isEqualTo=function(d){return r.__super__.isEqualTo.apply(this,arguments)||this.text.isEqualTo(d!=null?d.text:void 0)&&x(this.attributes,d!=null?d.attributes:void 0)},r.prototype.copyWithText=function(d){return new this.constructor(d,this.attributes)},r.prototype.copyWithoutText=function(){return this.copyWithText(null)},r.prototype.copyWithAttributes=function(d){return new this.constructor(this.text,d)},r.prototype.copyWithoutAttributes=function(){return this.copyWithAttributes(null)},r.prototype.copyUsingObjectMap=function(d){var A;return this.copyWithText((A=d.find(this.text))?A:this.text.copyUsingObjectMap(d))},r.prototype.addAttribute=function(d){var A;return A=this.attributes.concat(u(d)),this.copyWithAttributes(A)},r.prototype.removeAttribute=function(d){var A,w;return w=b(d).listAttribute,A=t(t(this.attributes,d),w),this.copyWithAttributes(A)},r.prototype.removeLastAttribute=function(){return this.removeAttribute(this.getLastAttribute())},r.prototype.getLastAttribute=function(){return m(this.attributes)},r.prototype.getAttributes=function(){return this.attributes.slice(0)},r.prototype.getAttributeLevel=function(){return this.attributes.length},r.prototype.getAttributeAtLevel=function(d){return this.attributes[d-1]},r.prototype.hasAttribute=function(d){return a.call(this.attributes,d)>=0},r.prototype.hasAttributes=function(){return this.getAttributeLevel()>0},r.prototype.getLastNestableAttribute=function(){return m(this.getNestableAttributes())},r.prototype.getNestableAttributes=function(){var d,A,w,k,D;for(k=this.attributes,D=[],A=0,w=k.length;w>A;A++)d=k[A],b(d).nestable&&D.push(d);return D},r.prototype.getNestingLevel=function(){return this.getNestableAttributes().length},r.prototype.decreaseNestingLevel=function(){var d;return(d=this.getLastNestableAttribute())?this.removeAttribute(d):this},r.prototype.increaseNestingLevel=function(){var d,A,w;return(d=this.getLastNestableAttribute())?(w=this.attributes.lastIndexOf(d),A=c.apply(null,[this.attributes,w+1,0].concat(f.call(u(d)))),this.copyWithAttributes(A)):this},r.prototype.getListItemAttributes=function(){var d,A,w,k,D;for(k=this.attributes,D=[],A=0,w=k.length;w>A;A++)d=k[A],b(d).listAttribute&&D.push(d);return D},r.prototype.isListItem=function(){var d;return(d=b(this.getLastAttribute()))!=null?d.listAttribute:void 0},r.prototype.isTerminalBlock=function(){var d;return(d=b(this.getLastAttribute()))!=null?d.terminal:void 0},r.prototype.breaksOnReturn=function(){var d;return(d=b(this.getLastAttribute()))!=null?d.breakOnReturn:void 0},r.prototype.findLineBreakInDirectionFromPosition=function(d,A){var w,k;return k=this.toString(),w=function(){switch(d){case"forward":return k.indexOf(`
`,A);case"backward":return k.slice(0,A).lastIndexOf(`
`)}}(),w!==-1?w:void 0},r.prototype.contentsForInspection=function(){return{text:this.text.inspect(),attributes:this.attributes}},r.prototype.toString=function(){return this.text.toString()},r.prototype.toJSON=function(){return{text:this.text,attributes:this.attributes}},r.prototype.getDirection=function(){return this.text.getDirection()},r.prototype.isRTL=function(){return this.text.isRTL()},r.prototype.getLength=function(){return this.text.getLength()},r.prototype.canBeConsolidatedWith=function(d){return!this.hasAttributes()&&!d.hasAttributes()&&this.getDirection()===d.getDirection()},r.prototype.consolidateWith=function(d){var A,w;return A=v.Text.textForStringWithAttributes(`
`),w=this.getTextWithoutBlockBreak().appendText(A),this.copyWithText(w.appendText(d.text))},r.prototype.splitAtOffset=function(d){var A,w;return d===0?(A=null,w=this):d===this.getLength()?(A=this,w=null):(A=this.copyWithText(this.text.getTextAtRange([0,d])),w=this.copyWithText(this.text.getTextAtRange([d,this.getLength()]))),[A,w]},r.prototype.getBlockBreakPosition=function(){return this.text.getLength()-1},r.prototype.getTextWithoutBlockBreak=function(){return i(this.text)?this.text.getTextAtRange([0,this.getBlockBreakPosition()]):this.text.copy()},r.prototype.canBeGrouped=function(d){return this.attributes[d]},r.prototype.canBeGroupedWith=function(d,A){var w,k,D,O;return D=d.getAttributes(),k=D[A],w=this.attributes[A],!(w!==k||b(w).group===!1&&(O=D[A+1],a.call(y(),O)<0)||this.getDirection()!==d.getDirection()&&!d.isEmpty())},n=function(d){return d=g(d),d=l(d)},g=function(d){var A,w,k,D,O,R;return D=!1,R=d.getPieces(),w=2<=R.length?f.call(R,0,A=R.length-1):(A=0,[]),k=R[A++],k==null?d:(w=function(){var L,E,C;for(C=[],L=0,E=w.length;E>L;L++)O=w[L],O.isBlockBreak()?(D=!0,C.push(p(O))):C.push(O);return C}(),D?new v.Text(f.call(w).concat([k])):d)},h=v.Text.textForStringWithAttributes(`
`,{blockBreak:!0}),l=function(d){return i(d)?d:d.appendText(h)},i=function(d){var A,w;return w=d.getLength(),w===0?!1:(A=d.getTextAtRange([w-1,w]),A.isBlockBreak())},p=function(d){return d.copyWithoutAttribute("blockBreak")},u=function(d){var A;return A=b(d).listAttribute,A!=null?[A,d]:[d]},m=function(d){return d.slice(-1)[0]},t=function(d,A){var w;return w=d.lastIndexOf(A),w===-1?d:c(d,w,1)},r}(v.Object)}).call(this),(function(){var x,b,y,c=function(f,o){function r(){this.constructor=f}for(var l in o)s.call(o,l)&&(f[l]=o[l]);return r.prototype=o.prototype,f.prototype=new r,f.__super__=o.prototype,f},s={}.hasOwnProperty,e=[].indexOf||function(f){for(var o=0,r=this.length;r>o;o++)if(o in this&&this[o]===f)return o;return-1},a=[].slice;b=v.tagName,y=v.walkTree,x=v.nodeIsAttachmentElement,v.HTMLSanitizer=function(f){function o(u,m){var t;t=m??{},this.allowedAttributes=t.allowedAttributes,this.forbiddenProtocols=t.forbiddenProtocols,this.forbiddenElements=t.forbiddenElements,this.allowedAttributes==null&&(this.allowedAttributes=r),this.forbiddenProtocols==null&&(this.forbiddenProtocols=n),this.forbiddenElements==null&&(this.forbiddenElements=l),this.body=h(u)}var r,l,n,h;return c(o,f),r="style href src width height class".split(" "),n="javascript:".split(" "),l="script iframe".split(" "),o.sanitize=function(u,m){var t;return t=new this(u,m),t.sanitize(),t},o.prototype.sanitize=function(){return this.sanitizeElements(),this.normalizeListElementNesting()},o.prototype.getHTML=function(){return this.body.innerHTML},o.prototype.getBody=function(){return this.body},o.prototype.sanitizeElements=function(){var u,m,t,i,p;for(p=y(this.body),i=[];p.nextNode();)switch(t=p.currentNode,t.nodeType){case Node.ELEMENT_NODE:this.elementIsRemovable(t)?i.push(t):this.sanitizeElement(t);break;case Node.COMMENT_NODE:i.push(t)}for(u=0,m=i.length;m>u;u++)t=i[u],v.removeNode(t);return this.body},o.prototype.sanitizeElement=function(u){var m,t,i,p,g;for(u.hasAttribute("href")&&(p=u.protocol,e.call(this.forbiddenProtocols,p)>=0&&u.removeAttribute("href")),g=a.call(u.attributes),m=0,t=g.length;t>m;m++)i=g[m].name,e.call(this.allowedAttributes,i)>=0||i.indexOf("data-trix")===0||u.removeAttribute(i);return u},o.prototype.normalizeListElementNesting=function(){var u,m,t,i,p;for(p=a.call(this.body.querySelectorAll("ul,ol")),u=0,m=p.length;m>u;u++)t=p[u],(i=t.previousElementSibling)&&b(i)==="li"&&i.appendChild(t);return this.body},o.prototype.elementIsRemovable=function(u){return(u!=null?u.nodeType:void 0)===Node.ELEMENT_NODE?this.elementIsForbidden(u)||this.elementIsntSerializable(u):void 0},o.prototype.elementIsForbidden=function(u){var m;return m=b(u),e.call(this.forbiddenElements,m)>=0},o.prototype.elementIsntSerializable=function(u){return u.getAttribute("data-trix-serialize")==="false"&&!x(u)},h=function(u){var m,t,i,p,g;for(u==null&&(u=""),u=u.replace(/<\/html[^>]*>[^]*$/i,"</html>"),m=document.implementation.createHTMLDocument(""),m.documentElement.innerHTML=u,g=m.head.querySelectorAll("style"),i=0,p=g.length;p>i;i++)t=g[i],m.body.appendChild(t);return m.body},o}(v.BasicObject)}).call(this),(function(){var x,b,y,c,s,e,a,f,o,r,l,n=function(m,t){function i(){this.constructor=m}for(var p in t)h.call(t,p)&&(m[p]=t[p]);return i.prototype=t.prototype,m.prototype=new i,m.__super__=t.prototype,m},h={}.hasOwnProperty,u=[].indexOf||function(m){for(var t=0,i=this.length;i>t;t++)if(t in this&&this[t]===m)return t;return-1};x=v.arraysAreEqual,e=v.makeElement,r=v.tagName,s=v.getBlockTagNames,l=v.walkTree,c=v.findClosestElementFromNode,y=v.elementContainsNode,a=v.nodeIsAttachmentElement,f=v.normalizeSpaces,b=v.breakableWhitespacePattern,o=v.squishBreakableWhitespace,v.HTMLParser=function(m){function t(C,S){this.html=C,this.referenceElement=(S??{}).referenceElement,this.blocks=[],this.blockElements=[],this.processedElements=[]}var i,p,g,d,A,w,k,D,O,R,L,E;return n(t,m),t.parse=function(C,S){var T;return T=new this(C,S),T.parse(),T},t.prototype.getDocument=function(){return v.Document.fromJSON(this.blocks)},t.prototype.parse=function(){var C,S;try{for(this.createHiddenContainer(),C=v.HTMLSanitizer.sanitize(this.html).getHTML(),this.containerElement.innerHTML=C,S=l(this.containerElement,{usingFilter:k});S.nextNode();)this.processNode(S.currentNode);return this.translateBlockElementMarginsToNewlines()}finally{this.removeHiddenContainer()}},t.prototype.createHiddenContainer=function(){return this.referenceElement?(this.containerElement=this.referenceElement.cloneNode(!1),this.containerElement.removeAttribute("id"),this.containerElement.setAttribute("data-trix-internal",""),this.containerElement.style.display="none",this.referenceElement.parentNode.insertBefore(this.containerElement,this.referenceElement.nextSibling)):(this.containerElement=e({tagName:"div",style:{display:"none"}}),document.body.appendChild(this.containerElement))},t.prototype.removeHiddenContainer=function(){return v.removeNode(this.containerElement)},k=function(C){return r(C)==="style"?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT},t.prototype.processNode=function(C){switch(C.nodeType){case Node.TEXT_NODE:if(!this.isInsignificantTextNode(C))return this.appendBlockForTextNode(C),this.processTextNode(C);break;case Node.ELEMENT_NODE:return this.appendBlockForElement(C),this.processElement(C)}},t.prototype.appendBlockForTextNode=function(C){var S,T,N;return T=C.parentNode,T===this.currentBlockElement&&this.isBlockElement(C.previousSibling)?this.appendStringWithAttributes(`
`):T!==this.containerElement&&!this.isBlockElement(T)||(S=this.getBlockAttributes(T),x(S,(N=this.currentBlock)!=null?N.attributes:void 0))?void 0:(this.currentBlock=this.appendBlockForAttributesWithElement(S,T),this.currentBlockElement=T)},t.prototype.appendBlockForElement=function(C){var S,T,N,P;if(N=this.isBlockElement(C),T=y(this.currentBlockElement,C),N&&!this.isBlockElement(C.firstChild)){if((!this.isInsignificantTextNode(C.firstChild)||!this.isBlockElement(C.firstElementChild))&&(S=this.getBlockAttributes(C),C.firstChild))return T&&x(S,this.currentBlock.attributes)?this.appendStringWithAttributes(`
`):(this.currentBlock=this.appendBlockForAttributesWithElement(S,C),this.currentBlockElement=C)}else if(this.currentBlockElement&&!T&&!N)return(P=this.findParentBlockElement(C))?this.appendBlockForElement(P):(this.currentBlock=this.appendEmptyBlock(),this.currentBlockElement=null)},t.prototype.findParentBlockElement=function(C){var S;for(S=C.parentElement;S&&S!==this.containerElement;){if(this.isBlockElement(S)&&u.call(this.blockElements,S)>=0)return S;S=S.parentElement}return null},t.prototype.processTextNode=function(C){var S,T;return T=C.data,p(C.parentNode)||(T=o(T),L((S=C.previousSibling)!=null?S.textContent:void 0)&&(T=A(T))),this.appendStringWithAttributes(T,this.getTextAttributes(C.parentNode))},t.prototype.processElement=function(C){var S,T,N,P,I;if(a(C))return S=D(C,"attachment"),Object.keys(S).length&&(P=this.getTextAttributes(C),this.appendAttachmentWithAttributes(S,P),C.innerHTML=""),this.processedElements.push(C);switch(r(C)){case"br":return this.isExtraBR(C)||this.isBlockElement(C.nextSibling)||this.appendStringWithAttributes(`
`,this.getTextAttributes(C)),this.processedElements.push(C);case"img":S={url:C.getAttribute("src"),contentType:"image"},N=d(C);for(T in N)I=N[T],S[T]=I;return this.appendAttachmentWithAttributes(S,this.getTextAttributes(C)),this.processedElements.push(C);case"tr":if(C.parentNode.firstChild!==C)return this.appendStringWithAttributes(`
`);break;case"td":if(C.parentNode.firstChild!==C)return this.appendStringWithAttributes(" | ")}},t.prototype.appendBlockForAttributesWithElement=function(C,S){var T;return this.blockElements.push(S),T=i(C),this.blocks.push(T),T},t.prototype.appendEmptyBlock=function(){return this.appendBlockForAttributesWithElement([],null)},t.prototype.appendStringWithAttributes=function(C,S){return this.appendPiece(R(C,S))},t.prototype.appendAttachmentWithAttributes=function(C,S){return this.appendPiece(O(C,S))},t.prototype.appendPiece=function(C){return this.blocks.length===0&&this.appendEmptyBlock(),this.blocks[this.blocks.length-1].text.push(C)},t.prototype.appendStringToTextAtIndex=function(C,S){var T,N;return N=this.blocks[S].text,T=N[N.length-1],(T!=null?T.type:void 0)==="string"?T.string+=C:N.push(R(C))},t.prototype.prependStringToTextAtIndex=function(C,S){var T,N;return N=this.blocks[S].text,T=N[0],(T!=null?T.type:void 0)==="string"?T.string=C+T.string:N.unshift(R(C))},R=function(C,S){var T;return S==null&&(S={}),T="string",C=f(C),{string:C,attributes:S,type:T}},O=function(C,S){var T;return S==null&&(S={}),T="attachment",{attachment:C,attributes:S,type:T}},i=function(C){var S;return C==null&&(C={}),S=[],{text:S,attributes:C}},t.prototype.getTextAttributes=function(C){var S,T,N,P,I,_,B,F,q,V,U,W;N={},q=v.config.textAttributes;for(S in q)if(I=q[S],I.tagName&&c(C,{matchingSelector:I.tagName,untilNode:this.containerElement}))N[S]=!0;else if(I.parser){if(W=I.parser(C)){for(T=!1,V=this.findBlockElementAncestors(C),_=0,F=V.length;F>_;_++)if(P=V[_],I.parser(P)===W){T=!0;break}T||(N[S]=W)}}else I.styleProperty&&(W=C.style[I.styleProperty])&&(N[S]=W);if(a(C)){U=D(C,"attributes");for(B in U)W=U[B],N[B]=W}return N},t.prototype.getBlockAttributes=function(C){var S,T,N,P;for(T=[];C&&C!==this.containerElement;){P=v.config.blockAttributes;for(S in P)N=P[S],N.parse!==!1&&r(C)===N.tagName&&(typeof N.test=="function"&&N.test(C)||!N.test)&&(T.push(S),N.listAttribute&&T.push(N.listAttribute));C=C.parentNode}return T.reverse()},t.prototype.findBlockElementAncestors=function(C){var S,T;for(S=[];C&&C!==this.containerElement;)T=r(C),u.call(s(),T)>=0&&S.push(C),C=C.parentNode;return S},D=function(C,S){try{return JSON.parse(C.getAttribute("data-trix-"+S))}catch{return{}}},d=function(C){var S,T,N;return N=C.getAttribute("width"),T=C.getAttribute("height"),S={},N&&(S.width=parseInt(N,10)),T&&(S.height=parseInt(T,10)),S},t.prototype.isBlockElement=function(C){var S;if((C!=null?C.nodeType:void 0)===Node.ELEMENT_NODE&&!a(C)&&!c(C,{matchingSelector:"td",untilNode:this.containerElement}))return S=r(C),u.call(s(),S)>=0||window.getComputedStyle(C).display==="block"},t.prototype.isInsignificantTextNode=function(C){var S,T,N;if((C!=null?C.nodeType:void 0)===Node.TEXT_NODE&&E(C.data)&&(T=C.parentNode,N=C.previousSibling,S=C.nextSibling,(!w(T.previousSibling)||this.isBlockElement(T.previousSibling))&&!p(T)))return!N||this.isBlockElement(N)||!S||this.isBlockElement(S)},t.prototype.isExtraBR=function(C){return r(C)==="br"&&this.isBlockElement(C.parentNode)&&C.parentNode.lastChild===C},p=function(C){var S;return S=window.getComputedStyle(C).whiteSpace,S==="pre"||S==="pre-wrap"||S==="pre-line"},w=function(C){return C&&!L(C.textContent)},t.prototype.translateBlockElementMarginsToNewlines=function(){var C,S,T,N,P,I,_;for(C=this.getMarginOfDefaultBlockElement(),I=this.blocks,_=[],T=S=0,N=I.length;N>S;T=++S)I[T],(P=this.getMarginOfBlockElementAtIndex(T))&&(P.top>2*C.top&&this.prependStringToTextAtIndex(`
`,T),_.push(P.bottom>2*C.bottom?this.appendStringToTextAtIndex(`
`,T):void 0));return _},t.prototype.getMarginOfBlockElementAtIndex=function(C){var S,T;return!(S=this.blockElements[C])||!S.textContent||(T=r(S),u.call(s(),T)>=0||u.call(this.processedElements,S)>=0)?void 0:g(S)},t.prototype.getMarginOfDefaultBlockElement=function(){var C;return C=e(v.config.blockAttributes.default.tagName),this.containerElement.appendChild(C),g(C)},g=function(C){var S;return S=window.getComputedStyle(C),S.display==="block"?{top:parseInt(S.marginTop),bottom:parseInt(S.marginBottom)}:void 0},A=function(C){return C.replace(RegExp("^"+b.source+"+"),"")},E=function(C){return RegExp("^"+b.source+"*$").test(C)},L=function(C){return/\s$/.test(C)},t}(v.BasicObject)}).call(this),(function(){var x,b,y,c,s=function(o,r){function l(){this.constructor=o}for(var n in r)e.call(r,n)&&(o[n]=r[n]);return l.prototype=r.prototype,o.prototype=new l,o.__super__=r.prototype,o},e={}.hasOwnProperty,a=[].slice,f=[].indexOf||function(o){for(var r=0,l=this.length;l>r;r++)if(r in this&&this[r]===o)return r;return-1};x=v.arraysAreEqual,y=v.normalizeRange,c=v.rangeIsCollapsed,b=v.getBlockConfig,v.Document=function(o){function r(n){n==null&&(n=[]),r.__super__.constructor.apply(this,arguments),n.length===0&&(n=[new v.Block]),this.blockList=v.SplittableList.box(n)}var l;return s(r,o),r.fromJSON=function(n){var h,u;return u=function(){var m,t,i;for(i=[],m=0,t=n.length;t>m;m++)h=n[m],i.push(v.Block.fromJSON(h));return i}(),new this(u)},r.fromHTML=function(n,h){return v.HTMLParser.parse(n,h).getDocument()},r.fromString=function(n,h){var u;return u=v.Text.textForStringWithAttributes(n,h),new this([new v.Block(u)])},r.prototype.isEmpty=function(){var n;return this.blockList.length===1&&(n=this.getBlockAtIndex(0),n.isEmpty()&&!n.hasAttributes())},r.prototype.copy=function(n){var h;return n==null&&(n={}),h=n.consolidateBlocks?this.blockList.consolidate().toArray():this.blockList.toArray(),new this.constructor(h)},r.prototype.copyUsingObjectsFromDocument=function(n){var h;return h=new v.ObjectMap(n.getObjects()),this.copyUsingObjectMap(h)},r.prototype.copyUsingObjectMap=function(n){var h,u,m;return u=(function(){var t,i,p,g;for(p=this.getBlocks(),g=[],t=0,i=p.length;i>t;t++)h=p[t],g.push((m=n.find(h))?m:h.copyUsingObjectMap(n));return g}).call(this),new this.constructor(u)},r.prototype.copyWithBaseBlockAttributes=function(n){var h,u,m;return n==null&&(n=[]),m=(function(){var t,i,p,g;for(p=this.getBlocks(),g=[],t=0,i=p.length;i>t;t++)u=p[t],h=n.concat(u.getAttributes()),g.push(u.copyWithAttributes(h));return g}).call(this),new this.constructor(m)},r.prototype.replaceBlock=function(n,h){var u;return u=this.blockList.indexOf(n),u===-1?this:new this.constructor(this.blockList.replaceObjectAtIndex(h,u))},r.prototype.insertDocumentAtRange=function(n,h){var u,m,t,i,p,g,d;return m=n.blockList,p=(h=y(h))[0],g=this.locationFromPosition(p),t=g.index,i=g.offset,d=this,u=this.getBlockAtPosition(p),c(h)&&u.isEmpty()&&!u.hasAttributes()?d=new this.constructor(d.blockList.removeObjectAtIndex(t)):u.getBlockBreakPosition()===i&&p++,d=d.removeTextAtRange(h),new this.constructor(d.blockList.insertSplittableListAtPosition(m,p))},r.prototype.mergeDocumentAtRange=function(n,h){var u,m,t,i,p,g,d,A,w,k,D,O;return D=(h=y(h))[0],k=this.locationFromPosition(D),m=this.getBlockAtIndex(k.index).getAttributes(),u=n.getBaseBlockAttributes(),O=m.slice(-u.length),x(u,O)?(d=m.slice(0,-u.length),g=n.copyWithBaseBlockAttributes(d)):g=n.copy({consolidateBlocks:!0}).copyWithBaseBlockAttributes(m),t=g.getBlockCount(),i=g.getBlockAtIndex(0),x(m,i.getAttributes())?(p=i.getTextWithoutBlockBreak(),w=this.insertTextAtRange(p,h),t>1&&(g=new this.constructor(g.getBlocks().slice(1)),A=D+p.getLength(),w=w.insertDocumentAtRange(g,A))):w=this.insertDocumentAtRange(g,h),w},r.prototype.insertTextAtRange=function(n,h){var u,m,t,i,p;return p=(h=y(h))[0],i=this.locationFromPosition(p),m=i.index,t=i.offset,u=this.removeTextAtRange(h),new this.constructor(u.blockList.editObjectAtIndex(m,function(g){return g.copyWithText(g.text.insertTextAtPosition(n,t))}))},r.prototype.removeTextAtRange=function(n){var h,u,m,t,i,p,g,d,A,w,k,D,O,R,L,E,C,S,T,N,P;return w=n=y(n),d=w[0],S=w[1],c(n)?this:(k=this.locationRangeFromRange(n),p=k[0],E=k[1],i=p.index,g=p.offset,t=this.getBlockAtIndex(i),L=E.index,C=E.offset,R=this.getBlockAtIndex(L),D=S-d===1&&t.getBlockBreakPosition()===g&&R.getBlockBreakPosition()!==C&&R.text.getStringAtPosition(C)===`
`,D?m=this.blockList.editObjectAtIndex(L,function(I){return I.copyWithText(I.text.removeTextAtRange([C,C+1]))}):(A=t.text.getTextAtRange([0,g]),T=R.text.getTextAtRange([C,R.getLength()]),N=A.appendText(T),O=i!==L&&g===0,P=O&&t.getAttributeLevel()>=R.getAttributeLevel(),u=P?R.copyWithText(N):t.copyWithText(N),h=L+1-i,m=this.blockList.splice(i,h,u)),new this.constructor(m))},r.prototype.moveTextFromRangeToPosition=function(n,h){var u,m,t,i,p,g,d,A,w,k;return g=n=y(n),w=g[0],t=g[1],h>=w&&t>=h?this:(m=this.getDocumentAtRange(n),A=this.removeTextAtRange(n),p=h>w,p&&(h-=m.getLength()),d=m.getBlocks(),i=d[0],u=2<=d.length?a.call(d,1):[],u.length===0?(k=i.getTextWithoutBlockBreak(),p&&(h+=1)):k=i.text,A=A.insertTextAtRange(k,h),u.length===0?A:(m=new this.constructor(u),h+=k.getLength(),A.insertDocumentAtRange(m,h)))},r.prototype.addAttributeAtRange=function(n,h,u){var m;return m=this.blockList,this.eachBlockAtRange(u,function(t,i,p){return m=m.editObjectAtIndex(p,function(){return b(n)?t.addAttribute(n,h):i[0]===i[1]?t:t.copyWithText(t.text.addAttributeAtRange(n,h,i))})}),new this.constructor(m)},r.prototype.addAttribute=function(n,h){var u;return u=this.blockList,this.eachBlock(function(m,t){return u=u.editObjectAtIndex(t,function(){return m.addAttribute(n,h)})}),new this.constructor(u)},r.prototype.removeAttributeAtRange=function(n,h){var u;return u=this.blockList,this.eachBlockAtRange(h,function(m,t,i){return b(n)?u=u.editObjectAtIndex(i,function(){return m.removeAttribute(n)}):t[0]!==t[1]?u=u.editObjectAtIndex(i,function(){return m.copyWithText(m.text.removeAttributeAtRange(n,t))}):void 0}),new this.constructor(u)},r.prototype.updateAttributesForAttachment=function(n,h){var u,m,t;return m=this.getRangeOfAttachment(h)[0],u=this.locationFromPosition(m).index,t=this.getTextAtIndex(u),new this.constructor(this.blockList.editObjectAtIndex(u,function(i){return i.copyWithText(t.updateAttributesForAttachment(n,h))}))},r.prototype.removeAttributeForAttachment=function(n,h){var u;return u=this.getRangeOfAttachment(h),this.removeAttributeAtRange(n,u)},r.prototype.insertBlockBreakAtRange=function(n){var h,u,m,t;return t=(n=y(n))[0],m=this.locationFromPosition(t).offset,u=this.removeTextAtRange(n),m===0&&(h=[new v.Block]),new this.constructor(u.blockList.insertSplittableListAtPosition(new v.SplittableList(h),t))},r.prototype.applyBlockAttributeAtRange=function(n,h,u){var m,t,i,p;return i=this.expandRangeToLineBreaksAndSplitBlocks(u),t=i.document,u=i.range,m=b(n),m.listAttribute?(t=t.removeLastListAttributeAtRange(u,{exceptAttributeName:n}),p=t.convertLineBreaksToBlockBreaksInRange(u),t=p.document,u=p.range):t=m.exclusive?t.removeBlockAttributesAtRange(u):m.terminal?t.removeLastTerminalAttributeAtRange(u):t.consolidateBlocksAtRange(u),t.addAttributeAtRange(n,h,u)},r.prototype.removeLastListAttributeAtRange=function(n,h){var u;return h==null&&(h={}),u=this.blockList,this.eachBlockAtRange(n,function(m,t,i){var p;if((p=m.getLastAttribute())&&b(p).listAttribute&&p!==h.exceptAttributeName)return u=u.editObjectAtIndex(i,function(){return m.removeAttribute(p)})}),new this.constructor(u)},r.prototype.removeLastTerminalAttributeAtRange=function(n){var h;return h=this.blockList,this.eachBlockAtRange(n,function(u,m,t){var i;if((i=u.getLastAttribute())&&b(i).terminal)return h=h.editObjectAtIndex(t,function(){return u.removeAttribute(i)})}),new this.constructor(h)},r.prototype.removeBlockAttributesAtRange=function(n){var h;return h=this.blockList,this.eachBlockAtRange(n,function(u,m,t){return u.hasAttributes()?h=h.editObjectAtIndex(t,function(){return u.copyWithoutAttributes()}):void 0}),new this.constructor(h)},r.prototype.expandRangeToLineBreaksAndSplitBlocks=function(n){var h,u,m,t,i,p,g,d,A;return p=n=y(n),A=p[0],t=p[1],d=this.locationFromPosition(A),m=this.locationFromPosition(t),h=this,g=h.getBlockAtIndex(d.index),(d.offset=g.findLineBreakInDirectionFromPosition("backward",d.offset))!=null&&(i=h.positionFromLocation(d),h=h.insertBlockBreakAtRange([i,i+1]),m.index+=1,m.offset-=h.getBlockAtIndex(d.index).getLength(),d.index+=1),d.offset=0,m.offset===0&&m.index>d.index?(m.index-=1,m.offset=h.getBlockAtIndex(m.index).getBlockBreakPosition()):(u=h.getBlockAtIndex(m.index),u.text.getStringAtRange([m.offset-1,m.offset])===`
`?m.offset-=1:m.offset=u.findLineBreakInDirectionFromPosition("forward",m.offset),m.offset!==u.getBlockBreakPosition()&&(i=h.positionFromLocation(m),h=h.insertBlockBreakAtRange([i,i+1]))),A=h.positionFromLocation(d),t=h.positionFromLocation(m),n=y([A,t]),{document:h,range:n}},r.prototype.convertLineBreaksToBlockBreaksInRange=function(n){var h,u,m;return u=(n=y(n))[0],m=this.getStringAtRange(n).slice(0,-1),h=this,m.replace(/.*?\n/g,function(t){return u+=t.length,h=h.insertBlockBreakAtRange([u-1,u])}),{document:h,range:n}},r.prototype.consolidateBlocksAtRange=function(n){var h,u,m,t,i;return m=n=y(n),i=m[0],u=m[1],t=this.locationFromPosition(i).index,h=this.locationFromPosition(u).index,new this.constructor(this.blockList.consolidateFromIndexToIndex(t,h))},r.prototype.getDocumentAtRange=function(n){var h;return n=y(n),h=this.blockList.getSplittableListInRange(n).toArray(),new this.constructor(h)},r.prototype.getStringAtRange=function(n){var h,u,m;return m=n=y(n),u=m[m.length-1],u!==this.getLength()&&(h=-1),this.getDocumentAtRange(n).toString().slice(0,h)},r.prototype.getBlockAtIndex=function(n){return this.blockList.getObjectAtIndex(n)},r.prototype.getBlockAtPosition=function(n){var h;return h=this.locationFromPosition(n).index,this.getBlockAtIndex(h)},r.prototype.getTextAtIndex=function(n){var h;return(h=this.getBlockAtIndex(n))!=null?h.text:void 0},r.prototype.getTextAtPosition=function(n){var h;return h=this.locationFromPosition(n).index,this.getTextAtIndex(h)},r.prototype.getPieceAtPosition=function(n){var h,u,m;return m=this.locationFromPosition(n),h=m.index,u=m.offset,this.getTextAtIndex(h).getPieceAtPosition(u)},r.prototype.getCharacterAtPosition=function(n){var h,u,m;return m=this.locationFromPosition(n),h=m.index,u=m.offset,this.getTextAtIndex(h).getStringAtRange([u,u+1])},r.prototype.getLength=function(){return this.blockList.getEndPosition()},r.prototype.getBlocks=function(){return this.blockList.toArray()},r.prototype.getBlockCount=function(){return this.blockList.length},r.prototype.getEditCount=function(){return this.editCount},r.prototype.eachBlock=function(n){return this.blockList.eachObject(n)},r.prototype.eachBlockAtRange=function(n,h){var u,m,t,i,p,g,d,A,w,k,D,O;if(g=n=y(n),D=g[0],t=g[1],k=this.locationFromPosition(D),m=this.locationFromPosition(t),k.index===m.index)return u=this.getBlockAtIndex(k.index),O=[k.offset,m.offset],h(u,O,k.index);for(w=[],p=i=d=k.index,A=m.index;A>=d?A>=i:i>=A;p=A>=d?++i:--i)(u=this.getBlockAtIndex(p))?(O=function(){switch(p){case k.index:return[k.offset,u.text.getLength()];case m.index:return[0,m.offset];default:return[0,u.text.getLength()]}}(),w.push(h(u,O,p))):w.push(void 0);return w},r.prototype.getCommonAttributesAtRange=function(n){var h,u,m;return u=(n=y(n))[0],c(n)?this.getCommonAttributesAtPosition(u):(m=[],h=[],this.eachBlockAtRange(n,function(t,i){return i[0]!==i[1]?(m.push(t.text.getCommonAttributesAtRange(i)),h.push(l(t))):void 0}),v.Hash.fromCommonAttributesOfObjects(m).merge(v.Hash.fromCommonAttributesOfObjects(h)).toObject())},r.prototype.getCommonAttributesAtPosition=function(n){var h,u,m,t,i,p,g,d,A,w;if(A=this.locationFromPosition(n),i=A.index,d=A.offset,m=this.getBlockAtIndex(i),!m)return{};t=l(m),h=m.text.getAttributesAtPosition(d),u=m.text.getAttributesAtPosition(d-1),p=function(){var k,D;k=v.config.textAttributes,D=[];for(g in k)w=k[g],w.inheritable&&D.push(g);return D}();for(g in u)w=u[g],(w===h[g]||f.call(p,g)>=0)&&(t[g]=w);return t},r.prototype.getRangeOfCommonAttributeAtPosition=function(n,h){var u,m,t,i,p,g,d,A,w;return p=this.locationFromPosition(h),t=p.index,i=p.offset,w=this.getTextAtIndex(t),g=w.getExpandedRangeForAttributeAtOffset(n,i),A=g[0],m=g[1],d=this.positionFromLocation({index:t,offset:A}),u=this.positionFromLocation({index:t,offset:m}),y([d,u])},r.prototype.getBaseBlockAttributes=function(){var n,h,u,m,t,i,p;for(n=this.getBlockAtIndex(0).getAttributes(),u=m=1,p=this.getBlockCount();p>=1?p>m:m>p;u=p>=1?++m:--m)h=this.getBlockAtIndex(u).getAttributes(),i=Math.min(n.length,h.length),n=function(){var g,d,A;for(A=[],t=g=0,d=i;(d>=0?d>g:g>d)&&h[t]===n[t];t=d>=0?++g:--g)A.push(h[t]);return A}();return n},l=function(n){var h,u;return u={},(h=n.getLastAttribute())&&(u[h]=!0),u},r.prototype.getAttachmentById=function(n){var h,u,m,t;for(t=this.getAttachments(),u=0,m=t.length;m>u;u++)if(h=t[u],h.id===n)return h},r.prototype.getAttachmentPieces=function(){var n;return n=[],this.blockList.eachObject(function(h){var u;return u=h.text,n=n.concat(u.getAttachmentPieces())}),n},r.prototype.getAttachments=function(){var n,h,u,m,t;for(m=this.getAttachmentPieces(),t=[],n=0,h=m.length;h>n;n++)u=m[n],t.push(u.attachment);return t},r.prototype.getRangeOfAttachment=function(n){var h,u,m,t,i,p,g;for(t=0,i=this.blockList.toArray(),u=h=0,m=i.length;m>h;u=++h){if(p=i[u].text,g=p.getRangeOfAttachment(n))return y([t+g[0],t+g[1]]);t+=p.getLength()}},r.prototype.getLocationRangeOfAttachment=function(n){var h;return h=this.getRangeOfAttachment(n),this.locationRangeFromRange(h)},r.prototype.getAttachmentPieceForAttachment=function(n){var h,u,m,t;for(t=this.getAttachmentPieces(),h=0,u=t.length;u>h;h++)if(m=t[h],m.attachment===n)return m},r.prototype.findRangesForBlockAttribute=function(n){var h,u,m,t,i,p,g;for(i=0,p=[],g=this.getBlocks(),u=0,m=g.length;m>u;u++)h=g[u],t=h.getLength(),h.hasAttribute(n)&&p.push([i,i+t]),i+=t;return p},r.prototype.findRangesForTextAttribute=function(n,h){var u,m,t,i,p,g,d,A,w,k;for(k=(h??{}).withValue,g=0,d=[],A=[],i=function(D){return k!=null?D.getAttribute(n)===k:D.hasAttribute(n)},w=this.getPieces(),u=0,m=w.length;m>u;u++)p=w[u],t=p.getLength(),i(p)&&(d[1]===g?d[1]=g+t:A.push(d=[g,g+t])),g+=t;return A},r.prototype.locationFromPosition=function(n){var h,u;return u=this.blockList.findIndexAndOffsetAtPosition(Math.max(0,n)),u.index!=null?u:(h=this.getBlocks(),{index:h.length-1,offset:h[h.length-1].getLength()})},r.prototype.positionFromLocation=function(n){return this.blockList.findPositionAtIndexAndOffset(n.index,n.offset)},r.prototype.locationRangeFromPosition=function(n){return y(this.locationFromPosition(n))},r.prototype.locationRangeFromRange=function(n){var h,u,m,t;if(n=y(n))return t=n[0],u=n[1],m=this.locationFromPosition(t),h=this.locationFromPosition(u),y([m,h])},r.prototype.rangeFromLocationRange=function(n){var h,u;return n=y(n),h=this.positionFromLocation(n[0]),c(n)||(u=this.positionFromLocation(n[1])),y([h,u])},r.prototype.isEqualTo=function(n){return this.blockList.isEqualTo(n!=null?n.blockList:void 0)},r.prototype.getTexts=function(){var n,h,u,m,t;for(m=this.getBlocks(),t=[],h=0,u=m.length;u>h;h++)n=m[h],t.push(n.text);return t},r.prototype.getPieces=function(){var n,h,u,m,t;for(u=[],m=this.getTexts(),n=0,h=m.length;h>n;n++)t=m[n],u.push.apply(u,t.getPieces());return u},r.prototype.getObjects=function(){return this.getBlocks().concat(this.getTexts()).concat(this.getPieces())},r.prototype.toSerializableDocument=function(){var n;return n=[],this.blockList.eachObject(function(h){return n.push(h.copyWithText(h.text.toSerializableText()))}),new this.constructor(n)},r.prototype.toString=function(){return this.blockList.toString()},r.prototype.toJSON=function(){return this.blockList.toJSON()},r.prototype.toConsole=function(){var n;return JSON.stringify((function(){var h,u,m,t;for(m=this.blockList.toArray(),t=[],h=0,u=m.length;u>h;h++)n=m[h],t.push(JSON.parse(n.text.toConsole()));return t}).call(this))},r}(v.Object)}).call(this),(function(){v.LineBreakInsertion=function(){function x(b){var y;this.composition=b,this.document=this.composition.document,y=this.composition.getSelectedRange(),this.startPosition=y[0],this.endPosition=y[1],this.startLocation=this.document.locationFromPosition(this.startPosition),this.endLocation=this.document.locationFromPosition(this.endPosition),this.block=this.document.getBlockAtIndex(this.endLocation.index),this.breaksOnReturn=this.block.breaksOnReturn(),this.previousCharacter=this.block.text.getStringAtPosition(this.endLocation.offset-1),this.nextCharacter=this.block.text.getStringAtPosition(this.endLocation.offset)}return x.prototype.shouldInsertBlockBreak=function(){return this.block.hasAttributes()&&this.block.isListItem()&&!this.block.isEmpty()?this.startLocation.offset!==0:this.breaksOnReturn&&this.nextCharacter!==`
`},x.prototype.shouldBreakFormattedBlock=function(){return this.block.hasAttributes()&&!this.block.isListItem()&&(this.breaksOnReturn&&this.nextCharacter===`
`||this.previousCharacter===`
`)},x.prototype.shouldDecreaseListLevel=function(){return this.block.hasAttributes()&&this.block.isListItem()&&this.block.isEmpty()},x.prototype.shouldPrependListItem=function(){return this.block.isListItem()&&this.startLocation.offset===0&&!this.block.isEmpty()},x.prototype.shouldRemoveLastBlockAttribute=function(){return this.block.hasAttributes()&&!this.block.isListItem()&&this.block.isEmpty()},x}()}).call(this),(function(){var x,b,y,c,s,e,a,f,o,r,l=function(h,u){function m(){this.constructor=h}for(var t in u)n.call(u,t)&&(h[t]=u[t]);return m.prototype=u.prototype,h.prototype=new m,h.__super__=u.prototype,h},n={}.hasOwnProperty;e=v.normalizeRange,o=v.rangesAreEqual,f=v.rangeIsCollapsed,a=v.objectsAreEqual,x=v.arrayStartsWith,r=v.summarizeArrayChange,y=v.getAllAttributeNames,c=v.getBlockConfig,s=v.getTextConfig,b=v.extend,v.Composition=function(h){function u(){this.document=new v.Document,this.attachments=[],this.currentAttributes={},this.revision=0}var m;return l(u,h),u.prototype.setDocument=function(t){var i;return t.isEqualTo(this.document)?void 0:(this.document=t,this.refreshAttachments(),this.revision++,(i=this.delegate)!=null&&typeof i.compositionDidChangeDocument=="function"?i.compositionDidChangeDocument(t):void 0)},u.prototype.getSnapshot=function(){return{document:this.document,selectedRange:this.getSelectedRange()}},u.prototype.loadSnapshot=function(t){var i,p,g,d;return i=t.document,d=t.selectedRange,(p=this.delegate)!=null&&typeof p.compositionWillLoadSnapshot=="function"&&p.compositionWillLoadSnapshot(),this.setDocument(i??new v.Document),this.setSelection(d??[0,0]),(g=this.delegate)!=null&&typeof g.compositionDidLoadSnapshot=="function"?g.compositionDidLoadSnapshot():void 0},u.prototype.insertText=function(t,i){var p,g,d,A;return A=(i??{updatePosition:!0}).updatePosition,g=this.getSelectedRange(),this.setDocument(this.document.insertTextAtRange(t,g)),d=g[0],p=d+t.getLength(),A&&this.setSelection(p),this.notifyDelegateOfInsertionAtRange([d,p])},u.prototype.insertBlock=function(t){var i;return t==null&&(t=new v.Block),i=new v.Document([t]),this.insertDocument(i)},u.prototype.insertDocument=function(t){var i,p,g;return t==null&&(t=new v.Document),p=this.getSelectedRange(),this.setDocument(this.document.insertDocumentAtRange(t,p)),g=p[0],i=g+t.getLength(),this.setSelection(i),this.notifyDelegateOfInsertionAtRange([g,i])},u.prototype.insertString=function(t,i){var p,g;return p=this.getCurrentTextAttributes(),g=v.Text.textForStringWithAttributes(t,p),this.insertText(g,i)},u.prototype.insertBlockBreak=function(){var t,i,p;return i=this.getSelectedRange(),this.setDocument(this.document.insertBlockBreakAtRange(i)),p=i[0],t=p+1,this.setSelection(t),this.notifyDelegateOfInsertionAtRange([p,t])},u.prototype.insertLineBreak=function(){var t,i;return i=new v.LineBreakInsertion(this),i.shouldDecreaseListLevel()?(this.decreaseListLevel(),this.setSelection(i.startPosition)):i.shouldPrependListItem()?(t=new v.Document([i.block.copyWithoutText()]),this.insertDocument(t)):i.shouldInsertBlockBreak()?this.insertBlockBreak():i.shouldRemoveLastBlockAttribute()?this.removeLastBlockAttribute():i.shouldBreakFormattedBlock()?this.breakFormattedBlock(i):this.insertString(`
`)},u.prototype.insertHTML=function(t){var i,p,g,d;return i=v.Document.fromHTML(t),g=this.getSelectedRange(),this.setDocument(this.document.mergeDocumentAtRange(i,g)),d=g[0],p=d+i.getLength()-1,this.setSelection(p),this.notifyDelegateOfInsertionAtRange([d,p])},u.prototype.replaceHTML=function(t){var i,p,g;return i=v.Document.fromHTML(t).copyUsingObjectsFromDocument(this.document),p=this.getLocationRange({strict:!1}),g=this.document.rangeFromLocationRange(p),this.setDocument(i),this.setSelection(g)},u.prototype.insertFile=function(t){return this.insertFiles([t])},u.prototype.insertFiles=function(t){var i,p,g,d,A,w;for(p=[],d=0,A=t.length;A>d;d++)g=t[d],(w=this.delegate)!=null&&w.compositionShouldAcceptFile(g)&&(i=v.Attachment.attachmentForFile(g),p.push(i));return this.insertAttachments(p)},u.prototype.insertAttachment=function(t){return this.insertAttachments([t])},u.prototype.insertAttachments=function(t){var i,p,g,d,A,w,k,D,O;for(D=new v.Text,d=0,A=t.length;A>d;d++)i=t[d],O=i.getType(),w=(k=v.config.attachments[O])!=null?k.presentation:void 0,g=this.getCurrentTextAttributes(),w&&(g.presentation=w),p=v.Text.textForAttachmentWithAttributes(i,g),D=D.appendText(p);return this.insertText(D)},u.prototype.shouldManageDeletingInDirection=function(t){var i;if(i=this.getLocationRange(),f(i)){if(t==="backward"&&i[0].offset===0||this.shouldManageMovingCursorInDirection(t))return!0}else if(i[0].index!==i[1].index)return!0;return!1},u.prototype.deleteInDirection=function(t,i){var p,g,d,A,w,k,D,O;return A=(i??{}).length,w=this.getLocationRange(),k=this.getSelectedRange(),D=f(k),D?d=t==="backward"&&w[0].offset===0:O=w[0].index!==w[1].index,d&&this.canDecreaseBlockAttributeLevel()&&(g=this.getBlock(),g.isListItem()?this.decreaseListLevel():this.decreaseBlockAttributeLevel(),this.setSelection(k[0]),g.isEmpty())?!1:(D&&(k=this.getExpandedRangeInDirection(t,{length:A}),t==="backward"&&(p=this.getAttachmentAtRange(k))),p?(this.editAttachment(p),!1):(this.setDocument(this.document.removeTextAtRange(k)),this.setSelection(k[0]),d||O?!1:void 0))},u.prototype.moveTextFromRange=function(t){var i;return i=this.getSelectedRange()[0],this.setDocument(this.document.moveTextFromRangeToPosition(t,i)),this.setSelection(i)},u.prototype.removeAttachment=function(t){var i;return(i=this.document.getRangeOfAttachment(t))?(this.stopEditingAttachment(),this.setDocument(this.document.removeTextAtRange(i)),this.setSelection(i[0])):void 0},u.prototype.removeLastBlockAttribute=function(){var t,i,p,g;return p=this.getSelectedRange(),g=p[0],i=p[1],t=this.document.getBlockAtPosition(i),this.removeCurrentAttribute(t.getLastAttribute()),this.setSelection(g)},m=" ",u.prototype.insertPlaceholder=function(){return this.placeholderPosition=this.getPosition(),this.insertString(m)},u.prototype.selectPlaceholder=function(){return this.placeholderPosition!=null?(this.setSelectedRange([this.placeholderPosition,this.placeholderPosition+m.length]),this.getSelectedRange()):void 0},u.prototype.forgetPlaceholder=function(){return this.placeholderPosition=null},u.prototype.hasCurrentAttribute=function(t){var i;return i=this.currentAttributes[t],i!=null&&i!==!1},u.prototype.toggleCurrentAttribute=function(t){var i;return(i=!this.currentAttributes[t])?this.setCurrentAttribute(t,i):this.removeCurrentAttribute(t)},u.prototype.canSetCurrentAttribute=function(t){return c(t)?this.canSetCurrentBlockAttribute(t):this.canSetCurrentTextAttribute(t)},u.prototype.canSetCurrentTextAttribute=function(){var t,i,p,g,d;if(i=this.getSelectedDocument()){for(d=i.getAttachments(),p=0,g=d.length;g>p;p++)if(t=d[p],!t.hasContent())return!1;return!0}},u.prototype.canSetCurrentBlockAttribute=function(){var t;if(t=this.getBlock())return!t.isTerminalBlock()},u.prototype.setCurrentAttribute=function(t,i){return c(t)?this.setBlockAttribute(t,i):(this.setTextAttribute(t,i),this.currentAttributes[t]=i,this.notifyDelegateOfCurrentAttributesChange())},u.prototype.setTextAttribute=function(t,i){var p,g,d,A;if(g=this.getSelectedRange())return d=g[0],p=g[1],d!==p?this.setDocument(this.document.addAttributeAtRange(t,i,g)):t==="href"?(A=v.Text.textForStringWithAttributes(i,{href:i}),this.insertText(A)):void 0},u.prototype.setBlockAttribute=function(t,i){var p;if(p=this.getSelectedRange())return this.canSetCurrentAttribute(t)?(this.getBlock(),this.setDocument(this.document.applyBlockAttributeAtRange(t,i,p)),this.setSelection(p)):void 0},u.prototype.removeCurrentAttribute=function(t){return c(t)?(this.removeBlockAttribute(t),this.updateCurrentAttributes()):(this.removeTextAttribute(t),delete this.currentAttributes[t],this.notifyDelegateOfCurrentAttributesChange())},u.prototype.removeTextAttribute=function(t){var i;if(i=this.getSelectedRange())return this.setDocument(this.document.removeAttributeAtRange(t,i))},u.prototype.removeBlockAttribute=function(t){var i;if(i=this.getSelectedRange())return this.setDocument(this.document.removeAttributeAtRange(t,i))},u.prototype.canDecreaseNestingLevel=function(){var t;return((t=this.getBlock())!=null?t.getNestingLevel():void 0)>0},u.prototype.canIncreaseNestingLevel=function(){var t,i,p;if(t=this.getBlock())return(p=c(t.getLastNestableAttribute()))!=null&&p.listAttribute?(i=this.getPreviousBlock())?x(i.getListItemAttributes(),t.getListItemAttributes()):void 0:t.getNestingLevel()>0},u.prototype.decreaseNestingLevel=function(){var t;if(t=this.getBlock())return this.setDocument(this.document.replaceBlock(t,t.decreaseNestingLevel()))},u.prototype.increaseNestingLevel=function(){var t;if(t=this.getBlock())return this.setDocument(this.document.replaceBlock(t,t.increaseNestingLevel()))},u.prototype.canDecreaseBlockAttributeLevel=function(){var t;return((t=this.getBlock())!=null?t.getAttributeLevel():void 0)>0},u.prototype.decreaseBlockAttributeLevel=function(){var t,i;return(t=(i=this.getBlock())!=null?i.getLastAttribute():void 0)?this.removeCurrentAttribute(t):void 0},u.prototype.decreaseListLevel=function(){var t,i,p,g,d,A;for(A=this.getSelectedRange()[0],d=this.document.locationFromPosition(A).index,p=d,t=this.getBlock().getAttributeLevel();(i=this.document.getBlockAtIndex(p+1))&&i.isListItem()&&i.getAttributeLevel()>t;)p++;return A=this.document.positionFromLocation({index:d,offset:0}),g=this.document.positionFromLocation({index:p,offset:0}),this.setDocument(this.document.removeLastListAttributeAtRange([A,g]))},u.prototype.updateCurrentAttributes=function(){var t,i,p,g,d,A;if(A=this.getSelectedRange({ignoreLock:!0})){for(i=this.document.getCommonAttributesAtRange(A),d=y(),p=0,g=d.length;g>p;p++)t=d[p],i[t]||this.canSetCurrentAttribute(t)||(i[t]=!1);if(!a(i,this.currentAttributes))return this.currentAttributes=i,this.notifyDelegateOfCurrentAttributesChange()}},u.prototype.getCurrentAttributes=function(){return b.call({},this.currentAttributes)},u.prototype.getCurrentTextAttributes=function(){var t,i,p,g;t={},p=this.currentAttributes;for(i in p)g=p[i],g!==!1&&s(i)&&(t[i]=g);return t},u.prototype.freezeSelection=function(){return this.setCurrentAttribute("frozen",!0)},u.prototype.thawSelection=function(){return this.removeCurrentAttribute("frozen")},u.prototype.hasFrozenSelection=function(){return this.hasCurrentAttribute("frozen")},u.proxyMethod("getSelectionManager().getPointRange"),u.proxyMethod("getSelectionManager().setLocationRangeFromPointRange"),u.proxyMethod("getSelectionManager().createLocationRangeFromDOMRange"),u.proxyMethod("getSelectionManager().locationIsCursorTarget"),u.proxyMethod("getSelectionManager().selectionIsExpanded"),u.proxyMethod("delegate?.getSelectionManager"),u.prototype.setSelection=function(t){var i,p;return i=this.document.locationRangeFromRange(t),(p=this.delegate)!=null?p.compositionDidRequestChangingSelectionToLocationRange(i):void 0},u.prototype.getSelectedRange=function(){var t;return(t=this.getLocationRange())?this.document.rangeFromLocationRange(t):void 0},u.prototype.setSelectedRange=function(t){var i;return i=this.document.locationRangeFromRange(t),this.getSelectionManager().setLocationRange(i)},u.prototype.getPosition=function(){var t;return(t=this.getLocationRange())?this.document.positionFromLocation(t[0]):void 0},u.prototype.getLocationRange=function(t){var i,p;return(i=(p=this.targetLocationRange)!=null?p:this.getSelectionManager().getLocationRange(t))!=null?i:e({index:0,offset:0})},u.prototype.withTargetLocationRange=function(t,i){var p;this.targetLocationRange=t;try{p=i()}finally{this.targetLocationRange=null}return p},u.prototype.withTargetRange=function(t,i){var p;return p=this.document.locationRangeFromRange(t),this.withTargetLocationRange(p,i)},u.prototype.withTargetDOMRange=function(t,i){var p;return p=this.createLocationRangeFromDOMRange(t,{strict:!1}),this.withTargetLocationRange(p,i)},u.prototype.getExpandedRangeInDirection=function(t,i){var p,g,d,A;return g=(i??{}).length,d=this.getSelectedRange(),A=d[0],p=d[1],t==="backward"?g?A-=g:A=this.translateUTF16PositionFromOffset(A,-1):g?p+=g:p=this.translateUTF16PositionFromOffset(p,1),e([A,p])},u.prototype.shouldManageMovingCursorInDirection=function(t){var i;return this.editingAttachment?!0:(i=this.getExpandedRangeInDirection(t),this.getAttachmentAtRange(i)!=null)},u.prototype.moveCursorInDirection=function(t){var i,p,g,d;return this.editingAttachment?g=this.document.getRangeOfAttachment(this.editingAttachment):(d=this.getSelectedRange(),g=this.getExpandedRangeInDirection(t),p=!o(d,g)),this.setSelectedRange(t==="backward"?g[0]:g[1]),p&&(i=this.getAttachmentAtRange(g))?this.editAttachment(i):void 0},u.prototype.expandSelectionInDirection=function(t,i){var p,g;return p=(i??{}).length,g=this.getExpandedRangeInDirection(t,{length:p}),this.setSelectedRange(g)},u.prototype.expandSelectionForEditing=function(){return this.hasCurrentAttribute("href")?this.expandSelectionAroundCommonAttribute("href"):void 0},u.prototype.expandSelectionAroundCommonAttribute=function(t){var i,p;return i=this.getPosition(),p=this.document.getRangeOfCommonAttributeAtPosition(t,i),this.setSelectedRange(p)},u.prototype.selectionContainsAttachments=function(){var t;return((t=this.getSelectedAttachments())!=null?t.length:void 0)>0},u.prototype.selectionIsInCursorTarget=function(){return this.editingAttachment||this.positionIsCursorTarget(this.getPosition())},u.prototype.positionIsCursorTarget=function(t){var i;return(i=this.document.locationFromPosition(t))?this.locationIsCursorTarget(i):void 0},u.prototype.positionIsBlockBreak=function(t){var i;return(i=this.document.getPieceAtPosition(t))!=null?i.isBlockBreak():void 0},u.prototype.getSelectedDocument=function(){var t;return(t=this.getSelectedRange())?this.document.getDocumentAtRange(t):void 0},u.prototype.getSelectedAttachments=function(){var t;return(t=this.getSelectedDocument())!=null?t.getAttachments():void 0},u.prototype.getAttachments=function(){return this.attachments.slice(0)},u.prototype.refreshAttachments=function(){var t,i,p,g,d,A,w,k,D,O,R,L;for(p=this.document.getAttachments(),k=r(this.attachments,p),t=k.added,R=k.removed,this.attachments=p,g=0,A=R.length;A>g;g++)i=R[g],i.delegate=null,(D=this.delegate)!=null&&typeof D.compositionDidRemoveAttachment=="function"&&D.compositionDidRemoveAttachment(i);for(L=[],d=0,w=t.length;w>d;d++)i=t[d],i.delegate=this,L.push((O=this.delegate)!=null&&typeof O.compositionDidAddAttachment=="function"?O.compositionDidAddAttachment(i):void 0);return L},u.prototype.attachmentDidChangeAttributes=function(t){var i;return this.revision++,(i=this.delegate)!=null&&typeof i.compositionDidEditAttachment=="function"?i.compositionDidEditAttachment(t):void 0},u.prototype.attachmentDidChangePreviewURL=function(t){var i;return this.revision++,(i=this.delegate)!=null&&typeof i.compositionDidChangeAttachmentPreviewURL=="function"?i.compositionDidChangeAttachmentPreviewURL(t):void 0},u.prototype.editAttachment=function(t,i){var p;if(t!==this.editingAttachment)return this.stopEditingAttachment(),this.editingAttachment=t,(p=this.delegate)!=null&&typeof p.compositionDidStartEditingAttachment=="function"?p.compositionDidStartEditingAttachment(this.editingAttachment,i):void 0},u.prototype.stopEditingAttachment=function(){var t;if(this.editingAttachment)return(t=this.delegate)!=null&&typeof t.compositionDidStopEditingAttachment=="function"&&t.compositionDidStopEditingAttachment(this.editingAttachment),this.editingAttachment=null},u.prototype.updateAttributesForAttachment=function(t,i){return this.setDocument(this.document.updateAttributesForAttachment(t,i))},u.prototype.removeAttributeForAttachment=function(t,i){return this.setDocument(this.document.removeAttributeForAttachment(t,i))},u.prototype.breakFormattedBlock=function(t){var i,p,g,d,A;return p=t.document,i=t.block,d=t.startPosition,A=[d-1,d],i.getBlockBreakPosition()===t.startLocation.offset?(i.breaksOnReturn()&&t.nextCharacter===`
`?d+=1:p=p.removeTextAtRange(A),A=[d,d]):t.nextCharacter===`
`?t.previousCharacter===`
`?A=[d-1,d+1]:(A=[d,d+1],d+=1):t.startLocation.offset-1!==0&&(d+=1),g=new v.Document([i.removeLastAttribute().copyWithoutText()]),this.setDocument(p.insertDocumentAtRange(g,A)),this.setSelection(d)},u.prototype.getPreviousBlock=function(){var t,i;return(i=this.getLocationRange())&&(t=i[0].index,t>0)?this.document.getBlockAtIndex(t-1):void 0},u.prototype.getBlock=function(){var t;return(t=this.getLocationRange())?this.document.getBlockAtIndex(t[0].index):void 0},u.prototype.getAttachmentAtRange=function(t){var i;return i=this.document.getDocumentAtRange(t),i.toString()===v.OBJECT_REPLACEMENT_CHARACTER+`
`?i.getAttachments()[0]:void 0},u.prototype.notifyDelegateOfCurrentAttributesChange=function(){var t;return(t=this.delegate)!=null&&typeof t.compositionDidChangeCurrentAttributes=="function"?t.compositionDidChangeCurrentAttributes(this.currentAttributes):void 0},u.prototype.notifyDelegateOfInsertionAtRange=function(t){var i;return(i=this.delegate)!=null&&typeof i.compositionDidPerformInsertionAtRange=="function"?i.compositionDidPerformInsertionAtRange(t):void 0},u.prototype.translateUTF16PositionFromOffset=function(t,i){var p,g;return g=this.document.toUTF16String(),p=g.offsetFromUCS2Offset(t),g.offsetToUCS2Offset(p+i)},u}(v.BasicObject)}).call(this),(function(){var x=function(y,c){function s(){this.constructor=y}for(var e in c)b.call(c,e)&&(y[e]=c[e]);return s.prototype=c.prototype,y.prototype=new s,y.__super__=c.prototype,y},b={}.hasOwnProperty;v.UndoManager=function(y){function c(e){this.composition=e,this.undoEntries=[],this.redoEntries=[]}var s;return x(c,y),c.prototype.recordUndoEntry=function(e,a){var f,o,r,l,n;return l=a??{},o=l.context,f=l.consolidatable,r=this.undoEntries.slice(-1)[0],f&&s(r,e,o)?void 0:(n=this.createEntry({description:e,context:o}),this.undoEntries.push(n),this.redoEntries=[])},c.prototype.undo=function(){var e,a;return(a=this.undoEntries.pop())?(e=this.createEntry(a),this.redoEntries.push(e),this.composition.loadSnapshot(a.snapshot)):void 0},c.prototype.redo=function(){var e,a;return(e=this.redoEntries.pop())?(a=this.createEntry(e),this.undoEntries.push(a),this.composition.loadSnapshot(e.snapshot)):void 0},c.prototype.canUndo=function(){return this.undoEntries.length>0},c.prototype.canRedo=function(){return this.redoEntries.length>0},c.prototype.createEntry=function(e){var a,f,o;return o=e??{},f=o.description,a=o.context,{description:f!=null?f.toString():void 0,context:JSON.stringify(a),snapshot:this.composition.getSnapshot()}},s=function(e,a,f){return(e!=null?e.description:void 0)===(a!=null?a.toString():void 0)&&(e!=null?e.context:void 0)===JSON.stringify(f)},c}(v.BasicObject)}).call(this),(function(){var x;v.attachmentGalleryFilter=function(b){var y;return y=new x(b),y.perform(),y.getSnapshot()},x=function(){function b(e){this.document=e.document,this.selectedRange=e.selectedRange}var y,c,s;return y="attachmentGallery",c="presentation",s="gallery",b.prototype.perform=function(){return this.removeBlockAttribute(),this.applyBlockAttribute()},b.prototype.getSnapshot=function(){return{document:this.document,selectedRange:this.selectedRange}},b.prototype.removeBlockAttribute=function(){var e,a,f,o,r;for(o=this.findRangesOfBlocks(),r=[],e=0,a=o.length;a>e;e++)f=o[e],r.push(this.document=this.document.removeAttributeAtRange(y,f));return r},b.prototype.applyBlockAttribute=function(){var e,a,f,o,r,l;for(f=0,r=this.findRangesOfPieces(),l=[],e=0,a=r.length;a>e;e++)o=r[e],o[1]-o[0]>1&&(o[0]+=f,o[1]+=f,this.document.getCharacterAtPosition(o[1])!==`
`&&(this.document=this.document.insertBlockBreakAtRange(o[1]),o[1]<this.selectedRange[1]&&this.moveSelectedRangeForward(),o[1]++,f++),o[0]!==0&&this.document.getCharacterAtPosition(o[0]-1)!==`
`&&(this.document=this.document.insertBlockBreakAtRange(o[0]),o[0]<this.selectedRange[0]&&this.moveSelectedRangeForward(),o[0]++,f++),l.push(this.document=this.document.applyBlockAttributeAtRange(y,!0,o)));return l},b.prototype.findRangesOfBlocks=function(){return this.document.findRangesForBlockAttribute(y)},b.prototype.findRangesOfPieces=function(){return this.document.findRangesForTextAttribute(c,{withValue:s})},b.prototype.moveSelectedRangeForward=function(){return this.selectedRange[0]+=1,this.selectedRange[1]+=1},b}()}).call(this),(function(){var x=function(b,y){return function(){return b.apply(y,arguments)}};v.Editor=function(){function b(c,s,e){this.composition=c,this.selectionManager=s,this.element=e,this.insertFiles=x(this.insertFiles,this),this.undoManager=new v.UndoManager(this.composition),this.filters=y.slice(0)}var y;return y=[v.attachmentGalleryFilter],b.prototype.loadDocument=function(c){return this.loadSnapshot({document:c,selectedRange:[0,0]})},b.prototype.loadHTML=function(c){return c==null&&(c=""),this.loadDocument(v.Document.fromHTML(c,{referenceElement:this.element}))},b.prototype.loadJSON=function(c){var s,e;return s=c.document,e=c.selectedRange,s=v.Document.fromJSON(s),this.loadSnapshot({document:s,selectedRange:e})},b.prototype.loadSnapshot=function(c){return this.undoManager=new v.UndoManager(this.composition),this.composition.loadSnapshot(c)},b.prototype.getDocument=function(){return this.composition.document},b.prototype.getSelectedDocument=function(){return this.composition.getSelectedDocument()},b.prototype.getSnapshot=function(){return this.composition.getSnapshot()},b.prototype.toJSON=function(){return this.getSnapshot()},b.prototype.deleteInDirection=function(c){return this.composition.deleteInDirection(c)},b.prototype.insertAttachment=function(c){return this.composition.insertAttachment(c)},b.prototype.insertAttachments=function(c){return this.composition.insertAttachments(c)},b.prototype.insertDocument=function(c){return this.composition.insertDocument(c)},b.prototype.insertFile=function(c){return this.composition.insertFile(c)},b.prototype.insertFiles=function(c){return this.composition.insertFiles(c)},b.prototype.insertHTML=function(c){return this.composition.insertHTML(c)},b.prototype.insertString=function(c){return this.composition.insertString(c)},b.prototype.insertText=function(c){return this.composition.insertText(c)},b.prototype.insertLineBreak=function(){return this.composition.insertLineBreak()},b.prototype.getSelectedRange=function(){return this.composition.getSelectedRange()},b.prototype.getPosition=function(){return this.composition.getPosition()},b.prototype.getClientRectAtPosition=function(c){var s;return s=this.getDocument().locationRangeFromRange([c,c+1]),this.selectionManager.getClientRectAtLocationRange(s)},b.prototype.expandSelectionInDirection=function(c){return this.composition.expandSelectionInDirection(c)},b.prototype.moveCursorInDirection=function(c){return this.composition.moveCursorInDirection(c)},b.prototype.setSelectedRange=function(c){return this.composition.setSelectedRange(c)},b.prototype.activateAttribute=function(c,s){return s==null&&(s=!0),this.composition.setCurrentAttribute(c,s)},b.prototype.attributeIsActive=function(c){return this.composition.hasCurrentAttribute(c)},b.prototype.canActivateAttribute=function(c){return this.composition.canSetCurrentAttribute(c)},b.prototype.deactivateAttribute=function(c){return this.composition.removeCurrentAttribute(c)},b.prototype.canDecreaseNestingLevel=function(){return this.composition.canDecreaseNestingLevel()},b.prototype.canIncreaseNestingLevel=function(){return this.composition.canIncreaseNestingLevel()},b.prototype.decreaseNestingLevel=function(){return this.canDecreaseNestingLevel()?this.composition.decreaseNestingLevel():void 0},b.prototype.increaseNestingLevel=function(){return this.canIncreaseNestingLevel()?this.composition.increaseNestingLevel():void 0},b.prototype.canRedo=function(){return this.undoManager.canRedo()},b.prototype.canUndo=function(){return this.undoManager.canUndo()},b.prototype.recordUndoEntry=function(c,s){var e,a,f;return f=s??{},a=f.context,e=f.consolidatable,this.undoManager.recordUndoEntry(c,{context:a,consolidatable:e})},b.prototype.redo=function(){return this.canRedo()?this.undoManager.redo():void 0},b.prototype.undo=function(){return this.canUndo()?this.undoManager.undo():void 0},b}()}).call(this),(function(){var x=function(y,c){function s(){this.constructor=y}for(var e in c)b.call(c,e)&&(y[e]=c[e]);return s.prototype=c.prototype,y.prototype=new s,y.__super__=c.prototype,y},b={}.hasOwnProperty;v.ManagedAttachment=function(y){function c(s,e){var a;this.attachmentManager=s,this.attachment=e,a=this.attachment,this.id=a.id,this.file=a.file}return x(c,y),c.prototype.remove=function(){return this.attachmentManager.requestRemovalOfAttachment(this.attachment)},c.proxyMethod("attachment.getAttribute"),c.proxyMethod("attachment.hasAttribute"),c.proxyMethod("attachment.setAttribute"),c.proxyMethod("attachment.getAttributes"),c.proxyMethod("attachment.setAttributes"),c.proxyMethod("attachment.isPending"),c.proxyMethod("attachment.isPreviewable"),c.proxyMethod("attachment.getURL"),c.proxyMethod("attachment.getHref"),c.proxyMethod("attachment.getFilename"),c.proxyMethod("attachment.getFilesize"),c.proxyMethod("attachment.getFormattedFilesize"),c.proxyMethod("attachment.getExtension"),c.proxyMethod("attachment.getContentType"),c.proxyMethod("attachment.getFile"),c.proxyMethod("attachment.setFile"),c.proxyMethod("attachment.releaseFile"),c.proxyMethod("attachment.getUploadProgress"),c.proxyMethod("attachment.setUploadProgress"),c}(v.BasicObject)}).call(this),(function(){var x=function(y,c){function s(){this.constructor=y}for(var e in c)b.call(c,e)&&(y[e]=c[e]);return s.prototype=c.prototype,y.prototype=new s,y.__super__=c.prototype,y},b={}.hasOwnProperty;v.AttachmentManager=function(y){function c(s){var e,a,f;for(s==null&&(s=[]),this.managedAttachments={},a=0,f=s.length;f>a;a++)e=s[a],this.manageAttachment(e)}return x(c,y),c.prototype.getAttachments=function(){var s,e,a,f;a=this.managedAttachments,f=[];for(e in a)s=a[e],f.push(s);return f},c.prototype.manageAttachment=function(s){var e,a;return(e=this.managedAttachments)[a=s.id]!=null?e[a]:e[a]=new v.ManagedAttachment(this,s)},c.prototype.attachmentIsManaged=function(s){return s.id in this.managedAttachments},c.prototype.requestRemovalOfAttachment=function(s){var e;return this.attachmentIsManaged(s)&&(e=this.delegate)!=null&&typeof e.attachmentManagerDidRequestRemovalOfAttachment=="function"?e.attachmentManagerDidRequestRemovalOfAttachment(s):void 0},c.prototype.unmanageAttachment=function(s){var e;return e=this.managedAttachments[s.id],delete this.managedAttachments[s.id],e},c}(v.BasicObject)}).call(this),(function(){var x,b,y,c,s,e,a,f,o,r,l;x=v.elementContainsNode,b=v.findChildIndexOfNode,s=v.nodeIsBlockStart,e=v.nodeIsBlockStartComment,c=v.nodeIsBlockContainer,a=v.nodeIsCursorTarget,f=v.nodeIsEmptyTextNode,o=v.nodeIsTextNode,y=v.nodeIsAttachmentElement,r=v.tagName,l=v.walkTree,v.LocationMapper=function(){function n(i){this.element=i}var h,u,m,t;return n.prototype.findLocationFromContainerAndOffset=function(i,p,g){var d,A,w,k,D,O,R;for(O=(g??{strict:!0}).strict,A=0,w=!1,k={index:0,offset:0},(d=this.findAttachmentElementParentForNode(i))&&(i=d.parentNode,p=b(d)),R=l(this.element,{usingFilter:m});R.nextNode();){if(D=R.currentNode,D===i&&o(i)){a(D)||(k.offset+=p);break}if(D.parentNode===i){if(A++===p)break}else if(!x(i,D)&&A>0)break;s(D,{strict:O})?(w&&k.index++,k.offset=0,w=!0):k.offset+=u(D)}return k},n.prototype.findContainerAndOffsetFromLocation=function(i){var p,g,d,A,w;if(i.index===0&&i.offset===0){for(p=this.element,A=0;p.firstChild;)if(p=p.firstChild,c(p)){A=1;break}return[p,A]}if(w=this.findNodeAndOffsetFromLocation(i),g=w[0],d=w[1],g){if(o(g))u(g)===0?(p=g.parentNode.parentNode,A=b(g.parentNode),a(g,{name:"right"})&&A++):(p=g,A=i.offset-d);else{if(p=g.parentNode,!s(g.previousSibling)&&!c(p))for(;g===p.lastChild&&(g=p,p=p.parentNode,!c(p)););A=b(g),i.offset!==0&&A++}return[p,A]}},n.prototype.findNodeAndOffsetFromLocation=function(i){var p,g,d,A,w,k,D,O;for(D=0,O=this.getSignificantNodesForIndex(i.index),g=0,d=O.length;d>g;g++){if(p=O[g],A=u(p),i.offset<=D+A)if(o(p)){if(w=p,k=D,i.offset===k&&a(w))break}else w||(w=p,k=D);if(D+=A,D>i.offset)break}return[w,k]},n.prototype.findAttachmentElementParentForNode=function(i){for(;i&&i!==this.element;){if(y(i))return i;i=i.parentNode}},n.prototype.getSignificantNodesForIndex=function(i){var p,g,d,A,w;for(d=[],w=l(this.element,{usingFilter:h}),A=!1;w.nextNode();)if(g=w.currentNode,e(g)){if(typeof p<"u"&&p!==null?p++:p=0,p===i)A=!0;else if(A)break}else A&&d.push(g);return d},u=function(i){var p;return i.nodeType===Node.TEXT_NODE?a(i)?0:(p=i.textContent,p.length):r(i)==="br"||y(i)?1:0},h=function(i){return t(i)===NodeFilter.FILTER_ACCEPT?m(i):NodeFilter.FILTER_REJECT},t=function(i){return f(i)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT},m=function(i){return y(i.parentNode)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT},n}()}).call(this),(function(){var x,b,y=[].slice;x=v.getDOMRange,b=v.setDOMRange,v.PointMapper=function(){function c(){}return c.prototype.createDOMRangeFromPoint=function(s){var e,a,f,o,r,l,n,h;if(n=s.x,h=s.y,document.caretPositionFromPoint)return r=document.caretPositionFromPoint(n,h),f=r.offsetNode,a=r.offset,e=document.createRange(),e.setStart(f,a),e;if(document.caretRangeFromPoint)return document.caretRangeFromPoint(n,h);if(document.body.createTextRange){o=x();try{l=document.body.createTextRange(),l.moveToPoint(n,h),l.select()}catch{}return e=x(),b(o),e}},c.prototype.getClientRectsForDOMRange=function(s){var e,a,f;return a=y.call(s.getClientRects()),f=a[0],e=a[a.length-1],[f,e]},c}()}).call(this),(function(){var x,b=function(e,a){return function(){return e.apply(a,arguments)}},y=function(e,a){function f(){this.constructor=e}for(var o in a)c.call(a,o)&&(e[o]=a[o]);return f.prototype=a.prototype,e.prototype=new f,e.__super__=a.prototype,e},c={}.hasOwnProperty,s=[].indexOf||function(e){for(var a=0,f=this.length;f>a;a++)if(a in this&&this[a]===e)return a;return-1};x=v.getDOMRange,v.SelectionChangeObserver=function(e){function a(){this.run=b(this.run,this),this.update=b(this.update,this),this.selectionManagers=[]}var f;return y(a,e),a.prototype.start=function(){return this.started?void 0:(this.started=!0,"onselectionchange"in document?document.addEventListener("selectionchange",this.update,!0):this.run())},a.prototype.stop=function(){return this.started?(this.started=!1,document.removeEventListener("selectionchange",this.update,!0)):void 0},a.prototype.registerSelectionManager=function(o){return s.call(this.selectionManagers,o)<0?(this.selectionManagers.push(o),this.start()):void 0},a.prototype.unregisterSelectionManager=function(o){var r;return this.selectionManagers=(function(){var l,n,h,u;for(h=this.selectionManagers,u=[],l=0,n=h.length;n>l;l++)r=h[l],r!==o&&u.push(r);return u}).call(this),this.selectionManagers.length===0?this.stop():void 0},a.prototype.notifySelectionManagersOfSelectionChange=function(){var o,r,l,n,h;for(l=this.selectionManagers,n=[],o=0,r=l.length;r>o;o++)h=l[o],n.push(h.selectionDidChange());return n},a.prototype.update=function(){var o;return o=x(),f(o,this.domRange)?void 0:(this.domRange=o,this.notifySelectionManagersOfSelectionChange())},a.prototype.reset=function(){return this.domRange=null,this.update()},a.prototype.run=function(){return this.started?(this.update(),requestAnimationFrame(this.run)):void 0},f=function(o,r){return(o!=null?o.startContainer:void 0)===(r!=null?r.startContainer:void 0)&&(o!=null?o.startOffset:void 0)===(r!=null?r.startOffset:void 0)&&(o!=null?o.endContainer:void 0)===(r!=null?r.endContainer:void 0)&&(o!=null?o.endOffset:void 0)===(r!=null?r.endOffset:void 0)},a}(v.BasicObject),v.selectionChangeObserver==null&&(v.selectionChangeObserver=new v.SelectionChangeObserver)}).call(this),(function(){var x,b,y,c,s,e,a,f,o,r,l=function(u,m){return function(){return u.apply(m,arguments)}},n=function(u,m){function t(){this.constructor=u}for(var i in m)h.call(m,i)&&(u[i]=m[i]);return t.prototype=m.prototype,u.prototype=new t,u.__super__=m.prototype,u},h={}.hasOwnProperty;y=v.getDOMSelection,b=v.getDOMRange,r=v.setDOMRange,x=v.elementContainsNode,e=v.nodeIsCursorTarget,s=v.innerElementIsActive,c=v.handleEvent,a=v.normalizeRange,f=v.rangeIsCollapsed,o=v.rangesAreEqual,v.SelectionManager=function(u){function m(t){this.element=t,this.selectionDidChange=l(this.selectionDidChange,this),this.didMouseDown=l(this.didMouseDown,this),this.locationMapper=new v.LocationMapper(this.element),this.pointMapper=new v.PointMapper,this.lockCount=0,c("mousedown",{onElement:this.element,withCallback:this.didMouseDown})}return n(m,u),m.prototype.getLocationRange=function(t){var i;return t==null&&(t={}),t.strict===!1?this.createLocationRangeFromDOMRange(b(),{strict:!1}):t.ignoreLock?this.currentLocationRange:(i=this.lockedLocationRange)!=null?i:this.currentLocationRange},m.prototype.setLocationRange=function(t){var i;if(!this.lockedLocationRange)return t=a(t),(i=this.createDOMRangeFromLocationRange(t))?(r(i),this.updateCurrentLocationRange(t)):void 0},m.prototype.setLocationRangeFromPointRange=function(t){var i,p;return t=a(t),p=this.getLocationAtPoint(t[0]),i=this.getLocationAtPoint(t[1]),this.setLocationRange([p,i])},m.prototype.getClientRectAtLocationRange=function(t){var i;return(i=this.createDOMRangeFromLocationRange(t))?this.getClientRectsForDOMRange(i)[1]:void 0},m.prototype.locationIsCursorTarget=function(t){var i,p;return p=this.findNodeAndOffsetFromLocation(t),i=p[0],p[1],e(i)},m.prototype.lock=function(){return this.lockCount++===0?(this.updateCurrentLocationRange(),this.lockedLocationRange=this.getLocationRange()):void 0},m.prototype.unlock=function(){var t;return--this.lockCount===0&&(t=this.lockedLocationRange,this.lockedLocationRange=null,t!=null)?this.setLocationRange(t):void 0},m.prototype.clearSelection=function(){var t;return(t=y())!=null?t.removeAllRanges():void 0},m.prototype.selectionIsCollapsed=function(){var t;return((t=b())!=null?t.collapsed:void 0)===!0},m.prototype.selectionIsExpanded=function(){return!this.selectionIsCollapsed()},m.prototype.createLocationRangeFromDOMRange=function(t,i){var p,g;if(t!=null&&this.domRangeWithinElement(t)&&(g=this.findLocationFromContainerAndOffset(t.startContainer,t.startOffset,i)))return t.collapsed||(p=this.findLocationFromContainerAndOffset(t.endContainer,t.endOffset,i)),a([g,p])},m.proxyMethod("locationMapper.findLocationFromContainerAndOffset"),m.proxyMethod("locationMapper.findContainerAndOffsetFromLocation"),m.proxyMethod("locationMapper.findNodeAndOffsetFromLocation"),m.proxyMethod("pointMapper.createDOMRangeFromPoint"),m.proxyMethod("pointMapper.getClientRectsForDOMRange"),m.prototype.didMouseDown=function(){return this.pauseTemporarily()},m.prototype.pauseTemporarily=function(){var t,i,p,g;return this.paused=!0,i=function(d){return function(){var A,w,k;for(d.paused=!1,clearTimeout(g),w=0,k=p.length;k>w;w++)A=p[w],A.destroy();return x(document,d.element)?d.selectionDidChange():void 0}}(this),g=setTimeout(i,200),p=function(){var d,A,w,k;for(w=["mousemove","keydown"],k=[],d=0,A=w.length;A>d;d++)t=w[d],k.push(c(t,{onElement:document,withCallback:i}));return k}()},m.prototype.selectionDidChange=function(){return this.paused||s(this.element)?void 0:this.updateCurrentLocationRange()},m.prototype.updateCurrentLocationRange=function(t){var i;return(t??(t=this.createLocationRangeFromDOMRange(b())))&&!o(t,this.currentLocationRange)?(this.currentLocationRange=t,(i=this.delegate)!=null&&typeof i.locationRangeDidChange=="function"?i.locationRangeDidChange(this.currentLocationRange.slice(0)):void 0):void 0},m.prototype.createDOMRangeFromLocationRange=function(t){var i,p,g,d;return g=this.findContainerAndOffsetFromLocation(t[0]),p=f(t)?g:(d=this.findContainerAndOffsetFromLocation(t[1]))!=null?d:g,g!=null&&p!=null?(i=document.createRange(),i.setStart.apply(i,g),i.setEnd.apply(i,p),i):void 0},m.prototype.getLocationAtPoint=function(t){var i,p;return(i=this.createDOMRangeFromPoint(t))&&(p=this.createLocationRangeFromDOMRange(i))!=null?p[0]:void 0},m.prototype.domRangeWithinElement=function(t){return t.collapsed?x(this.element,t.startContainer):x(this.element,t.startContainer)&&x(this.element,t.endContainer)},m}(v.BasicObject)}).call(this),(function(){var x,b,y,c,s=function(f,o){function r(){this.constructor=f}for(var l in o)e.call(o,l)&&(f[l]=o[l]);return r.prototype=o.prototype,f.prototype=new r,f.__super__=o.prototype,f},e={}.hasOwnProperty,a=[].slice;y=v.rangeIsCollapsed,c=v.rangesAreEqual,b=v.objectsAreEqual,x=v.getBlockConfig,v.EditorController=function(f){function o(l){var n,h;this.editorElement=l.editorElement,n=l.document,h=l.html,this.selectionManager=new v.SelectionManager(this.editorElement),this.selectionManager.delegate=this,this.composition=new v.Composition,this.composition.delegate=this,this.attachmentManager=new v.AttachmentManager(this.composition.getAttachments()),this.attachmentManager.delegate=this,this.inputController=new v["Level"+v.config.input.getLevel()+"InputController"](this.editorElement),this.inputController.delegate=this,this.inputController.responder=this.composition,this.compositionController=new v.CompositionController(this.editorElement,this.composition),this.compositionController.delegate=this,this.toolbarController=new v.ToolbarController(this.editorElement.toolbarElement),this.toolbarController.delegate=this,this.editor=new v.Editor(this.composition,this.selectionManager,this.editorElement),n!=null?this.editor.loadDocument(n):this.editor.loadHTML(h)}var r;return s(o,f),o.prototype.registerSelectionManager=function(){return v.selectionChangeObserver.registerSelectionManager(this.selectionManager)},o.prototype.unregisterSelectionManager=function(){return v.selectionChangeObserver.unregisterSelectionManager(this.selectionManager)},o.prototype.render=function(){return this.compositionController.render()},o.prototype.reparse=function(){return this.composition.replaceHTML(this.editorElement.innerHTML)},o.prototype.compositionDidChangeDocument=function(){return this.notifyEditorElement("document-change"),this.handlingInput?void 0:this.render()},o.prototype.compositionDidChangeCurrentAttributes=function(l){return this.currentAttributes=l,this.toolbarController.updateAttributes(this.currentAttributes),this.updateCurrentActions(),this.notifyEditorElement("attributes-change",{attributes:this.currentAttributes})},o.prototype.compositionDidPerformInsertionAtRange=function(l){return this.pasting?this.pastedRange=l:void 0},o.prototype.compositionShouldAcceptFile=function(l){return this.notifyEditorElement("file-accept",{file:l})},o.prototype.compositionDidAddAttachment=function(l){var n;return n=this.attachmentManager.manageAttachment(l),this.notifyEditorElement("attachment-add",{attachment:n})},o.prototype.compositionDidEditAttachment=function(l){var n;return this.compositionController.rerenderViewForObject(l),n=this.attachmentManager.manageAttachment(l),this.notifyEditorElement("attachment-edit",{attachment:n}),this.notifyEditorElement("change")},o.prototype.compositionDidChangeAttachmentPreviewURL=function(l){return this.compositionController.invalidateViewForObject(l),this.notifyEditorElement("change")},o.prototype.compositionDidRemoveAttachment=function(l){var n;return n=this.attachmentManager.unmanageAttachment(l),this.notifyEditorElement("attachment-remove",{attachment:n})},o.prototype.compositionDidStartEditingAttachment=function(l,n){return this.attachmentLocationRange=this.composition.document.getLocationRangeOfAttachment(l),this.compositionController.installAttachmentEditorForAttachment(l,n),this.selectionManager.setLocationRange(this.attachmentLocationRange)},o.prototype.compositionDidStopEditingAttachment=function(){return this.compositionController.uninstallAttachmentEditor(),this.attachmentLocationRange=null},o.prototype.compositionDidRequestChangingSelectionToLocationRange=function(l){return!this.loadingSnapshot||this.isFocused()?(this.requestedLocationRange=l,this.compositionRevisionWhenLocationRangeRequested=this.composition.revision,this.handlingInput?void 0:this.render()):void 0},o.prototype.compositionWillLoadSnapshot=function(){return this.loadingSnapshot=!0},o.prototype.compositionDidLoadSnapshot=function(){return this.compositionController.refreshViewCache(),this.render(),this.loadingSnapshot=!1},o.prototype.getSelectionManager=function(){return this.selectionManager},o.proxyMethod("getSelectionManager().setLocationRange"),o.proxyMethod("getSelectionManager().getLocationRange"),o.prototype.attachmentManagerDidRequestRemovalOfAttachment=function(l){return this.removeAttachment(l)},o.prototype.compositionControllerWillSyncDocumentView=function(){return this.inputController.editorWillSyncDocumentView(),this.selectionManager.lock(),this.selectionManager.clearSelection()},o.prototype.compositionControllerDidSyncDocumentView=function(){return this.inputController.editorDidSyncDocumentView(),this.selectionManager.unlock(),this.updateCurrentActions(),this.notifyEditorElement("sync")},o.prototype.compositionControllerDidRender=function(){return this.requestedLocationRange!=null&&(this.compositionRevisionWhenLocationRangeRequested===this.composition.revision&&this.selectionManager.setLocationRange(this.requestedLocationRange),this.requestedLocationRange=null,this.compositionRevisionWhenLocationRangeRequested=null),this.renderedCompositionRevision!==this.composition.revision&&(this.runEditorFilters(),this.composition.updateCurrentAttributes(),this.notifyEditorElement("render")),this.renderedCompositionRevision=this.composition.revision},o.prototype.compositionControllerDidFocus=function(){return this.isFocusedInvisibly()&&this.setLocationRange({index:0,offset:0}),this.toolbarController.hideDialog(),this.notifyEditorElement("focus")},o.prototype.compositionControllerDidBlur=function(){return this.notifyEditorElement("blur")},o.prototype.compositionControllerDidSelectAttachment=function(l,n){return this.toolbarController.hideDialog(),this.composition.editAttachment(l,n)},o.prototype.compositionControllerDidRequestDeselectingAttachment=function(l){var n,h;return n=(h=this.attachmentLocationRange)!=null?h:this.composition.document.getLocationRangeOfAttachment(l),this.selectionManager.setLocationRange(n[1])},o.prototype.compositionControllerWillUpdateAttachment=function(l){return this.editor.recordUndoEntry("Edit Attachment",{context:l.id,consolidatable:!0})},o.prototype.compositionControllerDidRequestRemovalOfAttachment=function(l){return this.removeAttachment(l)},o.prototype.inputControllerWillHandleInput=function(){return this.handlingInput=!0,this.requestedRender=!1},o.prototype.inputControllerDidRequestRender=function(){return this.requestedRender=!0},o.prototype.inputControllerDidHandleInput=function(){return this.handlingInput=!1,this.requestedRender?(this.requestedRender=!1,this.render()):void 0},o.prototype.inputControllerDidAllowUnhandledInput=function(){return this.notifyEditorElement("change")},o.prototype.inputControllerDidRequestReparse=function(){return this.reparse()},o.prototype.inputControllerWillPerformTyping=function(){return this.recordTypingUndoEntry()},o.prototype.inputControllerWillPerformFormatting=function(l){return this.recordFormattingUndoEntry(l)},o.prototype.inputControllerWillCutText=function(){return this.editor.recordUndoEntry("Cut")},o.prototype.inputControllerWillPaste=function(l){return this.editor.recordUndoEntry("Paste"),this.pasting=!0,this.notifyEditorElement("before-paste",{paste:l})},o.prototype.inputControllerDidPaste=function(l){return l.range=this.pastedRange,this.pastedRange=null,this.pasting=null,this.notifyEditorElement("paste",{paste:l})},o.prototype.inputControllerWillMoveText=function(){return this.editor.recordUndoEntry("Move")},o.prototype.inputControllerWillAttachFiles=function(){return this.editor.recordUndoEntry("Drop Files")},o.prototype.inputControllerWillPerformUndo=function(){return this.editor.undo()},o.prototype.inputControllerWillPerformRedo=function(){return this.editor.redo()},o.prototype.inputControllerDidReceiveKeyboardCommand=function(l){return this.toolbarController.applyKeyboardCommand(l)},o.prototype.inputControllerDidStartDrag=function(){return this.locationRangeBeforeDrag=this.selectionManager.getLocationRange()},o.prototype.inputControllerDidReceiveDragOverPoint=function(l){return this.selectionManager.setLocationRangeFromPointRange(l)},o.prototype.inputControllerDidCancelDrag=function(){return this.selectionManager.setLocationRange(this.locationRangeBeforeDrag),this.locationRangeBeforeDrag=null},o.prototype.locationRangeDidChange=function(l){return this.composition.updateCurrentAttributes(),this.updateCurrentActions(),this.attachmentLocationRange&&!c(this.attachmentLocationRange,l)&&this.composition.stopEditingAttachment(),this.notifyEditorElement("selection-change")},o.prototype.toolbarDidClickButton=function(){return this.getLocationRange()?void 0:this.setLocationRange({index:0,offset:0})},o.prototype.toolbarDidInvokeAction=function(l){return this.invokeAction(l)},o.prototype.toolbarDidToggleAttribute=function(l){return this.recordFormattingUndoEntry(l),this.composition.toggleCurrentAttribute(l),this.render(),this.selectionFrozen?void 0:this.editorElement.focus()},o.prototype.toolbarDidUpdateAttribute=function(l,n){return this.recordFormattingUndoEntry(l),this.composition.setCurrentAttribute(l,n),this.render(),this.selectionFrozen?void 0:this.editorElement.focus()},o.prototype.toolbarDidRemoveAttribute=function(l){return this.recordFormattingUndoEntry(l),this.composition.removeCurrentAttribute(l),this.render(),this.selectionFrozen?void 0:this.editorElement.focus()},o.prototype.toolbarWillShowDialog=function(){return this.composition.expandSelectionForEditing(),this.freezeSelection()},o.prototype.toolbarDidShowDialog=function(l){return this.notifyEditorElement("toolbar-dialog-show",{dialogName:l})},o.prototype.toolbarDidHideDialog=function(l){return this.thawSelection(),this.editorElement.focus(),this.notifyEditorElement("toolbar-dialog-hide",{dialogName:l})},o.prototype.freezeSelection=function(){return this.selectionFrozen?void 0:(this.selectionManager.lock(),this.composition.freezeSelection(),this.selectionFrozen=!0,this.render())},o.prototype.thawSelection=function(){return this.selectionFrozen?(this.composition.thawSelection(),this.selectionManager.unlock(),this.selectionFrozen=!1,this.render()):void 0},o.prototype.actions={undo:{test:function(){return this.editor.canUndo()},perform:function(){return this.editor.undo()}},redo:{test:function(){return this.editor.canRedo()},perform:function(){return this.editor.redo()}},link:{test:function(){return this.editor.canActivateAttribute("href")}},increaseNestingLevel:{test:function(){return this.editor.canIncreaseNestingLevel()},perform:function(){return this.editor.increaseNestingLevel()&&this.render()}},decreaseNestingLevel:{test:function(){return this.editor.canDecreaseNestingLevel()},perform:function(){return this.editor.decreaseNestingLevel()&&this.render()}},attachFiles:{test:function(){return!0},perform:function(){return v.config.input.pickFiles(this.editor.insertFiles)}}},o.prototype.canInvokeAction=function(l){var n,h;return this.actionIsExternal(l)?!0:!!((n=this.actions[l])!=null&&(h=n.test)!=null&&h.call(this))},o.prototype.invokeAction=function(l){var n,h;return this.actionIsExternal(l)?this.notifyEditorElement("action-invoke",{actionName:l}):(n=this.actions[l])!=null&&(h=n.perform)!=null?h.call(this):void 0},o.prototype.actionIsExternal=function(l){return/^x-./.test(l)},o.prototype.getCurrentActions=function(){var l,n;n={};for(l in this.actions)n[l]=this.canInvokeAction(l);return n},o.prototype.updateCurrentActions=function(){var l;return l=this.getCurrentActions(),b(l,this.currentActions)?void 0:(this.currentActions=l,this.toolbarController.updateActions(this.currentActions),this.notifyEditorElement("actions-change",{actions:this.currentActions}))},o.prototype.runEditorFilters=function(){var l,n,h,u,m,t,i,p;for(p=this.composition.getSnapshot(),m=this.editor.filters,h=0,u=m.length;u>h;h++)n=m[h],l=p.document,i=p.selectedRange,p=(t=n.call(this.editor,p))!=null?t:{},p.document==null&&(p.document=l),p.selectedRange==null&&(p.selectedRange=i);return r(p,this.composition.getSnapshot())?void 0:this.composition.loadSnapshot(p)},r=function(l,n){return c(l.selectedRange,n.selectedRange)&&l.document.isEqualTo(n.document)},o.prototype.updateInputElement=function(){var l,n;return l=this.compositionController.getSerializableElement(),n=v.serializeToContentType(l,"text/html"),this.editorElement.setInputElementValue(n)},o.prototype.notifyEditorElement=function(l,n){switch(l){case"document-change":this.documentChangedSinceLastRender=!0;break;case"render":this.documentChangedSinceLastRender&&(this.documentChangedSinceLastRender=!1,this.notifyEditorElement("change"));break;case"change":case"attachment-add":case"attachment-edit":case"attachment-remove":this.updateInputElement()}return this.editorElement.notify(l,n)},o.prototype.removeAttachment=function(l){return this.editor.recordUndoEntry("Delete Attachment"),this.composition.removeAttachment(l),this.render()},o.prototype.recordFormattingUndoEntry=function(l){var n,h;return n=x(l),h=this.selectionManager.getLocationRange(),n||!y(h)?this.editor.recordUndoEntry("Formatting",{context:this.getUndoContext(),consolidatable:!0}):void 0},o.prototype.recordTypingUndoEntry=function(){return this.editor.recordUndoEntry("Typing",{context:this.getUndoContext(this.currentAttributes),consolidatable:!0})},o.prototype.getUndoContext=function(){var l;return l=1<=arguments.length?a.call(arguments,0):[],[this.getLocationContext(),this.getTimeContext()].concat(a.call(l))},o.prototype.getLocationContext=function(){var l;return l=this.selectionManager.getLocationRange(),y(l)?l[0].index:l},o.prototype.getTimeContext=function(){return v.config.undoInterval>0?Math.floor(new Date().getTime()/v.config.undoInterval):0},o.prototype.isFocused=function(){var l;return this.editorElement===((l=this.editorElement.ownerDocument)!=null?l.activeElement:void 0)},o.prototype.isFocusedInvisibly=function(){return this.isFocused()&&!this.getLocationRange()},o}(v.Controller)}).call(this),(function(){var x,b,y,c,s,e,a,f=[].indexOf||function(o){for(var r=0,l=this.length;l>r;r++)if(r in this&&this[r]===o)return r;return-1};b=v.browser,e=v.makeElement,a=v.triggerEvent,c=v.handleEvent,s=v.handleEventOnce,y=v.findClosestElementFromNode,x=v.AttachmentView.attachmentSelector,v.registerElement("trix-editor",function(){var o,r,l,n,h,u,m,t,i;return m=0,r=function(p){return!document.querySelector(":focus")&&p.hasAttribute("autofocus")&&document.querySelector("[autofocus]")===p?p.focus():void 0},t=function(p){return p.hasAttribute("contenteditable")?void 0:(p.setAttribute("contenteditable",""),s("focus",{onElement:p,withCallback:function(){return l(p)}}))},l=function(p){return h(p),i(p)},h=function(p){return typeof document.queryCommandSupported=="function"&&document.queryCommandSupported("enableObjectResizing")?(document.execCommand("enableObjectResizing",!1,!1),c("mscontrolselect",{onElement:p,preventDefault:!0})):void 0},i=function(){var p;return typeof document.queryCommandSupported=="function"&&document.queryCommandSupported("DefaultParagraphSeparator")&&(p=v.config.blockAttributes.default.tagName,p==="div"||p==="p")?document.execCommand("DefaultParagraphSeparator",!1,p):void 0},o=function(p){return p.hasAttribute("role")?void 0:p.setAttribute("role","textbox")},u=function(p){var g;if(!p.hasAttribute("aria-label")&&!p.hasAttribute("aria-labelledby"))return(g=function(){var d,A,w;return w=function(){var k,D,O,R;for(O=p.labels,R=[],k=0,D=O.length;D>k;k++)d=O[k],d.contains(p)||R.push(d.textContent);return R}(),(A=w.join(" "))?p.setAttribute("aria-label",A):p.removeAttribute("aria-label")})(),c("focus",{onElement:p,withCallback:g})},n=function(){return b.forcesObjectResizing?{display:"inline",width:"auto"}:{display:"inline-block",width:"1px"}}(),{defaultCSS:`%t {
  display: block;
}

%t:empty:not(:focus)::before {
  content: attr(placeholder);
  color: graytext;
  cursor: text;
  pointer-events: none;
}

%t a[contenteditable=false] {
  cursor: text;
}

%t img {
  max-width: 100%;
  height: auto;
}

%t `+x+` figcaption textarea {
  resize: none;
}

%t `+x+` figcaption textarea.trix-autoresize-clone {
  position: absolute;
  left: -9999px;
  max-height: 0px;
}

%t `+x+` figcaption[data-trix-placeholder]:empty::before {
  content: attr(data-trix-placeholder);
  color: graytext;
}

%t [data-trix-cursor-target] {
  display: `+n.display+` !important;
  width: `+n.width+` !important;
  padding: 0 !important;
  margin: 0 !important;
  border: none !important;
}

%t [data-trix-cursor-target=left] {
  vertical-align: top !important;
  margin-left: -1px !important;
}

%t [data-trix-cursor-target=right] {
  vertical-align: bottom !important;
  margin-right: -1px !important;
}`,trixId:{get:function(){return this.hasAttribute("trix-id")?this.getAttribute("trix-id"):(this.setAttribute("trix-id",++m),this.trixId)}},labels:{get:function(){var p,g,d;return g=[],this.id&&this.ownerDocument&&g.push.apply(g,this.ownerDocument.querySelectorAll("label[for='"+this.id+"']")),(p=y(this,{matchingSelector:"label"}))&&((d=p.control)===this||d===null)&&g.push(p),g}},toolbarElement:{get:function(){var p,g,d;return this.hasAttribute("toolbar")?(g=this.ownerDocument)!=null?g.getElementById(this.getAttribute("toolbar")):void 0:this.parentNode?(d="trix-toolbar-"+this.trixId,this.setAttribute("toolbar",d),p=e("trix-toolbar",{id:d}),this.parentNode.insertBefore(p,this),p):void 0}},inputElement:{get:function(){var p,g,d;return this.hasAttribute("input")?(d=this.ownerDocument)!=null?d.getElementById(this.getAttribute("input")):void 0:this.parentNode?(g="trix-input-"+this.trixId,this.setAttribute("input",g),p=e("input",{type:"hidden",id:g}),this.parentNode.insertBefore(p,this.nextElementSibling),p):void 0}},editor:{get:function(){var p;return(p=this.editorController)!=null?p.editor:void 0}},name:{get:function(){var p;return(p=this.inputElement)!=null?p.name:void 0}},value:{get:function(){var p;return(p=this.inputElement)!=null?p.value:void 0},set:function(p){var g;return this.defaultValue=p,(g=this.editor)!=null?g.loadHTML(this.defaultValue):void 0}},notify:function(p,g){return this.editorController?a("trix-"+p,{onElement:this,attributes:g}):void 0},setInputElementValue:function(p){var g;return(g=this.inputElement)!=null?g.value=p:void 0},initialize:function(){return this.hasAttribute("data-trix-internal")?void 0:(t(this),o(this),u(this))},connect:function(){return this.hasAttribute("data-trix-internal")?void 0:(this.editorController||(a("trix-before-initialize",{onElement:this}),this.editorController=new v.EditorController({editorElement:this,html:this.defaultValue=this.value}),requestAnimationFrame(function(p){return function(){return a("trix-initialize",{onElement:p})}}(this))),this.editorController.registerSelectionManager(),this.registerResetListener(),this.registerClickListener(),r(this))},disconnect:function(){var p;return(p=this.editorController)!=null&&p.unregisterSelectionManager(),this.unregisterResetListener(),this.unregisterClickListener()},registerResetListener:function(){return this.resetListener=this.resetBubbled.bind(this),window.addEventListener("reset",this.resetListener,!1)},unregisterResetListener:function(){return window.removeEventListener("reset",this.resetListener,!1)},registerClickListener:function(){return this.clickListener=this.clickBubbled.bind(this),window.addEventListener("click",this.clickListener,!1)},unregisterClickListener:function(){return window.removeEventListener("click",this.clickListener,!1)},resetBubbled:function(p){var g;if(!p.defaultPrevented&&p.target===((g=this.inputElement)!=null?g.form:void 0))return this.reset()},clickBubbled:function(p){var g;if(!(p.defaultPrevented||this.contains(p.target)||!(g=y(p.target,{matchingSelector:"label"}))||f.call(this.labels,g)<0))return this.focus()},reset:function(){return this.value=this.defaultValue}}}())}).call(this),(function(){}).call(this)}).call(this),j.exports&&(j.exports=v)}).call(H)})(Y);export{Z as g};
