import{a as C,Q as V}from"./vesp-Bp925PML.js";import{P as B,x as M,A as H}from"./api-BTbQaFYe.js";import{u as N}from"./use-date-Bz43xCTR.js";import{d as T,z as r,A as c,g as j,o as a,b as f,w as u,c as d,q,u as o,i as D,h as L}from"./vue-u_8eP0W0.js";import"./vue-bootstrap-BxJOzva2.js";import"./vue-router-DIhyXLOA.js";import"./vueform-C51mNOCu.js";const Q={key:0,class:"icon icon-times fa-fw text-danger"},R={key:1,class:"icon icon-check fa-fw text-success"},S={key:2,class:"icon icon-hourglass-half text-secondary fa-fw"},U=["innerHTML"],m="mgr/emails",K=T({__name:"emails",setup($){const e=M,n=r(),_=c(()=>[{key:"id",label:e("models.submission.id"),sortable:!0},{key:"form.title",label:e("models.form.title_one")},{key:"to",label:e("models.email.to"),sortable:!0},{key:"subject",label:e("models.email.subject"),sortable:!0},{key:"sent",label:e("models.email.sent"),sortable:!0},{key:"sent_at",label:e("models.email.sent_at"),sortable:!0,formatter:N}]),b=c(()=>[{function:v,icon:"trash",title:e("actions.delete_unsent"),variant:"danger"}]),p=c(()=>{var t;return[{function:k,icon:"paper-plane",title:e("actions.send"),isActive:h},{route:{name:"emails-id-view"},icon:"eye",title:e("actions.view")},{function:(t=n.value)==null?void 0:t.delete,icon:"times",title:e("actions.delete"),variant:"danger"}]}),y=r({query:""}),s=r(!1);function h(t){return t&&!t.sent}async function k(t){n.value.loading=!0;try{await B(m+"/"+t.id)}catch{}finally{n.value.loading=!1,n.value.refresh()}}function v(){s.value=!0}async function w(){n.value.loading=!0;try{await H(m)}catch{}finally{n.value.loading=!1,n.value.refresh()}}return(t,i)=>{const g=j("RouterView"),x=C,A=V;return a(),f(A,{ref_key:"table",ref:n,url:m,"table-actions":o(p),"header-actions":o(b),fields:o(_),filters:o(y),sort:"id",dir:"desc"},{"cell(sent)":u(({value:l})=>[l===!1?(a(),d("i",Q)):l===!0?(a(),d("i",R)):(a(),d("i",S))]),default:u(()=>[q(g),o(s)?(a(),f(x,{key:0,"on-ok":w,onHidden:i[0]||(i[0]=l=>s.value=!1)},{default:u(()=>[D("div",{innerHTML:o(e)("models.email.confirm_delete_unsent")},null,8,U)]),_:1})):L("",!0)]),_:1},8,["table-actions","header-actions","fields","filters"])}}});export{K as default};
