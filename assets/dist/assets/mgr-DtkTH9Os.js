function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/submissions-C_PdzYys.js","assets/use-api-CABo2mPT.js","assets/vueform-bjGVKQ0y.js","assets/axios-Bo0ATomq.js","assets/moment-Cl4UOzQZ.js","assets/vue-CtCNMA3P.js","assets/popperjs-CBZXh9ac.js","assets/wnumb-BOjvQ4jq.js","assets/trix-ul_qCPMg.js","assets/nouislider-dfTmBPAg.js","assets/vueform-CiCkEoWT.css","assets/vue-toastification-BdZxUhs9.js","assets/ofetch-C3euP1G2.js","assets/destr-CVtkxrq9.js","assets/ufo-DbHr4xTX.js","assets/use-date-DVdoth2I.js","assets/vue-router-0XY2QSw6.js","assets/bootstrap-vue-next-DWmnrxyd.js","assets/codemirror-Dhbez0_B.js","assets/lezer-BmdiRFRL.js","assets/style-mod-Bc2inJdb.js","assets/w3c-keyname-Vcq4gwWv.js","assets/crelt-C8TCjufn.js","assets/vue-codemirror-DmWmgxNk.js","assets/view-DX7at-NR.js","assets/emails-Y7zRZPfs.js","assets/view-Cw54t5yd.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{a6 as resolveComponent,o as openBlock,a as createElementBlock,l as createBaseVNode,x as toDisplayString,u as unref,i as createVNode,w as withCtx,F as Fragment,N as renderList,C as createTextVNode,d as defineComponent,r as ref,c as computed,b as onMounted,V as createSlots,v as mergeProps,G as useAttrs,h as renderSlot,m as normalizeProps,p as guardReactiveProps,y as watch,I as provide,g as createBlock,ad as Suspense,n as normalizeClass,q as createCommentVNode,H as inject,P as withModifiers,M as isRef,ae as withAsyncContext,$ as createApp}from"./vue-CtCNMA3P.js";import{u as useRouter,a as useRoute,c as createRouter,b as createWebHashHistory}from"./vue-router-0XY2QSw6.js";import{T as Td,w as wd,R as Ra,B as Bt,k as ka,U as Ut,O as Ou,m as md,t as tc,p as pc,a as Ud,C as Ca,b as wn,o as ou,W as Wi,c as po,M as Mu,V as Vu,d as Ma,v as vi,e as kn,f as mc,y as yc,_ as _c}from"./bootstrap-vue-next-DWmnrxyd.js";import{_ as _export_sfc,v as vueform}from"./vueform-bjGVKQ0y.js";import{s as src_default}from"./vue-toastification-BdZxUhs9.js";import{u as useLexicon,a as useGet,b as useDelete,c as useToastError,d as usePut,e as usePatch,f as usePost,t as toastOptions,v as vueFormConfig}from"./use-api-CABo2mPT.js";import{h as html,j as javascript}from"./codemirror-Dhbez0_B.js";import{T}from"./vue-codemirror-DmWmgxNk.js";import"./axios-Bo0ATomq.js";import"./moment-Cl4UOzQZ.js";import"./popperjs-CBZXh9ac.js";import"./wnumb-BOjvQ4jq.js";import"./trix-ul_qCPMg.js";import"./nouislider-dfTmBPAg.js";import"./ofetch-C3euP1G2.js";import"./destr-CVtkxrq9.js";import"./ufo-DbHr4xTX.js";import"./lezer-BmdiRFRL.js";import"./style-mod-Bc2inJdb.js";import"./w3c-keyname-Vcq4gwWv.js";import"./crelt-C8TCjufn.js";const _hoisted_1$7={class:"overflow-auto vh-100 p-3"},_hoisted_2$5={class:"m-0"},_hoisted_3$4={class:"small text-secondary"},_hoisted_4$3={class:"main-wrapper"},_sfc_main$b={__name:"app",setup(r){const m=useLexicon,d=[{title:"models.form.title_many",route:"index"},{title:"models.submission.title_many",route:"submissions"},{title:"models.email.title_many",route:"emails"}];return(i,e)=>{const n=Td,o=wd,a=resolveComponent("RouterView");return openBlock(),createElementBlock("div",_hoisted_1$7,[createBaseVNode("h4",_hoisted_2$5,toDisplayString(unref(m)("menu_name")),1),createBaseVNode("div",_hoisted_3$4,toDisplayString(unref(m)("menu_desc")),1),createVNode(o,{tabs:"",class:"justify-content-between justify-content-md-start mt-3"},{default:withCtx(()=>[(openBlock(),createElementBlock(Fragment,null,renderList(d,(s,y)=>createVNode(n,{key:y,to:{name:s.route},"active-class":"active"},{default:withCtx(()=>[createTextVNode(toDisplayString(unref(m)(s.title)),1)]),_:2},1032,["to"])),64))]),_:1}),createBaseVNode("div",_hoisted_4$3,[createVNode(a)])])}}},App=_export_sfc(_sfc_main$b,[["__scopeId","data-v-76f72b56"]]),scriptRel="modulepreload",assetsURL=function(r){return"/assets/components/mmx-forms/"+r},seen={},__vitePreload=function(m,d,i){let e=Promise.resolve();if(d&&d.length>0){const n=document.getElementsByTagName("link");e=Promise.all(d.map(o=>{if(o=assetsURL(o),o in seen)return;seen[o]=!0;const a=o.endsWith(".css"),s=a?'[rel="stylesheet"]':"";if(!!i)for(let _=n.length-1;_>=0;_--){const V=n[_];if(V.href===o&&(!a||V.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${s}`))return;const l=document.createElement("link");if(l.rel=a?"stylesheet":scriptRel,a||(l.as="script",l.crossOrigin=""),l.href=o,document.head.appendChild(l),a)return new Promise((_,V)=>{l.addEventListener("load",_),l.addEventListener("error",()=>V(new Error(`Unable to preload CSS for ${o}`)))})}))}return e.then(()=>m()).catch(n=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=n,window.dispatchEvent(o),!o.defaultPrevented)throw n})},_hoisted_1$6={class:"mmx-modal mmx-confirm"},_sfc_main$a=defineComponent({__name:"confirm",props:{...Ra.props,onOk:{type:Function,default:()=>{}},show:{type:Boolean,default:!0},title:{type:String,default:"components.delete.title"},centered:{type:Boolean,default:!1},okVariant:{type:String,default:"danger"},okTitle:{type:String,default:"actions.ok"},cancelTitle:{type:String,default:"actions.cancel"},teleportDisabled:{type:Boolean,default:!0}},setup(r,{expose:m}){const d=useLexicon,i=ref(),e=r,n=ref(!1),o=computed(()=>{const l={...useAttrs(),...e};return delete l.modelValue,delete l.show,l.onShown||(l.onShown=y),l});function a(){i.value.$emit("hide"),n.value=!1}function s(){a(),e.onOk()}function y(){const l=document.querySelector('.mmx-confirm button[name="ok"]');l&&l.focus()}return onMounted(()=>{e.show&&(n.value=!0)}),m({hide:a,ok:s}),(l,_)=>{const V=Bt;return openBlock(),createElementBlock("section",_hoisted_1$6,[createVNode(unref(Ra),mergeProps({ref_key:"modal",ref:i,"model-value":n.value},o.value,{title:unref(d)(r.title)}),createSlots({footer:withCtx(()=>[renderSlot(l.$slots,"footer",mergeProps({ref:"footer"},{hide:a}),()=>[createVNode(V,{name:"cancel",variant:e.cancelVariant,onClick:a},{default:withCtx(()=>[createTextVNode(toDisplayString(unref(d)(r.cancelTitle)),1)]),_:1},8,["variant"]),createVNode(V,{name:"ok",variant:e.okVariant,onClick:s},{default:withCtx(()=>[createTextVNode(toDisplayString(unref(d)(r.okTitle)),1)]),_:1},8,["variant"])])]),_:2},[renderList(Object.keys(l.$slots),g=>({name:g,fn:withCtx(k=>[renderSlot(l.$slots,g,normalizeProps(guardReactiveProps(k)))])}))]),1040,["model-value","title"])])}}});function useConfig(r){var d;const m=((d=window.MODx)==null?void 0:d.config)||{};return r in m?m[r]:void 0}const _hoisted_1$5={class:"mmx-table"},_hoisted_2$4=createBaseVNode("i",{class:"icon icon-times fa-fw"},null,-1),_hoisted_3$3={key:1,class:"icon icon-repeat fa-fw"},_hoisted_4$2=["innerHTML"],_sfc_main$9=defineComponent({__name:"table",props:{modelValue:{type:Number,default:null},url:{type:String,required:!0,default:""},fields:{type:Array,default(){return[]}},filters:{type:Object,default(){return{}}},updateKey:{type:String,default:""},primaryKey:{type:[String,Array],default:"id"},sort:{type:String,default:null},dir:{type:String,default:"asc"},limit:{type:Number,default:Number(useConfig("default_per_page"))||20},stacked:{type:String,default:void 0},responsive:{type:Boolean,default:!0},showEmpty:{type:Boolean,default:!0},headerActions:{type:Array,default(){return[]}},tableActions:{type:Array,default(){return[]}},rowClass:{type:Function,default(){return""}},tableClass:{type:[String,Array,Object],default:"mt-3 mt-md-0"},pageLimit:{type:Number,default:7},onLoad:{type:Function,default(r){return r}},emptyText:{type:String,default:"components.no_data"},emptyFilteredText:{type:String,default:"components.no_results"},deleteTitle:{type:String,default:"components.delete.title"},deleteText:{type:String,default:"components.delete.confirm"}},emits:["update:modelValue","update:sort","update:dir","update:limit","update:filters","delete"],setup(r,{expose:m,emit:d}){const i=d,e=r,n=useLexicon,o=ref(1),a=ref(e.sort),s=ref(e.dir),y=ref(e.limit),l=ref(e.filters),_=computed({get(){return e.modelValue===null?o.value:e.modelValue},set(t){o.value=Number(t),i("update:modelValue",t)}}),V=computed(()=>{const t=[...e.fields];return e.tableActions.length&&t.findIndex(c=>c.key==="actions")===-1&&t.push({key:"actions",label:"",class:"table-actions"}),t}),g=computed(()=>Object.keys(l.value).includes("query")),k=ref(!1),h=ref(0),B=ref([]),S=ref(!1),v=ref(!1),x=ref({}),f={item:x,visible:S,loading:v,deleteItem:w},D=computed(()=>({limit:e.limit,page:_.value,...O(!0)}));function u(t,c){a.value=t,s.value=c?"desc":"asc",b()}function C(t,c){if(!t.route)return;t.map||(t.map={},Array.isArray(e.primaryKey)?e.primaryKey.forEach($=>{t.map[$]=$}):t.map[e.primaryKey]=e.primaryKey);const p={};for(const $ of Object.keys(t.map)){const A=t.map[$];if(/\./.test(A)){const M=A.split(".");let z={...c};for(const R of M)z=z[R];p[$]=z}else p[$]=c[A]}return{...t.route,params:p}}function P(t,c=void 0){t.function&&typeof t.function=="function"&&(c?t.function(JSON.parse(JSON.stringify(c))):t.function())}function O(t=!1){const c={};return Object.keys(e.filters).forEach(p=>{e.filters[p]!==""&&e.filters[p]!==null&&(c[p]=typeof e.filters[p]=="object"&&!t?JSON.stringify(e.filters[p]):e.filters[p])}),a.value&&(c.sort=a.value,c.dir=s.value),t?JSON.parse(JSON.stringify(c)):new URLSearchParams(c).toString()}function L(t){S.value=!0,x.value=t}function F(){S.value=!1,x.value={}}async function w(){v.value=!0;const t=x.value;try{if(Array.isArray(e.primaryKey)){const c={};e.primaryKey.forEach(p=>{c[p]=t[p]}),await useDelete(e.url,c)}else t[e.primaryKey]?await useDelete(e.url+"/"+t[e.primaryKey]):await useDelete(e.url,t);S.value=!1,await b()}catch{}finally{v.value=!1}}m({getParams:O,page:_,sort:a,dir:s,loading:k,delete:L,refresh:b,items:B}),watch(_,()=>{b()}),watch(l,()=>{_.value!==1&&(_.value=1),b()},{deep:!0});async function b(){if(!k.value)try{k.value=!0;const t=e.onLoad(await useGet(e.url,D.value));B.value=t.rows||[],h.value=t.total||0}catch{}finally{k.value=!1}}b();const U=e.updateKey||e.url.split("/").join("-");return provide("refreshTable",t=>{U===t&&b()}),(t,c)=>{const p=Bt,$=Ut,A=Ou,M=md,z=tc,R=pc,j=ka,I=Ud,K=Ca,H=_sfc_main$a;return openBlock(),createElementBlock("section",_hoisted_1$5,[renderSlot(t.$slots,"header",{},()=>[createVNode(z,{class:"align-items-center mb-3"},{default:withCtx(()=>[createVNode($,{md:"4"},{default:withCtx(()=>[renderSlot(t.$slots,"header-start",{},()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(r.headerActions,(N,E)=>(openBlock(),createBlock(p,{key:E,size:N.size||"md",variant:N.variant||"secondary",class:normalizeClass(N.class||(E?"col-12 col-md-auto ms-md-2 mt-2 mt-md-0":"col-12 col-md-auto")),to:N.route,onClick:q=>P(N)},{default:withCtx(()=>[N.icon?(openBlock(),createElementBlock("i",{key:0,class:normalizeClass(`icon icon-${N.icon} fa-fw`)},null,2)):createCommentVNode("",!0),createTextVNode(" "+toDisplayString(N.title),1)]),_:2},1032,["size","variant","class","to","onClick"]))),128))])]),_:3}),createVNode($,{md:"4"},{default:withCtx(()=>[renderSlot(t.$slots,"header-middle")]),_:3}),createVNode($,{md:"4",class:"mt-2 mt-md-0"},{default:withCtx(()=>[renderSlot(t.$slots,"header-end",{},()=>[g.value?(openBlock(),createBlock(M,{key:0},{append:withCtx(()=>[createVNode(p,{disabled:!l.value.query,onClick:c[0]||(c[0]=N=>l.value.query=null)},{default:withCtx(()=>[_hoisted_2$4]),_:1},8,["disabled"])]),default:withCtx(()=>[createVNode(A,{modelValue:l.value.query,"onUpdate:modelValue":c[1]||(c[1]=N=>l.value.query=N),placeholder:unref(n)("components.query")},null,8,["modelValue","placeholder"])]),_:1})):createCommentVNode("",!0)])]),_:3})]),_:3})]),createVNode(j,{show:k.value,opacity:"0.25"},{default:withCtx(()=>[createVNode(R,{items:B.value,fields:V.value,class:normalizeClass(r.tableClass),"per-page":y.value,"sort-by":a.value,"sort-desc":s.value==="desc","empty-text":unref(n)(r.emptyText),"empty-filtered-text":unref(n)(r.emptyFilteredText),stacked:r.stacked,responsive:r.responsive,"show-empty":r.showEmpty,"sort-internal":!1,"tbody-tr-class":r.rowClass,onSorted:u},createSlots({"cell(actions)":withCtx(({item:N})=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(r.tableActions,(E,q)=>(openBlock(),createElementBlock(Fragment,null,[typeof E.isActive!="function"||E.isActive(N)===!0?(openBlock(),createBlock(p,mergeProps({key:q,size:E.size||"sm",variant:E.variant||"secondary",class:E.class},E.route?{to:C(E,N)}:{},{onClick:G=>P(E,N)}),{default:withCtx(()=>[E.icon?(openBlock(),createElementBlock("i",{key:0,class:normalizeClass(`icon icon-${E.icon} fa-fw`)},null,2)):(openBlock(),createElementBlock(Fragment,{key:1},[createTextVNode(toDisplayString(E.title),1)],64))]),_:2},1040,["size","variant","class","onClick"])):createCommentVNode("",!0)],64))),256))]),_:2},[renderList(Object.keys(t.$slots),N=>({name:N,fn:withCtx(E=>[N!=="default"?renderSlot(t.$slots,N,normalizeProps(mergeProps({key:0},E))):createCommentVNode("",!0)])}))]),1032,["items","fields","class","per-page","sort-by","sort-desc","empty-text","empty-filtered-text","stacked","responsive","show-empty","tbody-tr-class"])]),_:3},8,["show"]),renderSlot(t.$slots,"footer",normalizeProps(guardReactiveProps({refresh:b,total:h.value,page:_.value,limit:r.limit,loading:k.value})),()=>[createVNode(z,{class:"mt-5 align-items-center justify-content-center justify-content-md-start","no-gutters":""},{default:withCtx(()=>[createVNode($,{cols:"12",md:"auto",class:"d-flex justify-content-center"},{default:withCtx(()=>[renderSlot(t.$slots,"pagination",normalizeProps(guardReactiveProps({refresh:b,total:h.value,page:_.value,limit:r.limit,loading:k.value})),()=>[h.value>r.limit?(openBlock(),createBlock(I,{key:0,modelValue:_.value,"onUpdate:modelValue":c[2]||(c[2]=N=>_.value=N),"total-rows":h.value,"per-page":r.limit,limit:r.pageLimit,class:"mb-md-0 me-md-3"},null,8,["modelValue","total-rows","per-page","limit"])):createCommentVNode("",!0)])]),_:3}),createVNode($,{cols:"12",md:"auto",class:"d-flex align-items-center justify-content-center gap-2"},{default:withCtx(()=>[renderSlot(t.$slots,"pagination-data",normalizeProps(guardReactiveProps({refresh:b,total:h.value,page:_.value,limit:r.limit,loading:k.value})),()=>[createVNode(p,{class:"border-0",onClick:c[3]||(c[3]=()=>b())},{default:withCtx(()=>[k.value?(openBlock(),createBlock(K,{key:0,small:!0})):(openBlock(),createElementBlock("i",_hoisted_3$3))]),_:1}),createTextVNode(" "+toDisplayString(unref(n)("components.records",{total:h.value},h.value)),1)])]),_:3})]),_:3})]),(openBlock(),createBlock(Suspense,null,{default:withCtx(()=>[renderSlot(t.$slots,"default")]),_:3})),renderSlot(t.$slots,"delete",normalizeProps(guardReactiveProps(f)),()=>[S.value?(openBlock(),createBlock(H,{key:0,title:r.deleteTitle,"on-ok":w,"ok-title":"actions.delete",onHidden:F},{default:withCtx(()=>[createVNode(j,{opacity:.5,show:v.value},{default:withCtx(()=>[createBaseVNode("div",{innerHTML:unref(n)(r.deleteText)},null,8,_hoisted_4$2)]),_:1},8,["show"])]),_:1},8,["title"])):createCommentVNode("",!0)])])}}}),url="mgr/forms",_sfc_main$8=defineComponent({__name:"index",setup(r){const m=useLexicon,d=ref(),i=computed(()=>[{route:{name:"index-create"},icon:"plus",title:m("actions.create")}]),e=computed(()=>[{key:"id",label:m("models.form.id"),sortable:!0},{key:"title",label:m("models.form.title"),sortable:!0},{key:"submissions_count",label:m("models.submission.title_many"),sortable:!0},{key:"emails_count",label:m("models.email.title_many"),sortable:!0}]),n=computed(()=>{var s;return[{route:{name:"index-id-edit"},icon:"edit",title:m("actions.edit")},{function:(s=d.value)==null?void 0:s.delete,icon:"times",title:m("actions.delete"),variant:"danger"}]}),o=ref({query:""});function a(s){if(s){const y=[];return s.active||y.push("inactive"),y}}return(s,y)=>{const l=resolveComponent("RouterView"),_=_sfc_main$9;return openBlock(),createBlock(_,{ref_key:"table",ref:d,url,"header-actions":unref(i),"table-actions":unref(n),fields:unref(e),filters:unref(o),"row-class":a,sort:"id",dir:"desc"},{default:withCtx(()=>[createVNode(l)]),_:1},8,["header-actions","table-actions","fields","filters"])}}}),_hoisted_1$4={class:"mmx-modal"},_hoisted_2$3=createBaseVNode("input",{type:"submit",class:"d-none"},null,-1),_sfc_main$7=defineComponent({__name:"modal",props:{...Ra.props,url:{type:String,default:""},modelValue:{type:Object,default(){return{}}},method:{type:String,default:"POST"},updateKey:{type:String,default:""},show:{type:Boolean,default:!0},okTitle:{type:String,default:"actions.submit"},cancelTitle:{type:String,default:"actions.cancel"},beforeSubmit:{type:Function,default(r){return r}},teleportDisabled:{type:Boolean,default:!0}},emits:["update:modelValue","after-submit"],setup(r,{expose:m,emit:d}){var D;const i=d,e=ref(),n=ref(),o=useRouter(),a=useRoute(),s=ref(!1),y=computed({get(){return l.modelValue},set(u){i("update:modelValue",u)}}),l=r,_=ref(!1),V=computed(()=>{const u={...useAttrs(),...l};return delete u.modelValue,delete u.show,delete u.url,delete u.method,delete u.beforeSubmit,u.onHidden||(u.onHidden=S),u.onShown||(u.onShown=v),u}),g=l.updateKey||((D=l.url)==null?void 0:D.split("/").join("-"));function k(){if(n.value&&n.value.$el){const u=n.value.$el.querySelector('[type="submit"]');u?u.click():u()}else h()}async function h(){if(l.url)try{const u=l.beforeSubmit(JSON.parse(JSON.stringify(y.value)));if(u)if(typeof u=="string")useToastError(u);else{s.value=!0;const C=l.method.toLowerCase(),P={put:usePut,patch:usePatch},L=await(C in P?P[C]:usePost)(l.url,u);i("after-submit",L),B(),f(g)}}catch{}finally{s.value=!1}}function B(){e.value.$emit("hide"),_.value=!1}function S(){const u=a.matched.findIndex(C=>C.name===a.name);u>0&&a.matched[u-1]?o.push({name:a.matched[u-1].name}):o.go(-1)}function v(){if(n.value&&n.value.$el){const u=n.value.$el.querySelector("input:not(:disabled)");u&&u.focus()}}function x(u){(u.metaKey||u.ctrlKey)&&u.code==="KeyS"&&(u.preventDefault(),k())}onMounted(()=>{l.show&&(_.value=!0)}),m({hide:B,submit:h,formSubmit:k});const f=inject("refreshTable")||function(u){};return(u,C)=>{const P=wn,O=ka,L=Bt;return openBlock(),createElementBlock("section",_hoisted_1$4,[createVNode(unref(Ra),mergeProps({ref_key:"modal",ref:e,modelValue:_.value,"onUpdate:modelValue":C[0]||(C[0]=F=>_.value=F)},V.value),createSlots({default:withCtx(()=>[createVNode(O,{opacity:.5,show:s.value},{default:withCtx(()=>[createVNode(P,{ref_key:"form",ref:n,onSubmit:withModifiers(h,["prevent"]),onKeydown:x},{default:withCtx(()=>[renderSlot(u.$slots,"form-fields",normalizeProps(guardReactiveProps({record:y.value,loading:s.value,hide:B,submit:h}))),_hoisted_2$3]),_:3},512)]),_:3},8,["show"])]),footer:withCtx(()=>[renderSlot(u.$slots,"footer",normalizeProps(guardReactiveProps({record:y.value,loading:s.value,hide:B,submit:h,formSubmit:k})),()=>[createVNode(L,{variant:l.cancelVariant,disabled:s.value,onClick:B},{default:withCtx(()=>[createTextVNode(toDisplayString(unref(useLexicon)(r.cancelTitle)),1)]),_:1},8,["variant","disabled"]),r.url?(openBlock(),createBlock(L,{key:0,variant:l.okVariant,disabled:s.value,onClick:withModifiers(k,["prevent"])},{default:withCtx(()=>[createTextVNode(toDisplayString(unref(useLexicon)(r.okTitle)),1)]),_:1},8,["variant","disabled"])):createCommentVNode("",!0)])]),_:2},[renderList(Object.keys(u.$slots),F=>({name:F,fn:withCtx(w=>[renderSlot(u.$slots,F,normalizeProps(guardReactiveProps({...w,record:y.value,loading:s.value,hide:B,submit:h,formSubmit:k})))])}))]),1040,["modelValue"])])}}}),_hoisted_1$3={class:"mmx-combo"},_hoisted_2$2=createBaseVNode("i",{class:"icon icon-caret-down fa-fw"},null,-1),_hoisted_3$2=["textContent"],_sfc_main$6=defineComponent({__name:"combo-box",props:{...Ou.props,modelValue:{type:[String,Number],default:""},url:{type:String,required:!0},valueField:{type:String,default:"id"},textField:{type:String,default:"title"},limit:{type:Number,default:10},sort:{type:String,default:null},dir:{type:String,default:"asc"},forceSelect:{type:Boolean,default:!1},emptyText:{type:String,default:"No results"},filterProps:{type:Object,default(){return{}}},formatValue:{type:Function,default:void 0},maxPages:{type:Number,default:5},onLoad:{type:Function,default(r){return r}},disabled:{type:Boolean,default:!1}},emits:["update:modelValue","load","failure","change","select","reset","keydown"],setup(r,{expose:m,emit:d}){const i=d,e=r,n=ref(),o=ref([]),a=ref(""),s=ref(null),y=ref(!1),l=ref(""),_=ref(!1),V=ref(e.page||1),g=ref(0),k=ref(!1),h=computed({get(){return e.modelValue||null},set(t){i("update:modelValue",t)}}),B=computed(()=>({type:e.type,autofocus:e.autofocus,placeholder:e.placeholder,required:e.required,readonly:e.readonly,disabled:e.disabled}));watch(()=>e.filterProps,async t=>{const c=JSON.stringify(t);c!==l.value&&(l.value=c,e.lazy||(await v(""),h.value&&o.value.findIndex(p=>p[e.valueField]==h.value)===-1&&x()))}),watch(()=>e.lazy,t=>{t&&S()}),watch(h,t=>{e.skipWatchers||b(t)}),onMounted(()=>{l.value=JSON.stringify(e.filterProps),S()});async function S(){e.lazy||(await v(),h.value&&await b(h.value))}async function v(t=a.value){if(e.url&&!_.value){const c={...e.filterProps,query:t,limit:e.limit,sort:e.sort||e.textField,dir:e.dir,page:V.value,combo:!0};_.value=!0;try{const p=e.onLoad(await useGet(e.url,c));o.value=p.rows||[],g.value=p.total||0,i("load",o.value,g.value)}catch(p){i("failure",p)}finally{_.value=!1}}}function x(){V.value=1,h.value=null,a.value=""}function f(t){V.value=1;const c=o.value[t];if(c)return h.value=c[e.valueField],a.value=U(c),c}function D(t){t.stopPropagation(),P()?C():u()}function u(){y.value=!0,document.addEventListener("click",C,{once:!0})}function C(){y.value=!1,s.value=null}function P(){return y.value}async function O(t){t.length?(k.value=!0,h.value=null,await v(t),u(),k.value=!1):(x(),e.lazy||await v())}function L(t){i("change",t),t&&e.forceSelect&&!h.value&&o.value.length&&F(0)}function F(t,c){c&&n.value.$el.focus();const p=f(t);p&&p[e.valueField]!==h.value&&i("select",p)}function w(t){t.key==="ArrowDown"&&!P()&&o.value.length&&u(),t.key==="ArrowDown"&&(s.value===null||s.value<o.value.length-1)?s.value=s.value===null?0:s.value+1:s.value!==null&&t.key==="ArrowUp"&&(s.value=s.value===0?null:s.value-1),t.key==="Enter"&&(P()&&(t.stopPropagation(),t.preventDefault()),typeof s.value=="number"&&(F(s.value),C())),t.key==="Escape"&&P()&&(t.stopPropagation(),t.preventDefault(),C()),i("keydown",t)}async function b(t){if(!t)x();else{if(o.value.findIndex(p=>p[e.valueField]==t)===-1){const p={...e.filterProps,combo:!0};p[e.valueField]=t;const $=await useGet(e.url,p);$[e.valueField]==t&&o.value.push($)}const c=o.value.findIndex(p=>p[e.valueField]==t);c!==-1&&F(c)}}function U(t){return e.formatValue?e.formatValue(t):t[e.textField]}return watch(V,()=>{v(h.value?"":a.value)}),m({total:g,page:V,limit:e.limit,options:o,externalValue:a}),(t,c)=>{const p=Bt,$=md,A=ou,M=Ud,z=Wi;return openBlock(),createElementBlock("div",_hoisted_1$3,[createVNode($,null,{append:withCtx(()=>[renderSlot(t.$slots,"append",normalizeProps(guardReactiveProps({toggle:D,disabled:r.disabled,readonly:t.readonly,options:o.value})),()=>[createVNode(p,{disabled:!o.value.length||r.disabled||t.readonly,tabindex:"-1",onClick:withModifiers(D,["prevent"])},{default:withCtx(()=>[_hoisted_2$2]),_:1},8,["disabled"])])]),default:withCtx(()=>[createVNode(unref(Ou),mergeProps({ref_key:"input",ref:n,modelValue:a.value,"onUpdate:modelValue":c[0]||(c[0]=R=>a.value=R)},B.value,{autocomplete:"off",onChange:L,onKeydown:w,"onUpdate:modelValue":O}),null,16,["modelValue"])]),_:3}),createBaseVNode("ul",{class:normalizeClass({"dropdown-menu mmx-combo-list":!0,show:y.value})},[o.value.length?(openBlock(),createElementBlock(Fragment,{key:1},[renderSlot(t.$slots,"list-header",normalizeProps(guardReactiveProps({hideDropdown:C,total:g.value}))),(openBlock(!0),createElementBlock(Fragment,null,renderList(o.value,(R,j)=>(openBlock(),createBlock(A,{key:R[r.valueField],class:normalizeClass({"mmx-combo-list-item":!0}),active:s.value===j,onClick:I=>F(j,I)},{default:withCtx(()=>[renderSlot(t.$slots,"default",normalizeProps(guardReactiveProps({item:R})),()=>[createTextVNode(toDisplayString(U(R)),1)])]),_:2},1032,["active","onClick"]))),128)),renderSlot(t.$slots,"list-footer",normalizeProps(guardReactiveProps({hideDropdown:C,total:g.value})),()=>[g.value>o.value.length?(openBlock(),createBlock(z,{key:0,class:"my-2",onClick:c[2]||(c[2]=R=>R.stopPropagation())},{default:withCtx(()=>[createVNode(M,{modelValue:V.value,"onUpdate:modelValue":c[1]||(c[1]=R=>V.value=R),"per-page":r.limit,limit:r.maxPages,"total-rows":g.value},null,8,["modelValue","per-page","limit","total-rows"])]),_:1})):createCommentVNode("",!0)])],64)):renderSlot(t.$slots,"no-results",normalizeProps(mergeProps({key:0},{hideDropdown:C,emptyText:r.emptyText})),()=>[createBaseVNode("li",{class:"alert alert-info m-0",onClick:C,textContent:toDisplayString(r.emptyText)},null,8,_hoisted_3$2)])],2)])}}}),_hoisted_1$2={key:0,class:"small text-secondary"},_sfc_main$5=defineComponent({__name:"form-action",props:{modelValue:{type:Object,required:!0}},emits:["update:modelValue"],setup(r,{emit:m}){const d=r,i=useLexicon,e=m,n=ref(),o=ref(),a=ref(),s=ref(),y=["reset","message","redirect","snippet"];d.modelValue?(n.value=d.modelValue.type,n.value==="message"?a.value=d.modelValue.value:n.value==="redirect"?o.value=d.modelValue.value:s.value=d.modelValue.value):n.value="reset";function l(V){V?e("update:modelValue",{type:n,value:V}):e("update:modelValue",null)}function _(){e("update:modelValue",null)}return(V,g)=>{const k=po,h=Mu,B=Vu,S=Ma,v=Ou,x=_sfc_main$6;return openBlock(),createElementBlock("div",null,[createVNode(B,{label:unref(i)("models.form.action"),description:unref(i)("models.form.action_desc")},{default:withCtx(()=>[createVNode(h,{modelValue:unref(n),"onUpdate:modelValue":g[0]||(g[0]=f=>isRef(n)?n.value=f:null),onChange:_},{default:withCtx(()=>[(openBlock(),createElementBlock(Fragment,null,renderList(y,f=>createVNode(k,{key:f,value:f},{default:withCtx(()=>[createTextVNode(toDisplayString(unref(i)("models.form.actions."+f)),1)]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"])]),_:1},8,["label","description"]),unref(n)==="reset"?(openBlock(),createBlock(S,{key:0},{default:withCtx(()=>[createTextVNode(toDisplayString(unref(i)("models.form.actions.reset_desc")),1)]),_:1})):unref(n)==="redirect"?(openBlock(),createBlock(B,{key:1,description:unref(i)("models.form.actions.redirect_desc")},{default:withCtx(()=>[createVNode(v,{modelValue:unref(o),"onUpdate:modelValue":[g[1]||(g[1]=f=>isRef(o)?o.value=f:null),l],autofocus:"",required:""},null,8,["modelValue"])]),_:1},8,["description"])):unref(n)==="message"?(openBlock(),createBlock(B,{key:2,description:unref(i)("models.form.actions.message_desc")},{default:withCtx(()=>[createVNode(unref(T),{modelValue:unref(a),"onUpdate:modelValue":g[2]||(g[2]=f=>isRef(a)?a.value=f:null),extensions:[unref(html)()],style:{height:"200px"},autofocus:"",required:"",onChange:l},null,8,["modelValue","extensions"])]),_:1},8,["description"])):unref(n)==="snippet"?(openBlock(),createBlock(B,{key:3,description:unref(i)("models.form.actions.snippet_desc")},{default:withCtx(()=>[createVNode(x,{modelValue:unref(s),"onUpdate:modelValue":[g[3]||(g[3]=f=>isRef(s)?s.value=f:null),l],url:"mgr/elements/snippets","text-field":"name",autofocus:"",required:""},{default:withCtx(({item:f})=>{var D;return[(D=f.category)!=null&&D.id?(openBlock(),createElementBlock("div",_hoisted_1$2,toDisplayString(f.category.category)+" /",1)):createCommentVNode("",!0),createTextVNode(" "+toDisplayString(f.name),1)]}),_:1},8,["modelValue"])]),_:1},8,["description"])):createCommentVNode("",!0)])}}}),_hoisted_1$1={key:0,class:"d-flex flex-column mb-2 gap-2"},_hoisted_2$1={class:"d-flex flex-column flex-md-row gap-1 gap-md-2"},_hoisted_3$1=createBaseVNode("i",{class:"icon icon-edit fa-fw"},null,-1),_hoisted_4$1=createBaseVNode("i",{class:"icon icon-times fa-fw"},null,-1),_hoisted_5={key:0,class:"small text-secondary"},_hoisted_6=["innerHTML"],_sfc_main$4=defineComponent({__name:"form-emails",props:{modelValue:{type:Array,required:!0}},emits:["update:modelValue"],setup(r,{emit:m}){const d=r,i=useLexicon,e=m,n=ref([]),o=ref(!1),a=ref({}),s=ref(),y=ref();d.modelValue&&d.modelValue.length>0&&(n.value=d.modelValue);const l=computed(()=>a.value&&Object.keys(a.value).length&&a.value.to&&(a.value.to.includes("@")||a.value.to.includes("[[+"))&&a.value.subject);function _(){a.value={to:"",subject:"",chunk:0,idx:null},o.value=!0}function V(v){a.value={...n.value[v],idx:v},o.value=!0}function g(){if(l.value){const{idx:v}=a.value;delete a.value.idx,v===null?n.value.push(a.value):n.value[v]=a.value,S()}}function k(v){n.value.splice(v,1)}function h(v){v.code==="Escape"?(v.stopPropagation(),v.preventDefault(),S()):v.code==="Enter"&&(v.stopPropagation(),v.preventDefault(),g())}function B(){y.value&&y.value.$el.focus()}function S(){s.value?s.value.hide():o.value=!0}return watch(n,v=>{v.length>0?e("update:modelValue",v):e("update:modelValue",null)},{deep:!0}),onMounted(()=>{n.value.length||_()}),(v,x)=>{const f=Ut,D=tc,u=Bt,C=Ou,P=Vu,O=_sfc_main$6,L=vi,F=_sfc_main$7;return openBlock(),createElementBlock("div",null,[unref(n).length?(openBlock(),createElementBlock("div",_hoisted_1$1,[(openBlock(!0),createElementBlock(Fragment,null,renderList(unref(n),(w,b)=>(openBlock(),createElementBlock("div",{key:b,class:"d-flex align-items-center"},[createVNode(D,{class:"w-100"},{default:withCtx(()=>[createVNode(f,{md:"4"},{default:withCtx(()=>[createTextVNode(toDisplayString(unref(i)("models.form.emails.to"))+": "+toDisplayString(w.to),1)]),_:2},1024),createVNode(f,{md:"5"},{default:withCtx(()=>[createTextVNode(toDisplayString(unref(i)("models.form.emails.subject"))+": "+toDisplayString(w.subject),1)]),_:2},1024),createVNode(f,{md:"3"},{default:withCtx(()=>[w.chunk?(openBlock(),createElementBlock(Fragment,{key:0},[createTextVNode(toDisplayString(unref(i)("models.form.emails.chunk"))+": #"+toDisplayString(w.chunk),1)],64)):createCommentVNode("",!0)]),_:2},1024)]),_:2},1024),createBaseVNode("div",_hoisted_2$1,[createVNode(u,{variant:"outline-secondary",size:"sm",onClick:()=>V(b)},{default:withCtx(()=>[_hoisted_3$1]),_:2},1032,["onClick"]),createVNode(u,{variant:"outline-danger",size:"sm",onClick:()=>k(b)},{default:withCtx(()=>[_hoisted_4$1]),_:2},1032,["onClick"])])]))),128))])):createCommentVNode("",!0),createVNode(u,{variant:"outline-secondary",size:"sm",onClick:_},{default:withCtx(()=>[createTextVNode(toDisplayString(unref(i)("models.form.emails.add")),1)]),_:1}),unref(o)?(openBlock(),createBlock(F,{key:1,ref_key:"modal",ref:s,onKeydown:h,onShown:B,onHidden:x[3]||(x[3]=w=>o.value=!1)},{title:withCtx(()=>[createTextVNode(toDisplayString(unref(i)("models.form.emails.add")),1)]),footer:withCtx(({hide:w})=>[createVNode(u,{onClick:()=>w()},{default:withCtx(()=>[createTextVNode(toDisplayString(unref(i)("actions.cancel")),1)]),_:2},1032,["onClick"]),createVNode(u,{variant:"primary",disabled:!unref(l),onClick:g},{default:withCtx(()=>[createTextVNode(toDisplayString(unref(i)("actions.add")),1)]),_:1},8,["disabled"])]),default:withCtx(()=>[createVNode(P,{label:unref(i)("models.form.emails.to")},{default:withCtx(()=>[createVNode(C,{ref_key:"input",ref:y,modelValue:unref(a).to,"onUpdate:modelValue":x[0]||(x[0]=w=>unref(a).to=w),type:"email",autofocus:""},null,8,["modelValue"])]),_:1},8,["label"]),createVNode(P,{label:unref(i)("models.form.emails.subject")},{default:withCtx(()=>[createVNode(C,{modelValue:unref(a).subject,"onUpdate:modelValue":x[1]||(x[1]=w=>unref(a).subject=w)},null,8,["modelValue"])]),_:1},8,["label"]),createVNode(P,{label:unref(i)("models.form.emails.chunk")},{default:withCtx(()=>[createVNode(O,{modelValue:unref(a).chunk,"onUpdate:modelValue":x[2]||(x[2]=w=>unref(a).chunk=w),url:"mgr/elements/chunks","text-field":"name"},{default:withCtx(({item:w})=>{var b;return[(b=w.category)!=null&&b.id?(openBlock(),createElementBlock("div",_hoisted_5,toDisplayString(w.category.category)+" /",1)):createCommentVNode("",!0),createTextVNode(" "+toDisplayString(w.name),1)]}),_:1},8,["modelValue"])]),_:1},8,["label"]),createVNode(L,{"model-value":!0,variant:"light"},{default:withCtx(()=>[createBaseVNode("div",{innerHTML:unref(i)("models.form.emails.desc")},null,8,_hoisted_6)]),_:1})]),_:1},512)):createCommentVNode("",!0)])}}});function useCheckSchema(values){try{const obj=eval("("+values.schema+")");if(obj)return obj}catch(r){return!1}}const _sfc_main$3=defineComponent({__name:"vueform",props:{modelValue:{type:Object,default:()=>{}},schema:{type:String,required:!0},disabled:{type:Boolean,default:!1},sync:{type:Boolean,default:!1}},setup(r){const m=r,d=computed(()=>{const i={...m};delete i.schema;const e=useCheckSchema({schema:m.schema});return e?"schema"in e?{...e,...i}:{...i,schema:e}:{...i,schema:{}}});return(i,e)=>{const n=resolveComponent("Vueform",!0);return openBlock(),createBlock(n,normalizeProps(guardReactiveProps(unref(d))),null,16)}}}),_hoisted_1={class:"form-control p-0 overflow-hidden"},_hoisted_2={class:"vueform-app bg-light p-3 border rounded"},_hoisted_3=["innerHTML"],_hoisted_4={key:0,class:"small text-secondary"},_sfc_main$2=defineComponent({__name:"form",props:{modelValue:{type:Object,required:!0}},emits:["update:modelValue"],setup(r,{expose:m,emit:d}){const i=r,e=useLexicon,n=d,o=computed({get(){return i.modelValue},set(y){n("update:modelValue",y)}}),a=computed(()=>!!useCheckSchema(o.value));function s(y){return useCheckSchema(y)?y:useLexicon("errors.form.schema")}return m({verify:s}),(y,l)=>{const _=Ou,V=Vu,g=kn,k=mc,h=_sfc_main$3,B=yc,S=_sfc_main$6,v=_sfc_main$4,x=_sfc_main$5;return openBlock(),createElementBlock("div",null,[createVNode(V,{label:unref(e)("models.form.title")},{default:withCtx(()=>[createVNode(_,{modelValue:unref(o).title,"onUpdate:modelValue":l[0]||(l[0]=f=>unref(o).title=f),required:""},null,8,["modelValue"])]),_:1},8,["label"]),createVNode(V,null,{default:withCtx(()=>[createVNode(g,{modelValue:unref(o).active,"onUpdate:modelValue":l[1]||(l[1]=f=>unref(o).active=f)},{default:withCtx(()=>[createTextVNode(toDisplayString(unref(e)("models.form.active")),1)]),_:1},8,["modelValue"])]),_:1}),createVNode(B,{"content-class":"pt-2 mb-3"},{default:withCtx(()=>[createVNode(k,{title:unref(e)("models.form.schema")},{default:withCtx(()=>[createBaseVNode("div",_hoisted_1,[createVNode(unref(T),{modelValue:unref(o).schema,"onUpdate:modelValue":l[2]||(l[2]=f=>unref(o).schema=f),extensions:[unref(javascript)()],style:{height:"400px"}},null,8,["modelValue","extensions"])])]),_:1},8,["title"]),createVNode(k,{title:unref(e)("models.form.preview"),disabled:!unref(a),lazy:""},{default:withCtx(()=>[createBaseVNode("div",_hoisted_2,[createVNode(h,{schema:unref(o).schema,disabled:""},null,8,["schema"])])]),_:1},8,["title","disabled"]),createVNode(k,{title:unref(e)("models.form.help")},{default:withCtx(()=>[createBaseVNode("div",{class:"bg-light p-3 border rounded",innerHTML:unref(e)("models.form.help_text")},null,8,_hoisted_3)]),_:1},8,["title"])]),_:1}),createVNode(V,{label:unref(e)("models.form.prepare_snippet"),description:unref(e)("models.form.prepare_snippet_desc")},{default:withCtx(()=>[createVNode(S,{modelValue:unref(o).prepare_id,"onUpdate:modelValue":l[3]||(l[3]=f=>unref(o).prepare_id=f),url:"mgr/elements/snippets","text-field":"name"},{default:withCtx(({item:f})=>{var D;return[(D=f.category)!=null&&D.id?(openBlock(),createElementBlock("div",_hoisted_4,toDisplayString(f.category.category)+" /",1)):createCommentVNode("",!0),createTextVNode(" "+toDisplayString(f.name),1)]}),_:1},8,["modelValue"])]),_:1},8,["label","description"]),createVNode(V,null,{default:withCtx(()=>[createVNode(g,{modelValue:unref(o).email,"onUpdate:modelValue":l[4]||(l[4]=f=>unref(o).email=f)},{default:withCtx(()=>[createTextVNode(toDisplayString(unref(e)("models.form.email")),1)]),_:1},8,["modelValue"]),unref(o).email?(openBlock(),createBlock(v,{key:0,modelValue:unref(o).emails,"onUpdate:modelValue":l[5]||(l[5]=f=>unref(o).emails=f),class:"p-2 bg-light rounded"},null,8,["modelValue"])):createCommentVNode("",!0)]),_:1}),createVNode(x,{modelValue:unref(o).action,"onUpdate:modelValue":l[6]||(l[6]=f=>unref(o).action=f)},null,8,["modelValue"])])}}}),_sfc_main$1=defineComponent({__name:"create",setup(r){const m=ref(),d=ref({title:"",schema:"",active:!0,prepare_id:null,emails:null,action:null}),i={url:"mgr/forms",beforeSubmit(e){var n;return(n=m.value)==null?void 0:n.verify(e)},title:useLexicon("models.form.title_one"),method:"put",size:"lg"};return(e,n)=>{const o=_sfc_main$2,a=_sfc_main$7;return openBlock(),createBlock(a,mergeProps({modelValue:unref(d),"onUpdate:modelValue":n[1]||(n[1]=s=>isRef(d)?d.value=s:null)},i),{"form-fields":withCtx(()=>[createVNode(o,{ref_key:"form",ref:m,modelValue:unref(d),"onUpdate:modelValue":n[0]||(n[0]=s=>isRef(d)?d.value=s:null)},null,8,["modelValue"])]),_:1},16,["modelValue"])}}});function useError(r){const m=useRouter();m&&m.push(r||"/")}const _sfc_main=defineComponent({__name:"edit",async setup(r){let m,d;const i=ref({}),e=ref(),n={url:"mgr/forms/"+useRoute().params.id,beforeSubmit(o){var a;return(a=e.value)==null?void 0:a.verify(o)},title:useLexicon("models.form.title_one"),updateKey:"mgr-forms",method:"patch",size:"lg"};try{i.value=([m,d]=withAsyncContext(()=>useGet(n.url)),m=await m,d(),m)}catch{useError()}return(o,a)=>{const s=_sfc_main$2,y=_sfc_main$7;return openBlock(),createBlock(y,mergeProps({modelValue:unref(i),"onUpdate:modelValue":a[1]||(a[1]=l=>isRef(i)?i.value=l:null)},n),{"form-fields":withCtx(()=>[createVNode(s,{ref_key:"form",ref:e,modelValue:unref(i),"onUpdate:modelValue":a[0]||(a[0]=l=>isRef(i)?i.value=l:null)},null,8,["modelValue"])]),_:1},16,["modelValue"])}}}),__pages_import_0__=()=>__vitePreload(()=>import("./submissions-C_PdzYys.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23])),__pages_import_1__=()=>__vitePreload(()=>import("./view-DX7at-NR.js"),__vite__mapDeps([24,16,5,1,2,3,4,6,7,8,9,10,11,12,13,14,17,18,19,20,21,22,23])),__pages_import_5__=()=>__vitePreload(()=>import("./emails-Y7zRZPfs.js"),__vite__mapDeps([25,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23])),__pages_import_6__=()=>__vitePreload(()=>import("./view-Cw54t5yd.js"),__vite__mapDeps([26,17,5,16,1,2,3,4,6,7,8,9,10,11,12,13,14,18,19,20,21,22,23])),routes=[{name:"submissions",path:"/submissions",component:__pages_import_0__,children:[{name:"submissions-id-view",path:":id/view",component:__pages_import_1__,props:!0}],props:!0},{name:"index",path:"/",component:_sfc_main$8,children:[{name:"index-create",path:"create",component:_sfc_main$1,props:!0},{name:"index-id-edit",path:":id/edit",component:_sfc_main,props:!0}],props:!0},{name:"emails",path:"/emails",component:__pages_import_5__,children:[{name:"emails-id-view",path:":id/view",component:__pages_import_6__,props:!0}],props:!0}],router=createRouter({history:createWebHashHistory(),routes});document.addEventListener("DOMContentLoaded",()=>{createApp(App).use(router).use(_c()).use(src_default,toastOptions).use(vueform,vueFormConfig).mount("#mmx-forms-root")});export{_sfc_main$a as _,_sfc_main$9 as a,_sfc_main$3 as b,_sfc_main$7 as c,useError as u};
