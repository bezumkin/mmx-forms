function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/submissions-Dw4dqVZ0.js","assets/use-api-CABo2mPT.js","assets/vueform-bjGVKQ0y.js","assets/axios-Bo0ATomq.js","assets/moment-Cl4UOzQZ.js","assets/vue-CtCNMA3P.js","assets/popperjs-CBZXh9ac.js","assets/wnumb-BOjvQ4jq.js","assets/trix-ul_qCPMg.js","assets/nouislider-dfTmBPAg.js","assets/vueform-CiCkEoWT.css","assets/vue-toastification-BdZxUhs9.js","assets/ofetch-C3euP1G2.js","assets/destr-CVtkxrq9.js","assets/ufo-DbHr4xTX.js","assets/use-date-DVdoth2I.js","assets/vue-router-0XY2QSw6.js","assets/bootstrap-vue-next-DWmnrxyd.js","assets/codemirror-Dhbez0_B.js","assets/lezer-BmdiRFRL.js","assets/style-mod-Bc2inJdb.js","assets/w3c-keyname-Vcq4gwWv.js","assets/crelt-C8TCjufn.js","assets/vue-codemirror-DmWmgxNk.js","assets/view-CzdulWKg.js","assets/emails-B1P4qEiH.js","assets/view-D--Kx531.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{a6 as resolveComponent,o as openBlock,a as createElementBlock,l as createBaseVNode,x as toDisplayString,u as unref,i as createVNode,w as withCtx,F as Fragment,N as renderList,C as createTextVNode,d as defineComponent,r as ref,c as computed,b as onMounted,V as createSlots,v as mergeProps,G as useAttrs,h as renderSlot,m as normalizeProps,p as guardReactiveProps,y as watch,I as provide,g as createBlock,ad as Suspense,n as normalizeClass,q as createCommentVNode,H as inject,P as withModifiers,M as isRef,ae as withAsyncContext,$ as createApp}from"./vue-CtCNMA3P.js";import{u as useRouter,a as useRoute,c as createRouter,b as createWebHashHistory}from"./vue-router-0XY2QSw6.js";import{T as Td,w as wd,R as Ra,B as Bt,k as ka,U as Ut,O as Ou,m as md,t as tc,p as pc,a as Ud,C as Ca,b as wn,c as po,M as Mu,V as Vu,d as Ma,o as ou,W as Wi,v as vi,e as kn,f as mc,y as yc,_ as _c}from"./bootstrap-vue-next-DWmnrxyd.js";import{_ as _export_sfc,v as vueform}from"./vueform-bjGVKQ0y.js";import{s as src_default}from"./vue-toastification-BdZxUhs9.js";import{u as useLexicon,a as useGet,b as useDelete,c as useToastError,d as usePut,e as usePatch,f as usePost,t as toastOptions,v as vueFormConfig}from"./use-api-CABo2mPT.js";import{h as html,j as javascript}from"./codemirror-Dhbez0_B.js";import{T}from"./vue-codemirror-DmWmgxNk.js";import"./axios-Bo0ATomq.js";import"./moment-Cl4UOzQZ.js";import"./popperjs-CBZXh9ac.js";import"./wnumb-BOjvQ4jq.js";import"./trix-ul_qCPMg.js";import"./nouislider-dfTmBPAg.js";import"./ofetch-C3euP1G2.js";import"./destr-CVtkxrq9.js";import"./ufo-DbHr4xTX.js";import"./lezer-BmdiRFRL.js";import"./style-mod-Bc2inJdb.js";import"./w3c-keyname-Vcq4gwWv.js";import"./crelt-C8TCjufn.js";const _hoisted_1$6={class:"overflow-auto vh-100 p-3"},_hoisted_2$5={class:"m-0"},_hoisted_3$4={class:"small text-secondary"},_hoisted_4$2={class:"main-wrapper"},_sfc_main$b={__name:"app",setup(r){const d=useLexicon,m=[{title:"models.form.title_many",route:"index"},{title:"models.submission.title_many",route:"submissions"},{title:"models.email.title_many",route:"emails"}];return(s,e)=>{const n=Td,o=wd,a=resolveComponent("RouterView");return openBlock(),createElementBlock("div",_hoisted_1$6,[createBaseVNode("h4",_hoisted_2$5,toDisplayString(unref(d)("menu_name")),1),createBaseVNode("div",_hoisted_3$4,toDisplayString(unref(d)("menu_desc")),1),createVNode(o,{tabs:"",class:"justify-content-between justify-content-md-start mt-3"},{default:withCtx(()=>[(openBlock(),createElementBlock(Fragment,null,renderList(m,(i,v)=>createVNode(n,{key:v,to:{name:i.route},"active-class":"active"},{default:withCtx(()=>[createTextVNode(toDisplayString(unref(d)(i.title)),1)]),_:2},1032,["to"])),64))]),_:1}),createBaseVNode("div",_hoisted_4$2,[createVNode(a)])])}}},App=_export_sfc(_sfc_main$b,[["__scopeId","data-v-76f72b56"]]),scriptRel="modulepreload",assetsURL=function(r){return"/assets/components/mmx-forms/"+r},seen={},__vitePreload=function(d,m,s){let e=Promise.resolve();if(m&&m.length>0){const n=document.getElementsByTagName("link");e=Promise.all(m.map(o=>{if(o=assetsURL(o),o in seen)return;seen[o]=!0;const a=o.endsWith(".css"),i=a?'[rel="stylesheet"]':"";if(!!s)for(let _=n.length-1;_>=0;_--){const h=n[_];if(h.href===o&&(!a||h.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${i}`))return;const l=document.createElement("link");if(l.rel=a?"stylesheet":scriptRel,a||(l.as="script",l.crossOrigin=""),l.href=o,document.head.appendChild(l),a)return new Promise((_,h)=>{l.addEventListener("load",_),l.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${o}`)))})}))}return e.then(()=>d()).catch(n=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=n,window.dispatchEvent(o),!o.defaultPrevented)throw n})},_hoisted_1$5={class:"mmx-modal mmx-confirm"},_sfc_main$a=defineComponent({__name:"confirm",props:{...Ra.props,onOk:{type:Function,default:()=>{}},show:{type:Boolean,default:!0},title:{type:String,default:"components.delete.title"},centered:{type:Boolean,default:!1},okVariant:{type:String,default:"danger"},okTitle:{type:String,default:"actions.ok"},cancelTitle:{type:String,default:"actions.cancel"},teleportDisabled:{type:Boolean,default:!0}},setup(r,{expose:d}){const m=useLexicon,s=ref(),e=r,n=ref(!1),o=computed(()=>{const l={...useAttrs(),...e};return delete l.modelValue,delete l.show,l.onShown||(l.onShown=v),l});function a(){s.value.$emit("hide"),n.value=!1}function i(){a(),e.onOk()}function v(){const l=document.querySelector('.mmx-confirm button[name="ok"]');l&&l.focus()}return onMounted(()=>{e.show&&(n.value=!0)}),d({hide:a,ok:i}),(l,_)=>{const h=Bt;return openBlock(),createElementBlock("section",_hoisted_1$5,[createVNode(unref(Ra),mergeProps({ref_key:"modal",ref:s,"model-value":n.value},o.value,{title:unref(m)(r.title)}),createSlots({footer:withCtx(()=>[renderSlot(l.$slots,"footer",mergeProps({ref:"footer"},{hide:a}),()=>[createVNode(h,{name:"cancel",variant:e.cancelVariant,onClick:a},{default:withCtx(()=>[createTextVNode(toDisplayString(unref(m)(r.cancelTitle)),1)]),_:1},8,["variant"]),createVNode(h,{name:"ok",variant:e.okVariant,onClick:i},{default:withCtx(()=>[createTextVNode(toDisplayString(unref(m)(r.okTitle)),1)]),_:1},8,["variant"])])]),_:2},[renderList(Object.keys(l.$slots),k=>({name:k,fn:withCtx(g=>[renderSlot(l.$slots,k,normalizeProps(guardReactiveProps(g)))])}))]),1040,["model-value","title"])])}}});function useConfig(r){var m;const d=((m=window.MODx)==null?void 0:m.config)||{};return r in d?d[r]:void 0}const _hoisted_1$4={class:"mmx-table"},_hoisted_2$4=createBaseVNode("i",{class:"icon icon-times fa-fw"},null,-1),_hoisted_3$3={key:1,class:"icon icon-repeat fa-fw"},_hoisted_4$1=["innerHTML"],_sfc_main$9=defineComponent({__name:"table",props:{modelValue:{type:Number,default:null},url:{type:String,required:!0,default:""},fields:{type:Array,default(){return[]}},filters:{type:Object,default(){return{}}},updateKey:{type:String,default:""},primaryKey:{type:[String,Array],default:"id"},sort:{type:String,default:null},dir:{type:String,default:"asc"},limit:{type:Number,default:Number(useConfig("default_per_page"))||20},stacked:{type:String,default:void 0},responsive:{type:Boolean,default:!0},showEmpty:{type:Boolean,default:!0},headerActions:{type:Array,default(){return[]}},tableActions:{type:Array,default(){return[]}},rowClass:{type:Function,default(){return""}},tableClass:{type:[String,Array,Object],default:"mt-3 mt-md-0"},pageLimit:{type:Number,default:7},onLoad:{type:Function,default(r){return r}},emptyText:{type:String,default:"components.no_data"},emptyFilteredText:{type:String,default:"components.no_results"},deleteTitle:{type:String,default:"components.delete.title"},deleteText:{type:String,default:"components.delete.confirm"}},emits:["update:modelValue","update:sort","update:dir","update:limit","update:filters","delete"],setup(r,{expose:d,emit:m}){const s=m,e=r,n=useLexicon,o=ref(1),a=ref(e.sort),i=ref(e.dir),v=ref(e.limit),l=ref(e.filters),_=computed({get(){return e.modelValue===null?o.value:e.modelValue},set(t){o.value=Number(t),s("update:modelValue",t)}}),h=computed(()=>{const t=[...e.fields];return e.tableActions.length&&t.findIndex(c=>c.key==="actions")===-1&&t.push({key:"actions",label:"",class:"table-actions"}),t}),k=computed(()=>Object.keys(l.value).includes("query")),g=ref(!1),y=ref(0),B=ref([]),N=ref(!1),f=ref(!1),V=ref({}),R={item:V,visible:N,loading:f,deleteItem:C},L=computed(()=>({limit:e.limit,page:_.value,...O(!0)}));function u(t,c){a.value=t,i.value=c?"desc":"asc",b()}function w(t,c){if(!t.route)return;t.map||(t.map={},Array.isArray(e.primaryKey)?e.primaryKey.forEach(S=>{t.map[S]=S}):t.map[e.primaryKey]=e.primaryKey);const p={};for(const S of Object.keys(t.map)){const A=t.map[S];if(/\./.test(A)){const j=A.split(".");let z={...c};for(const F of j)z=z[F];p[S]=z}else p[S]=c[A]}return{...t.route,params:p}}function $(t,c=void 0){t.function&&typeof t.function=="function"&&(c?t.function(JSON.parse(JSON.stringify(c))):t.function())}function O(t=!1){const c={};return Object.keys(e.filters).forEach(p=>{e.filters[p]!==""&&e.filters[p]!==null&&(c[p]=typeof e.filters[p]=="object"&&!t?JSON.stringify(e.filters[p]):e.filters[p])}),a.value&&(c.sort=a.value,c.dir=i.value),t?JSON.parse(JSON.stringify(c)):new URLSearchParams(c).toString()}function D(t){N.value=!0,V.value=t}function E(){N.value=!1,V.value={}}async function C(){f.value=!0;const t=V.value;try{if(Array.isArray(e.primaryKey)){const c={};e.primaryKey.forEach(p=>{c[p]=t[p]}),await useDelete(e.url,c)}else t[e.primaryKey]?await useDelete(e.url+"/"+t[e.primaryKey]):await useDelete(e.url,t);N.value=!1,await b()}catch{}finally{f.value=!1}}d({getParams:O,page:_,sort:a,dir:i,loading:g,delete:D,refresh:b,items:B}),watch(_,()=>{b()}),watch(l,()=>{_.value!==1&&(_.value=1),b()},{deep:!0});async function b(){if(!g.value)try{g.value=!0;const t=e.onLoad(await useGet(e.url,L.value));B.value=t.rows||[],y.value=t.total||0}catch{}finally{g.value=!1}}b();const U=e.updateKey||e.url.split("/").join("-");return provide("refreshTable",t=>{U===t&&b()}),(t,c)=>{const p=Bt,S=Ut,A=Ou,j=md,z=tc,F=pc,M=ka,q=Ud,K=Ca,H=_sfc_main$a;return openBlock(),createElementBlock("section",_hoisted_1$4,[renderSlot(t.$slots,"header",{},()=>[createVNode(z,{class:"align-items-center mb-3"},{default:withCtx(()=>[createVNode(S,{md:"4"},{default:withCtx(()=>[renderSlot(t.$slots,"header-start",{},()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(r.headerActions,(x,P)=>(openBlock(),createBlock(p,{key:P,size:x.size||"md",variant:x.variant||"secondary",class:normalizeClass(x.class||(P?"col-12 col-md-auto ms-md-2 mt-2 mt-md-0":"col-12 col-md-auto")),to:x.route,onClick:I=>$(x)},{default:withCtx(()=>[x.icon?(openBlock(),createElementBlock("i",{key:0,class:normalizeClass(`icon icon-${x.icon} fa-fw`)},null,2)):createCommentVNode("",!0),createTextVNode(" "+toDisplayString(x.title),1)]),_:2},1032,["size","variant","class","to","onClick"]))),128))])]),_:3}),createVNode(S,{md:"4"},{default:withCtx(()=>[renderSlot(t.$slots,"header-middle")]),_:3}),createVNode(S,{md:"4",class:"mt-2 mt-md-0"},{default:withCtx(()=>[renderSlot(t.$slots,"header-end",{},()=>[k.value?(openBlock(),createBlock(j,{key:0},{append:withCtx(()=>[createVNode(p,{disabled:!l.value.query,onClick:c[0]||(c[0]=x=>l.value.query=null)},{default:withCtx(()=>[_hoisted_2$4]),_:1},8,["disabled"])]),default:withCtx(()=>[createVNode(A,{modelValue:l.value.query,"onUpdate:modelValue":c[1]||(c[1]=x=>l.value.query=x),placeholder:unref(n)("components.query")},null,8,["modelValue","placeholder"])]),_:1})):createCommentVNode("",!0)])]),_:3})]),_:3})]),createVNode(M,{show:g.value,opacity:"0.25"},{default:withCtx(()=>[createVNode(F,{items:B.value,fields:h.value,class:normalizeClass(r.tableClass),"per-page":v.value,"sort-by":a.value,"sort-desc":i.value==="desc","empty-text":unref(n)(r.emptyText),"empty-filtered-text":unref(n)(r.emptyFilteredText),stacked:r.stacked,responsive:r.responsive,"show-empty":r.showEmpty,"sort-internal":!1,"tbody-tr-class":r.rowClass,onSorted:u},createSlots({"cell(actions)":withCtx(({item:x})=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(r.tableActions,(P,I)=>(openBlock(),createElementBlock(Fragment,null,[typeof P.isActive!="function"||P.isActive(x)===!0?(openBlock(),createBlock(p,mergeProps({key:I,size:P.size||"sm",variant:P.variant||"secondary",class:P.class},P.route?{to:w(P,x)}:{},{onClick:G=>$(P,x)}),{default:withCtx(()=>[P.icon?(openBlock(),createElementBlock("i",{key:0,class:normalizeClass(`icon icon-${P.icon} fa-fw`)},null,2)):(openBlock(),createElementBlock(Fragment,{key:1},[createTextVNode(toDisplayString(P.title),1)],64))]),_:2},1040,["size","variant","class","onClick"])):createCommentVNode("",!0)],64))),256))]),_:2},[renderList(Object.keys(t.$slots),x=>({name:x,fn:withCtx(P=>[x!=="default"?renderSlot(t.$slots,x,normalizeProps(mergeProps({key:0},P))):createCommentVNode("",!0)])}))]),1032,["items","fields","class","per-page","sort-by","sort-desc","empty-text","empty-filtered-text","stacked","responsive","show-empty","tbody-tr-class"])]),_:3},8,["show"]),renderSlot(t.$slots,"footer",normalizeProps(guardReactiveProps({refresh:b,total:y.value,page:_.value,limit:r.limit,loading:g.value})),()=>[createVNode(z,{class:"mt-5 align-items-center justify-content-center justify-content-md-start","no-gutters":""},{default:withCtx(()=>[createVNode(S,{cols:"12",md:"auto",class:"d-flex justify-content-center"},{default:withCtx(()=>[renderSlot(t.$slots,"pagination",normalizeProps(guardReactiveProps({refresh:b,total:y.value,page:_.value,limit:r.limit,loading:g.value})),()=>[y.value>r.limit?(openBlock(),createBlock(q,{key:0,modelValue:_.value,"onUpdate:modelValue":c[2]||(c[2]=x=>_.value=x),"total-rows":y.value,"per-page":r.limit,limit:r.pageLimit,class:"mb-md-0 me-md-3"},null,8,["modelValue","total-rows","per-page","limit"])):createCommentVNode("",!0)])]),_:3}),createVNode(S,{cols:"12",md:"auto",class:"d-flex align-items-center justify-content-center gap-2"},{default:withCtx(()=>[renderSlot(t.$slots,"pagination-data",normalizeProps(guardReactiveProps({refresh:b,total:y.value,page:_.value,limit:r.limit,loading:g.value})),()=>[createVNode(p,{class:"border-0",onClick:c[3]||(c[3]=()=>b())},{default:withCtx(()=>[g.value?(openBlock(),createBlock(K,{key:0,small:!0})):(openBlock(),createElementBlock("i",_hoisted_3$3))]),_:1}),createTextVNode(" "+toDisplayString(unref(n)("components.records",{total:y.value},y.value)),1)])]),_:3})]),_:3})]),(openBlock(),createBlock(Suspense,null,{default:withCtx(()=>[renderSlot(t.$slots,"default")]),_:3})),renderSlot(t.$slots,"delete",normalizeProps(guardReactiveProps(R)),()=>[N.value?(openBlock(),createBlock(H,{key:0,title:r.deleteTitle,"on-ok":C,"ok-title":"actions.delete",onHidden:E},{default:withCtx(()=>[createVNode(M,{opacity:.5,show:f.value},{default:withCtx(()=>[createBaseVNode("div",{innerHTML:unref(n)(r.deleteText)},null,8,_hoisted_4$1)]),_:1},8,["show"])]),_:1},8,["title"])):createCommentVNode("",!0)])])}}}),url="mgr/forms",_sfc_main$8=defineComponent({__name:"index",setup(r){const d=useLexicon,m=ref(),s=computed(()=>[{route:{name:"index-create"},icon:"plus",title:d("actions.create")}]),e=computed(()=>[{key:"id",label:d("models.form.id"),sortable:!0},{key:"title",label:d("models.form.title"),sortable:!0},{key:"submissions_count",label:d("models.submission.title_many"),sortable:!0},{key:"emails_count",label:d("models.email.title_many"),sortable:!0}]),n=computed(()=>{var i;return[{route:{name:"index-id-edit"},icon:"edit",title:d("actions.edit")},{function:(i=m.value)==null?void 0:i.delete,icon:"times",title:d("actions.delete"),variant:"danger"}]}),o=ref({query:""});function a(i){if(i){const v=[];return i.active||v.push("inactive"),v}}return(i,v)=>{const l=resolveComponent("RouterView"),_=_sfc_main$9;return openBlock(),createBlock(_,{ref_key:"table",ref:m,url,"header-actions":unref(s),"table-actions":unref(n),fields:unref(e),filters:unref(o),"row-class":a,sort:"id",dir:"desc"},{default:withCtx(()=>[createVNode(l)]),_:1},8,["header-actions","table-actions","fields","filters"])}}}),_hoisted_1$3={class:"mmx-modal"},_hoisted_2$3=createBaseVNode("input",{type:"submit",class:"d-none"},null,-1),_sfc_main$7=defineComponent({__name:"modal",props:{...Ra.props,url:{type:String,default:""},modelValue:{type:Object,default(){return{}}},method:{type:String,default:"POST"},updateKey:{type:String,default:""},show:{type:Boolean,default:!0},okTitle:{type:String,default:"actions.submit"},cancelTitle:{type:String,default:"actions.cancel"},beforeSubmit:{type:Function,default(r){return r}},teleportDisabled:{type:Boolean,default:!0}},emits:["update:modelValue","after-submit"],setup(r,{expose:d,emit:m}){var L;const s=m,e=ref(),n=ref(),o=useRouter(),a=useRoute(),i=ref(!1),v=computed({get(){return l.modelValue},set(u){s("update:modelValue",u)}}),l=r,_=ref(!1),h=computed(()=>{const u={...useAttrs(),...l};return delete u.modelValue,delete u.show,delete u.url,delete u.method,delete u.beforeSubmit,u.onHidden||(u.onHidden=N),u.onShown||(u.onShown=f),u}),k=l.updateKey||((L=l.url)==null?void 0:L.split("/").join("-"));function g(){if(n.value&&n.value.$el){const u=n.value.$el.querySelector('[type="submit"]');u?u.click():u()}else y()}async function y(){if(l.url)try{const u=l.beforeSubmit(JSON.parse(JSON.stringify(v.value)));if(u)if(typeof u=="string")useToastError(u);else{i.value=!0;const w=l.method.toLowerCase(),$={put:usePut,patch:usePatch},D=await(w in $?$[w]:usePost)(l.url,u);s("after-submit",D),B(),R(k)}}catch{}finally{i.value=!1}}function B(){e.value.$emit("hide"),_.value=!1}function N(){const u=a.matched.findIndex(w=>w.name===a.name);u>0&&a.matched[u-1]?o.push({name:a.matched[u-1].name}):o.go(-1)}function f(){if(n.value&&n.value.$el){const u=n.value.$el.querySelector("input:not(:disabled)");u&&u.focus()}}function V(u){(u.metaKey||u.ctrlKey)&&u.code==="KeyS"&&(u.preventDefault(),g())}onMounted(()=>{l.show&&(_.value=!0)}),d({hide:B,submit:y,formSubmit:g});const R=inject("refreshTable")||function(u){};return(u,w)=>{const $=wn,O=ka,D=Bt;return openBlock(),createElementBlock("section",_hoisted_1$3,[createVNode(unref(Ra),mergeProps({ref_key:"modal",ref:e,modelValue:_.value,"onUpdate:modelValue":w[0]||(w[0]=E=>_.value=E)},h.value),createSlots({default:withCtx(()=>[createVNode(O,{opacity:.5,show:i.value},{default:withCtx(()=>[createVNode($,{ref_key:"form",ref:n,onSubmit:withModifiers(y,["prevent"]),onKeydown:V},{default:withCtx(()=>[renderSlot(u.$slots,"form-fields",normalizeProps(guardReactiveProps({record:v.value,loading:i.value,hide:B,submit:y}))),_hoisted_2$3]),_:3},512)]),_:3},8,["show"])]),footer:withCtx(()=>[renderSlot(u.$slots,"footer",normalizeProps(guardReactiveProps({record:v.value,loading:i.value,hide:B,submit:y,formSubmit:g})),()=>[createVNode(D,{variant:l.cancelVariant,disabled:i.value,onClick:B},{default:withCtx(()=>[createTextVNode(toDisplayString(unref(useLexicon)(r.cancelTitle)),1)]),_:1},8,["variant","disabled"]),r.url?(openBlock(),createBlock(D,{key:0,variant:l.okVariant,disabled:i.value,onClick:withModifiers(g,["prevent"])},{default:withCtx(()=>[createTextVNode(toDisplayString(unref(useLexicon)(r.okTitle)),1)]),_:1},8,["variant","disabled"])):createCommentVNode("",!0)])]),_:2},[renderList(Object.keys(u.$slots),E=>({name:E,fn:withCtx(C=>[renderSlot(u.$slots,E,normalizeProps(guardReactiveProps({...C,record:v.value,loading:i.value,hide:B,submit:y,formSubmit:g})))])}))]),1040,["modelValue"])])}}}),_sfc_main$6=defineComponent({__name:"form-action",props:{modelValue:{type:Object,required:!0}},emits:["update:modelValue"],setup(r,{emit:d}){const m=r,s=useLexicon,e=d,n=ref(),o=ref(),a=ref(),i=["reset","message","redirect"];m.modelValue?(n.value=m.modelValue.type,n.value==="message"?a.value=m.modelValue.value:o.value=m.modelValue.value):n.value="reset";function v(_){_.length>0?e("update:modelValue",{type:n,value:_}):e("update:modelValue",null)}function l(){e("update:modelValue",null)}return(_,h)=>{const k=po,g=Mu,y=Vu,B=Ma,N=Ou;return openBlock(),createElementBlock("div",null,[createVNode(y,{label:unref(s)("models.form.action"),description:unref(s)("models.form.action_desc")},{default:withCtx(()=>[createVNode(g,{modelValue:unref(n),"onUpdate:modelValue":h[0]||(h[0]=f=>isRef(n)?n.value=f:null),onChange:l},{default:withCtx(()=>[(openBlock(),createElementBlock(Fragment,null,renderList(i,f=>createVNode(k,{key:f,value:f},{default:withCtx(()=>[createTextVNode(toDisplayString(unref(s)("models.form.actions."+f)),1)]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"])]),_:1},8,["label","description"]),unref(n)==="reset"?(openBlock(),createBlock(B,{key:0},{default:withCtx(()=>[createTextVNode(toDisplayString(unref(s)("models.form.actions.reset_desc")),1)]),_:1})):createCommentVNode("",!0),unref(n)==="redirect"?(openBlock(),createBlock(y,{key:1,description:unref(s)("models.form.actions.redirect_desc")},{default:withCtx(()=>[createVNode(N,{modelValue:unref(o),"onUpdate:modelValue":[h[1]||(h[1]=f=>isRef(o)?o.value=f:null),v],autofocus:"",required:""},null,8,["modelValue"])]),_:1},8,["description"])):createCommentVNode("",!0),unref(n)==="message"?(openBlock(),createBlock(y,{key:2,description:unref(s)("models.form.actions.message_desc")},{default:withCtx(()=>[createVNode(unref(T),{modelValue:unref(a),"onUpdate:modelValue":h[2]||(h[2]=f=>isRef(a)?a.value=f:null),extensions:[unref(html)()],style:{height:"200px"},autofocus:"",required:"",onChange:v},null,8,["modelValue","extensions"])]),_:1},8,["description"])):createCommentVNode("",!0)])}}}),_hoisted_1$2={class:"mmx-combo"},_hoisted_2$2=createBaseVNode("i",{class:"icon icon-caret-down fa-fw"},null,-1),_hoisted_3$2=["textContent"],_sfc_main$5=defineComponent({__name:"combo-box",props:{...Ou.props,modelValue:{type:[String,Number],default:""},url:{type:String,required:!0},valueField:{type:String,default:"id"},textField:{type:String,default:"title"},limit:{type:Number,default:10},sort:{type:String,default:null},dir:{type:String,default:"asc"},forceSelect:{type:Boolean,default:!1},emptyText:{type:String,default:"No results"},filterProps:{type:Object,default(){return{}}},formatValue:{type:Function,default:void 0},maxPages:{type:Number,default:5},onLoad:{type:Function,default(r){return r}},disabled:{type:Boolean,default:!1}},emits:["update:modelValue","load","failure","change","select","reset","keydown"],setup(r,{expose:d,emit:m}){const s=m,e=r,n=ref(),o=ref([]),a=ref(""),i=ref(null),v=ref(!1),l=ref(""),_=ref(!1),h=ref(e.page||1),k=ref(0),g=ref(!1),y=computed({get(){return e.modelValue||null},set(t){s("update:modelValue",t)}}),B=computed(()=>({type:e.type,autofocus:e.autofocus,placeholder:e.placeholder,required:e.required,readonly:e.readonly,disabled:e.disabled}));watch(()=>e.filterProps,async t=>{const c=JSON.stringify(t);c!==l.value&&(l.value=c,e.lazy||(await f(""),y.value&&o.value.findIndex(p=>p[e.valueField]==y.value)===-1&&V()))}),watch(()=>e.lazy,t=>{t&&N()}),watch(y,t=>{e.skipWatchers||b(t)}),onMounted(()=>{l.value=JSON.stringify(e.filterProps),N()});async function N(){e.lazy||(await f(),y.value&&await b(y.value))}async function f(t=a.value){if(e.url&&!_.value){const c={...e.filterProps,query:t,limit:e.limit,sort:e.sort||e.textField,dir:e.dir,page:h.value,combo:!0};_.value=!0;try{const p=e.onLoad(await useGet(e.url,c));o.value=p.rows||[],k.value=p.total||0,s("load",o.value,k.value)}catch(p){s("failure",p)}finally{_.value=!1}}}function V(){h.value=1,y.value=null,a.value=""}function R(t){h.value=1;const c=o.value[t];if(c)return y.value=c[e.valueField],a.value=U(c),c}function L(t){t.stopPropagation(),$()?w():u()}function u(){v.value=!0,document.addEventListener("click",w,{once:!0})}function w(){v.value=!1,i.value=null}function $(){return v.value}async function O(t){t.length?(g.value=!0,y.value=null,await f(t),u(),g.value=!1):(V(),e.lazy||await f())}function D(t){s("change",t),t&&e.forceSelect&&!y.value&&o.value.length&&E(0)}function E(t,c){c&&n.value.$el.focus();const p=R(t);p&&p[e.valueField]!==y.value&&s("select",p)}function C(t){t.key==="ArrowDown"&&!$()&&o.value.length&&u(),t.key==="ArrowDown"&&(i.value===null||i.value<o.value.length-1)?i.value=i.value===null?0:i.value+1:i.value!==null&&t.key==="ArrowUp"&&(i.value=i.value===0?null:i.value-1),t.key==="Enter"&&($()&&(t.stopPropagation(),t.preventDefault()),typeof i.value=="number"&&(E(i.value),w())),t.key==="Escape"&&$()&&(t.stopPropagation(),t.preventDefault(),w()),s("keydown",t)}async function b(t){if(!t)V();else{if(o.value.findIndex(p=>p[e.valueField]==t)===-1){const p={...e.filterProps,combo:!0};p[e.valueField]=t;const S=await useGet(e.url,p);S[e.valueField]==t&&o.value.push(S)}const c=o.value.findIndex(p=>p[e.valueField]==t);c!==-1&&E(c)}}function U(t){return e.formatValue?e.formatValue(t):t[e.textField]}return watch(h,()=>{f(y.value?"":a.value)}),d({total:k,page:h,limit:e.limit,options:o,externalValue:a}),(t,c)=>{const p=Bt,S=md,A=ou,j=Ud,z=Wi;return openBlock(),createElementBlock("div",_hoisted_1$2,[createVNode(S,null,{append:withCtx(()=>[renderSlot(t.$slots,"append",normalizeProps(guardReactiveProps({toggle:L,disabled:r.disabled,readonly:t.readonly,options:o.value})),()=>[createVNode(p,{disabled:!o.value.length||r.disabled||t.readonly,tabindex:"-1",onClick:withModifiers(L,["prevent"])},{default:withCtx(()=>[_hoisted_2$2]),_:1},8,["disabled"])])]),default:withCtx(()=>[createVNode(unref(Ou),mergeProps({ref_key:"input",ref:n,modelValue:a.value,"onUpdate:modelValue":c[0]||(c[0]=F=>a.value=F)},B.value,{autocomplete:"off",onChange:D,onKeydown:C,"onUpdate:modelValue":O}),null,16,["modelValue"])]),_:3}),createBaseVNode("ul",{class:normalizeClass({"dropdown-menu mmx-combo-list":!0,show:v.value})},[o.value.length?(openBlock(),createElementBlock(Fragment,{key:1},[renderSlot(t.$slots,"list-header",normalizeProps(guardReactiveProps({hideDropdown:w,total:k.value}))),(openBlock(!0),createElementBlock(Fragment,null,renderList(o.value,(F,M)=>(openBlock(),createBlock(A,{key:F[r.valueField],class:normalizeClass({"mmx-combo-list-item":!0}),active:i.value===M,onClick:q=>E(M,q)},{default:withCtx(()=>[renderSlot(t.$slots,"default",normalizeProps(guardReactiveProps({item:F})),()=>[createTextVNode(toDisplayString(U(F)),1)])]),_:2},1032,["active","onClick"]))),128)),renderSlot(t.$slots,"list-footer",normalizeProps(guardReactiveProps({hideDropdown:w,total:k.value})),()=>[k.value>o.value.length?(openBlock(),createBlock(z,{key:0,class:"my-2",onClick:c[2]||(c[2]=F=>F.stopPropagation())},{default:withCtx(()=>[createVNode(j,{modelValue:h.value,"onUpdate:modelValue":c[1]||(c[1]=F=>h.value=F),"per-page":r.limit,limit:r.maxPages,"total-rows":k.value},null,8,["modelValue","per-page","limit","total-rows"])]),_:1})):createCommentVNode("",!0)])],64)):renderSlot(t.$slots,"no-results",normalizeProps(mergeProps({key:0},{hideDropdown:w,emptyText:r.emptyText})),()=>[createBaseVNode("li",{class:"alert alert-info m-0",onClick:w,textContent:toDisplayString(r.emptyText)},null,8,_hoisted_3$2)])],2)])}}}),_hoisted_1$1={key:0,class:"d-flex flex-column mb-2 gap-2"},_hoisted_2$1={class:"d-flex flex-column flex-md-row gap-1 gap-md-2"},_hoisted_3$1=createBaseVNode("i",{class:"icon icon-edit fa-fw"},null,-1),_hoisted_4=createBaseVNode("i",{class:"icon icon-times fa-fw"},null,-1),_hoisted_5=["innerHTML"],_sfc_main$4=defineComponent({__name:"form-emails",props:{modelValue:{type:Array,required:!0}},emits:["update:modelValue"],setup(r,{emit:d}){const m=r,s=useLexicon,e=d,n=ref([]),o=ref(!1),a=ref({}),i=ref(),v=ref();m.modelValue&&m.modelValue.length>0&&(n.value=m.modelValue);const l=computed(()=>a.value&&Object.keys(a.value).length&&a.value.to&&(a.value.to.includes("@")||a.value.to.includes("[[+"))&&a.value.subject);function _(){a.value={to:"",subject:"",chunk:0,idx:null},o.value=!0}function h(f){a.value={...n.value[f],idx:f},o.value=!0}function k(){if(l.value){const{idx:f}=a.value;delete a.value.idx,f===null?n.value.push(a.value):n.value[f]=a.value,N()}}function g(f){n.value.splice(f,1)}function y(f){f.code==="Escape"?(f.stopPropagation(),f.preventDefault(),N()):f.code==="Enter"&&(f.stopPropagation(),f.preventDefault(),k())}function B(){v.value&&v.value.$el.focus()}function N(){i.value?i.value.hide():o.value=!0}return watch(n,f=>{f.length>0?e("update:modelValue",f):e("update:modelValue",null)},{deep:!0}),onMounted(()=>{n.value.length||_()}),(f,V)=>{const R=Ut,L=tc,u=Bt,w=Ou,$=Vu,O=_sfc_main$5,D=vi,E=_sfc_main$7;return openBlock(),createElementBlock("div",null,[unref(n).length?(openBlock(),createElementBlock("div",_hoisted_1$1,[(openBlock(!0),createElementBlock(Fragment,null,renderList(unref(n),(C,b)=>(openBlock(),createElementBlock("div",{key:b,class:"d-flex align-items-center"},[createVNode(L,{class:"w-100"},{default:withCtx(()=>[createVNode(R,{md:"4"},{default:withCtx(()=>[createTextVNode(toDisplayString(unref(s)("models.form.emails.to"))+": "+toDisplayString(C.to),1)]),_:2},1024),createVNode(R,{md:"5"},{default:withCtx(()=>[createTextVNode(toDisplayString(unref(s)("models.form.emails.subject"))+": "+toDisplayString(C.subject),1)]),_:2},1024),createVNode(R,{md:"3"},{default:withCtx(()=>[C.chunk?(openBlock(),createElementBlock(Fragment,{key:0},[createTextVNode(toDisplayString(unref(s)("models.form.emails.chunk"))+": #"+toDisplayString(C.chunk),1)],64)):createCommentVNode("",!0)]),_:2},1024)]),_:2},1024),createBaseVNode("div",_hoisted_2$1,[createVNode(u,{variant:"outline-secondary",size:"sm",onClick:()=>h(b)},{default:withCtx(()=>[_hoisted_3$1]),_:2},1032,["onClick"]),createVNode(u,{variant:"outline-danger",size:"sm",onClick:()=>g(b)},{default:withCtx(()=>[_hoisted_4]),_:2},1032,["onClick"])])]))),128))])):createCommentVNode("",!0),createVNode(u,{variant:"outline-secondary",size:"sm",onClick:_},{default:withCtx(()=>[createTextVNode(toDisplayString(unref(s)("models.form.emails.add")),1)]),_:1}),unref(o)?(openBlock(),createBlock(E,{key:1,ref_key:"modal",ref:i,onKeydown:y,onShown:B,onHidden:V[3]||(V[3]=C=>o.value=!1)},{title:withCtx(()=>[createTextVNode(toDisplayString(unref(s)("models.form.emails.add")),1)]),footer:withCtx(({hide:C})=>[createVNode(u,{onClick:()=>C()},{default:withCtx(()=>[createTextVNode(toDisplayString(unref(s)("actions.cancel")),1)]),_:2},1032,["onClick"]),createVNode(u,{variant:"primary",disabled:!unref(l),onClick:k},{default:withCtx(()=>[createTextVNode(toDisplayString(unref(s)("actions.add")),1)]),_:1},8,["disabled"])]),default:withCtx(()=>[createVNode($,{label:unref(s)("models.form.emails.to")},{default:withCtx(()=>[createVNode(w,{ref_key:"input",ref:v,modelValue:unref(a).to,"onUpdate:modelValue":V[0]||(V[0]=C=>unref(a).to=C),type:"email",autofocus:""},null,8,["modelValue"])]),_:1},8,["label"]),createVNode($,{label:unref(s)("models.form.emails.subject")},{default:withCtx(()=>[createVNode(w,{modelValue:unref(a).subject,"onUpdate:modelValue":V[1]||(V[1]=C=>unref(a).subject=C)},null,8,["modelValue"])]),_:1},8,["label"]),createVNode($,{label:unref(s)("models.form.emails.chunk")},{default:withCtx(()=>[createVNode(O,{modelValue:unref(a).chunk,"onUpdate:modelValue":V[2]||(V[2]=C=>unref(a).chunk=C),url:"mgr/elements/chunks","text-field":"name"},null,8,["modelValue"])]),_:1},8,["label"]),createVNode(D,{"model-value":!0,variant:"light"},{default:withCtx(()=>[createBaseVNode("div",{innerHTML:unref(s)("models.form.emails.desc")},null,8,_hoisted_5)]),_:1})]),_:1},512)):createCommentVNode("",!0)])}}});function useCheckSchema(values){try{const obj=eval("("+values.schema+")");if(obj)return obj}catch(r){return!1}}const _sfc_main$3=defineComponent({__name:"vueform",props:{modelValue:{type:Object,default:()=>{}},schema:{type:String,required:!0},disabled:{type:Boolean,default:!1},sync:{type:Boolean,default:!1}},setup(r){const d=r,m=computed(()=>{const s={...d};delete s.schema;const e=useCheckSchema({schema:d.schema});return e?"schema"in e?{...e,...s}:{...s,schema:e}:{...s,schema:{}}});return(s,e)=>{const n=resolveComponent("Vueform",!0);return openBlock(),createBlock(n,normalizeProps(guardReactiveProps(unref(m))),null,16)}}}),_hoisted_1={class:"form-control p-0 overflow-hidden"},_hoisted_2={class:"vueform-app bg-light p-3 border rounded"},_hoisted_3=["innerHTML"],_sfc_main$2=defineComponent({__name:"form",props:{modelValue:{type:Object,required:!0}},emits:["update:modelValue"],setup(r,{expose:d,emit:m}){const s=r,e=useLexicon,n=m,o=computed({get(){return s.modelValue},set(v){n("update:modelValue",v)}}),a=computed(()=>!!useCheckSchema(o.value));function i(v){return useCheckSchema(v)?v:useLexicon("errors.form.schema")}return d({verify:i}),(v,l)=>{const _=Ou,h=Vu,k=kn,g=mc,y=_sfc_main$3,B=yc,N=_sfc_main$4,f=_sfc_main$6;return openBlock(),createElementBlock("div",null,[createVNode(h,{label:unref(e)("models.form.title")},{default:withCtx(()=>[createVNode(_,{modelValue:unref(o).title,"onUpdate:modelValue":l[0]||(l[0]=V=>unref(o).title=V),required:""},null,8,["modelValue"])]),_:1},8,["label"]),createVNode(h,null,{default:withCtx(()=>[createVNode(k,{modelValue:unref(o).active,"onUpdate:modelValue":l[1]||(l[1]=V=>unref(o).active=V)},{default:withCtx(()=>[createTextVNode(toDisplayString(unref(e)("models.form.active")),1)]),_:1},8,["modelValue"])]),_:1}),createVNode(B,{"content-class":"pt-2"},{default:withCtx(()=>[createVNode(g,{title:unref(e)("models.form.schema")},{default:withCtx(()=>[createBaseVNode("div",_hoisted_1,[createVNode(unref(T),{modelValue:unref(o).schema,"onUpdate:modelValue":l[2]||(l[2]=V=>unref(o).schema=V),extensions:[unref(javascript)()],style:{height:"400px"}},null,8,["modelValue","extensions"])])]),_:1},8,["title"]),createVNode(g,{title:unref(e)("models.form.preview"),disabled:!unref(a),lazy:""},{default:withCtx(()=>[createBaseVNode("div",_hoisted_2,[createVNode(y,{schema:unref(o).schema,disabled:""},null,8,["schema"])])]),_:1},8,["title","disabled"]),createVNode(g,{title:unref(e)("models.form.help")},{default:withCtx(()=>[createBaseVNode("div",{class:"bg-light p-3 border rounded",innerHTML:unref(e)("models.form.help_text")},null,8,_hoisted_3)]),_:1},8,["title"])]),_:1}),createVNode(h,{class:"mt-4"},{default:withCtx(()=>[createVNode(k,{modelValue:unref(o).email,"onUpdate:modelValue":l[3]||(l[3]=V=>unref(o).email=V)},{default:withCtx(()=>[createTextVNode(toDisplayString(unref(e)("models.form.email")),1)]),_:1},8,["modelValue"]),unref(o).email?(openBlock(),createBlock(N,{key:0,modelValue:unref(o).emails,"onUpdate:modelValue":l[4]||(l[4]=V=>unref(o).emails=V),class:"p-2 bg-light rounded"},null,8,["modelValue"])):createCommentVNode("",!0)]),_:1}),createVNode(f,{modelValue:unref(o).action,"onUpdate:modelValue":l[5]||(l[5]=V=>unref(o).action=V)},null,8,["modelValue"])])}}}),_sfc_main$1=defineComponent({__name:"create",setup(r){const d=ref(),m=ref({title:"",schema:"",active:!0}),s={url:"mgr/forms",beforeSubmit(e){var n;return(n=d.value)==null?void 0:n.verify(e)},title:useLexicon("models.form.title_one"),method:"put",size:"lg"};return(e,n)=>{const o=_sfc_main$2,a=_sfc_main$7;return openBlock(),createBlock(a,mergeProps({modelValue:unref(m),"onUpdate:modelValue":n[1]||(n[1]=i=>isRef(m)?m.value=i:null)},s),{"form-fields":withCtx(()=>[createVNode(o,{ref_key:"form",ref:d,modelValue:unref(m),"onUpdate:modelValue":n[0]||(n[0]=i=>isRef(m)?m.value=i:null)},null,8,["modelValue"])]),_:1},16,["modelValue"])}}});function useError(r){const d=useRouter();d&&d.push(r||"/")}const _sfc_main=defineComponent({__name:"edit",async setup(r){let d,m;const s=ref({}),e=ref(),n={url:"mgr/forms/"+useRoute().params.id,beforeSubmit(o){var a;return(a=e.value)==null?void 0:a.verify(o)},title:useLexicon("models.form.title_one"),updateKey:"mgr-forms",method:"patch",size:"lg"};try{s.value=([d,m]=withAsyncContext(()=>useGet(n.url)),d=await d,m(),d)}catch{useError()}return(o,a)=>{const i=_sfc_main$2,v=_sfc_main$7;return openBlock(),createBlock(v,mergeProps({modelValue:unref(s),"onUpdate:modelValue":a[1]||(a[1]=l=>isRef(s)?s.value=l:null)},n),{"form-fields":withCtx(()=>[createVNode(i,{ref_key:"form",ref:e,modelValue:unref(s),"onUpdate:modelValue":a[0]||(a[0]=l=>isRef(s)?s.value=l:null)},null,8,["modelValue"])]),_:1},16,["modelValue"])}}}),__pages_import_0__=()=>__vitePreload(()=>import("./submissions-Dw4dqVZ0.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23])),__pages_import_1__=()=>__vitePreload(()=>import("./view-CzdulWKg.js"),__vite__mapDeps([24,16,5,1,2,3,4,6,7,8,9,10,11,12,13,14,17,18,19,20,21,22,23])),__pages_import_5__=()=>__vitePreload(()=>import("./emails-B1P4qEiH.js"),__vite__mapDeps([25,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23])),__pages_import_6__=()=>__vitePreload(()=>import("./view-D--Kx531.js"),__vite__mapDeps([26,17,5,16,1,2,3,4,6,7,8,9,10,11,12,13,14,18,19,20,21,22,23])),routes=[{name:"submissions",path:"/submissions",component:__pages_import_0__,children:[{name:"submissions-id-view",path:":id/view",component:__pages_import_1__,props:!0}],props:!0},{name:"index",path:"/",component:_sfc_main$8,children:[{name:"index-create",path:"create",component:_sfc_main$1,props:!0},{name:"index-id-edit",path:":id/edit",component:_sfc_main,props:!0}],props:!0},{name:"emails",path:"/emails",component:__pages_import_5__,children:[{name:"emails-id-view",path:":id/view",component:__pages_import_6__,props:!0}],props:!0}],router=createRouter({history:createWebHashHistory(),routes});document.addEventListener("DOMContentLoaded",()=>{createApp(App).use(router).use(_c()).use(src_default,toastOptions).use(vueform,vueFormConfig).mount("#mmx-forms-root")});export{_sfc_main$a as _,_sfc_main$9 as a,_sfc_main$3 as b,_sfc_main$7 as c,useError as u};
